---
title: "BAM_Uni_Database"
author: "RP Poetra"
date: "2023-12-15"
output: html_document
---

```{css, echo=FALSE}
h1, h4 {
  text-align: center;
}
```

## 1. Import Library

If there is an error loading the library, it is likely you should install the package first

```{r "Install and Set libraries/packages", include=FALSE}

#Install Packages ########################
#install.packages("xts")
#install.packages("lubridate")
#install.packages("estimatr")
#install.packages("robustbase")

#Library List ############################
library(readr)
library(dplyr)
library(xts)
library(lubridate)
library(ggplot2)
library(data.table)

```


## 2. Rock Classification

```{r "Basalt Type according TAS Diagram"}

##### Geochemical Analaysis ####################################################
#Install package from Pieter Vermeesch (UCL) package ##Thanks to Pieter (UCL) :)
#install.packages("remotes")
#remotes::install_github("pvermees/GeoplotR")
#Call the library
library(GeoplotR)

#Plot TAS (Total Alkali-Silica) Diagram for extrusive igneous rocks
basaltgestein <- TAS(Na2O = 2.26,
                     K2O = 1.01,
                     SiO2 = 43.87,
                     xlim = NULL, #xlimit
                     ylim = NULL, #ylimit
                     plutonic = FALSE,
                     show.labels = TRUE,
                     short = TRUE,
                     pch = 22,
                     col = "black",
                     bg = "grey30",
                     cex = 2
)

lavagestein <-    TAS(Na2O = 2.99,
                     K2O = 3.29,
                     SiO2 = 43.44,
                     xlim = NULL, #xlimit
                     ylim = NULL, #ylimit
                     plutonic = FALSE,
                     show.labels = TRUE,
                     short = TRUE,
                     pch = 22,
                     col = "black",
                     bg = "darkred",
                     cex = 2
)

TAS(Na2O = c(2.26, 2.99),
    K2O = c(1.01, 3.29),
    SiO2 = c(43.87, 43.44),
    xlim = NULL, #xlimit
    ylim = NULL, #ylimit
    plutonic = FALSE,
    show.labels = TRUE,
    short = TRUE,
    pch = 22,
    col = "black",
    bg = c("grey30","darkred"),
    cex = 2
)
#Plot TAS for two basalt type
data(test,package='GeoplotR')
TAS(test[,'Na2O'],test[,'K2O'],test[,'SiO2'])

rocks <- data.frame(Name = c("Basaltgestein", "Lavagestein"),
                    Na2O = c(2.26, 2.99),
                    K2O = c(1.01, 3.29),
                    SiO2 = c(43.87, 43.44)
                    )

```


## 3. Essential Data

```{r "Additional Data", include=FALSE}

##### Specific Surface Area (SSA) of minerals [m2/gram]####
ssa_basalt_fine <- as.numeric(10.577)
ssa_basalt_coarse <- as.numeric(6.972)
ssa_dunite_fine <- as.numeric(7.05)
ssa_dunite_medium <- as.numeric(0.959)
ssa_dunite_coarse <- as.numeric(1.134)

```


## 4. Climate Data in Experiment Chamber

```{r Temperature and pCO2 of the experiment, echo=FALSE}

#Data import####################################################################
data_co2 <- read_csv('/Users/reinaldy/Documents/Kitchen Aid Experiment/CSV Data/pCO2-data-2022-06-01 23_32_30.csv')
data_temp_room <- read_csv('/Users/reinaldy/Documents/Kitchen Aid Experiment/CSV Data/Room temperature-data-2022-06-01 23_33_48.csv')

#Create Dataframe###############################################################
climate_room <- data.frame(date = data_co2$time,
                           co2_ppm = parse_number(data_co2$`CO2 (ppm)`), #parse number extract the number from the string
                           t_degC = parse_number(data_temp_room$`room temp`) #parse number extract the number from the string
                           )

#check class and summary of the data
#sapply (climate_room, class)
summary(climate_room)
var(climate_room$t_degC)
sd(climate_room$t_degC)


#Data Wrangling#################################################################
#data clearing - grouping data daily
climate_room$date <- as.Date(climate_room$date) #set the date in dataframe (POSIXct and POSIXt) to "Date"
climate_room_daily <- climate_room %>% group_by(date) %>% summarise(co2_ppm = mean(co2_ppm),
                                                                    t_degC = mean(t_degC),
                                                                    .groups = "drop") %>% as.data.frame()


#cut the non-sense CO2 ppm due to the failure of the sensor
climate_room_daily <- subset(climate_room_daily, co2_ppm < 550)
climate_room_daily <- subset(climate_room_daily, co2_ppm > 400)

#cut the non-sense temperarture in C due to the failure of the sensor
climate_room_daily <- subset(climate_room_daily, t_degC > 18)
climate_room_daily <- subset(climate_room_daily, t_degC < 25)

#data clearing - grouping data weekly (based on week number)
week_number <- c(lubridate::isoweek(ymd(climate_room_daily$date)))
climate_room_daily <- climate_room_daily %>% mutate(week_number = week_number)
climate_room_weekly <- climate_room_daily %>% group_by(week_number) %>% summarise(co2_ppm = mean(co2_ppm), 
                                                                                  t_degC = mean(t_degC),
                                                                                  .groups = "drop") %>% as.data.frame()


#Plot pCO2 and Temperature######################################################
#par(mfrow=c(2,1)) #merging multiple plots into one figure

#pCO2
plot(climate_room_daily$date, climate_room_daily$co2_ppm, 
     #main = "pCO2 during the experiment",
     xlab = substitute(paste(bold("Month"))),
     ylab = substitute(paste(bold("pCO2 in ppm"))),
     xlim = as.Date(c("2022-02-03", "2022-05-28")),
     ylim = c(300, 600),
     type = "b",
     pch = 19,
     las=1
)
lines(lowess(climate_room_daily$date, climate_room_daily$co2_ppm), 
      col = "red",
      lty = 1,
      lwd = 4)
# legend("bottomright", 
#        legend=c("Lowess smoothing"),
#        col = "red",
#        lty = 1,
#        cex = 0.7)

#Temperature
plot(climate_room_daily$date, climate_room_daily$t_degC, 
     main = "B",
     xlab = substitute(paste(bold("Month"))),
     ylab = substitute(paste(bold("Temperature in Celsius"))),
     xlim = as.Date(c("2022-02-03", "2022-05-28")),
     ylim = c(15, 30),
     type = "b",
     pch = 19,
     las = 1
)
lines(lowess(climate_room_daily$date, climate_room_daily$t_degC), 
      col = "red",
      lty = 1,
      lwd = 4)
# legend("bottomright", 
#        legend=c("Lowess smoothing"),
#        col = "red",
#        lty = 1,
#        cex = 0.7)

#######boxplot - if needed
#weekly_co2_ppm <- climate_room_daily[,c(2,4)]
#weekly_co2_ppm <- subset(weekly_co2_ppm, co2_ppm < 550)
#weekly_co2_ppm <- subset(weekly_co2_ppm, co2_ppm > 420)

#boxplot(weekly_co2_ppm[week_number == 3,1],
#        weekly_co2_ppm[week_number == 4,1],
#        weekly_co2_ppm[week_number == 5,1],
#        weekly_co2_ppm[week_number == 6,1],
#        weekly_co2_ppm[week_number == 7,1],
#        weekly_co2_ppm[week_number == 8,1],
#        weekly_co2_ppm[week_number == 9,1],
#        weekly_co2_ppm[week_number == 10,1],
#        weekly_co2_ppm[week_number == 11,1],
#        weekly_co2_ppm[week_number == 12,1],
#        weekly_co2_ppm[week_number == 13,1],
#        weekly_co2_ppm[week_number == 14,1],
#        weekly_co2_ppm[week_number == 15,1],
#        weekly_co2_ppm[week_number == 16,1],
#        weekly_co2_ppm[week_number == 17,1],
#        weekly_co2_ppm[week_number == 18,1],
#        weekly_co2_ppm[week_number == 19,1],
#        weekly_co2_ppm[week_number == 20,1],
#        weekly_co2_ppm[week_number == 21,1],
#        weekly_co2_ppm[week_number == 22,1])

#if subset neeeded
#climate_room_clean <- climate_room
#climate_room_clean <- subset(climate_room, t_deg < 27)
#climate_room_clean <- subset(climate_room_clean, t_deg > 16.5)




###### Alternative Plot #####
# Data import ####
data_co2 <- read_csv('/Users/reinaldy/Documents/Kitchen Aid Experiment/CSV Data/pCO2-data-2022-06-01 23_32_30.csv')
data_temp_room <- read_csv('/Users/reinaldy/Documents/Kitchen Aid Experiment/CSV Data/Room temperature-data-2022-06-01 23_33_48.csv')

# Create Dataframe #####
climate_room <- data.frame(date = data_co2$time,
                           co2_ppm = parse_number(data_co2$`CO2 (ppm)`), #parse number extract the number from the string
                           t_degC = parse_number(data_temp_room$`room temp`) #parse number extract the number from the string
                           )

#check class and summary of the data
#sapply (climate_room, class)
summary(climate_room)
var(climate_room$t_degC)
sd(climate_room$t_degC)

#data clearing - grouping data to Year-Month-Day Hour:Minute:Second
climate_room$date  <- strptime(climate_room$date, format="%Y-%m-%d %H:%M:%S")
climate_room$date  <- strptime(climate_room$date, format="%Y-%m-%d")

#cut the non-sense CO2 ppm due to the failure of the sensor
climate_room <- subset(climate_room, co2_ppm < 550)
climate_room <- subset(climate_room, co2_ppm > 400)

#cut the non-sense temperarture in C due to the failure of the sensor
climate_room <- subset(climate_room, t_degC > 20)
climate_room <- subset(climate_room, t_degC < 25)


#Plot pCO2 and Temperature######################################################
#par(mfrow=c(2,1)) #merging multiple plots into one figure

#pCO2
plot(climate_room$date, climate_room$co2_ppm,
     #main = "pCO2 during the experiment",
     xlab = substitute(paste(bold("Month"))),
     ylab = substitute(paste(bold("pCO2 in ppm"))),
     #xlim = as.Date(c("2022-02-03", "2022-05-28")),
     ylim = c(300, 600),
     type = "b",
     pch = 19,
     las=1
)
lines(lowess(climate_room$date, climate_room$co2_ppm),
      col = "red",
      lty = 1,
      lwd = 4)
legend("bottomright",
       legend=c("Lowess smoothing"),
       col = "red",
       lty = 1,
       cex = 0.7)

#Temperature
plot(climate_room$date, climate_room$t_degC,
     main = "B",
     xlab = substitute(paste(bold("Month"))),
     ylab = substitute(paste(bold("Temperature in Celsius"))),
     #xlim = as.Date(c("2022-02-03", "2022-05-28")),
     ylim = c(15, 30),
     type = "b",
     pch = 19,
     las = 1
)
lines(lowess(climate_room$date, climate_room$t_degC),
      col = "red",
      lty = 1,
      lwd = 4)
legend("bottomright",
       legend=c("Lowess smoothing"),
       col = "red",
       lty = 1,
       cex = 0.7)


```


## 5. Short Term Experiment

```{r "Dataframe for Short Term", include=FALSE}

##Import Database - Short Term ################################################
db_st <- read_csv('/Users/reinaldy/Documents/Kitchen Aid Experiment/CSV Data/short_term.csv')
#sapply (db_st, class)
summary(db_st)

#### Add SSA value in the dataset for calculating the rates ####
db_st <- db_st %>% mutate(ssa_m2_g = case_when(
  rock_type == "basalt" & grain_size == "fine" ~ ssa_basalt_fine,
  rock_type == "basalt" & grain_size == "coarse" ~ ssa_basalt_coarse,
  rock_type == "dunite" & grain_size == "fine" ~ ssa_dunite_fine,
  rock_type == "dunite" & grain_size == "medium" ~ ssa_dunite_medium,
  rock_type == "dunite" & grain_size == "coarse" ~ ssa_dunite_coarse,
))

#### Add unique day value for labelling ####
db_st <- db_st %>% mutate(legend_day = case_when(
  duration_day < 1 ~ "Day 0",
  duration_day < 2 & duration_day >= 1 ~ "Day 1",
  duration_day < 3 & duration_day >= 2 ~ "Day 2",
  duration_day < 4 & duration_day >= 3 ~ "Day 3",
  duration_day < 5 & duration_day >= 4 ~ "Day 4",
  duration_day < 6 & duration_day >= 5 ~ "Day 5",
  duration_day < 7 & duration_day >= 6 ~ "Day 6",
  duration_day < 8 & duration_day >= 7 ~ "Day 7",

))

#### Charge Balance Error (CBE) ####
db_st["cation_meq_l"] <- ((db_st$K_umol_l * 1) + (db_st$Na_umol_l * 1) + 
                            (db_st$Mg_umol_l *2 ) + (db_st$Ca_umol_l * 2)
                          )
db_st["anion_meq_l"] <- ((db_st$Cl_umol_l * 1) + (db_st$SO42_umol_l * 2) +
                           (db_st$NO3_umol_l * 1) + (db_st$TA_umol_kg * 1)
                         )

db_st["CBE_percent"] <- (db_st$cation_meq_l - db_st$anion_meq_l) / (db_st$cation_meq_l + db_st$anion_meq_l) * 100


#### Fraction of major cations and anions per total perse ####
db_st["fraction_Mg"] <- (db_st$Mg_umol_l*2) / (db_st$cation_meq_l)
db_st["fraction_Ca"] <- (db_st$Ca_umol_l*2) / (db_st$cation_meq_l)
db_st["fraction_Na"] <- (db_st$Na_umol_l*1) / (db_st$cation_meq_l)
db_st["fraction_K"] <- (db_st$K_umol_l*1) / (db_st$cation_meq_l)

db_st["fraction_Cl"] <- (db_st$Cl_umol_l*1) / (db_st$anion_meq_l)
db_st["fraction_NO3"] <- (db_st$NO3_umol_l*1) / (db_st$anion_meq_l)
db_st["fraction_TA"] <- (db_st$TA_umol_kg*1) / (db_st$anion_meq_l)
db_st["fraction_SO42"] <- (db_st$SO42_umol_l*2) / (db_st$anion_meq_l)



```

```{r "Dataframe for Short Term from PHREEQC", include=FALSE}

#### Subset data for the data with complete analysis
db_st_ion <- db_st[complete.cases(db_st$Na_umol_l), ]
db_st_ion <- subset(db_st_ion, db_st_ion$label_code != "miliq")
db_st_ion <- subset(db_st_ion, db_st_ion$DSi_umol_l != 0)
write.csv(db_st_ion, "/Users/reinaldy/Documents/Kitchen Aid Experiment/CSV Data/db_st_ion.csv")

#### Add data from PHREEQC
db_st_si <- read_csv('/Users/reinaldy/Documents/Kitchen Aid Experiment/CSV Data/db_st_brgm.csv')
db_st_si <- merge(db_st_ion, db_st_si, by = "pH")
write.csv(db_st_si, "/Users/reinaldy/Documents/Kitchen Aid Experiment/CSV Data/SI Compile.csv")


#### Subset data according their materials
db_st_si_basalt <- subset(db_st_si, db_st_si$rock_type == "basalt")
db_st_si_dunite <- subset(db_st_si, db_st_si$rock_type == "dunite")

```

```{r "Scatter Plot - Alkalinity Concentration", include=TRUE}
#### Dunite Scatter -Alkalinity #############################################
par(mfrow=c(2,2)) #merging multiple plots into one figure
par(cex.main = 2,  # Font size for main title
    cex.lab = 1.5,  # Font size for xlab and ylab
    cex.axis = 1.1,    #Font size for axis tick labels
    las = 1,         #Turn Y-Label 90% from original
    mar = c(2, 2, 3, 2))          #Set Margin



############################################################################X
##### Mechanical Effects ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Dunite 
#Subset data based for dunite with RPM variation
rpm_0_dunite <- subset(db_st, id_code == "base_dunite" & duration_day <=4)
rpm_0_dunite <- subset(rpm_0_dunite , duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_30_dunite <- subset(db_st, id_code == "rpm_slow")
rpm_30_dunite <- subset(rpm_30_dunite, duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_50_dunite <- subset(db_st, id_code == "rpm_medium" & duration_day <=4)
rpm_50_dunite <- subset(rpm_50_dunite,  duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_90_dunite <- subset(db_st, id_code == "rpm_high")
rpm_90_dunite <- subset(rpm_90_dunite, duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

#Plot
plot(rpm_0_dunite$duration_day, as.numeric(rpm_0_dunite$TA_umol_kg)/1000, 
     main = "A",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("Total Alkalinity in mEq/kg"))),
     xlim = c(0, 4),
     ylim = c(0, 50),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,
)
points(rpm_30_dunite$duration_day, as.numeric(rpm_30_dunite$TA_umol_kg)/1000, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
points(rpm_50_dunite$duration_day, as.numeric(rpm_50_dunite$TA_umol_kg)/1000, 
       type = "b",
       pch = 23,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
points(rpm_90_dunite$duration_day, as.numeric(rpm_90_dunite$TA_umol_kg)/1000, 
       type = "b",
       pch = 24,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("topleft", 
       title = expression(paste(bold("Mechanical Speed"))),
       legend=c("No Mixing", "30 RPM", "50 RPM", "90 RPM"),
       col = "black",
       pch = c(21,22,23,24),
       cex = 1,
       pt.bg = "#9ab973",
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.01,
       bty = "n"
)


############################################################################X
##### Grain Size Effect ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Dunite Coarse, Medium, vs Fine
#Subset data
df_13_50 <- subset(db_st, db_st$id_code == "DF-13-50")
dm_13_50 <- subset(db_st, db_st$id_code == "DM-13-50")
dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")

#plot Dunite Fine
plot(df_13_50$duration_day, as.numeric(df_13_50$TA_umol_kg)/1000, 
     main = "B",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("Total Alkalinity in mEq/kg"))),
     xlim = c(0, 7),
     ylim = c(0, 50),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,
)
points(df_13_50$duration_day, as.numeric(df_13_50$TA_umol_kg)/1000, 
       type = "b",
       pch = 21,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#plot Dunite Medium
points(dm_13_50$duration_day, as.numeric(dm_13_50$TA_umol_kg)/1000,
       type = "b",
       pch = 24,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#plot Dunite Coarse
points(dc_13_50$duration_day, as.numeric(dc_13_50$TA_umol_kg)/1000,
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("topleft",
       title = expression(paste(bold("Grain Size"))),
       legend=c("Fine", "Medium", "Coarse"),
       col = "black",
       pch = c(21,24,22),
       cex = 1,
       pt.bg = "#9ab973",
       ncol = 1,
       #horiz = TRUE,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



############################################################################X
##### Rock-Water Ratio #####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Dunite
#Subset data
dc_12 <- subset(db_st, db_st$id_code == "DC-12-50")
dc_13 <- subset(db_st, db_st$id_code == "DC-13-50")
dc_15 <- subset(db_st, db_st$id_code == "DC-15-50")

#Plot
plot(dc_12$duration_day, as.numeric(dc_12$TA_umol_kg)/1000, 
     main = "C",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("Total Alkalinity in mEq/kg"))),
     xlim = c(0, 7),
     ylim = c(0, 50),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,
)
points(dc_13$duration_day, as.numeric(dc_13$TA_umol_kg)/1000, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
points(dc_15$duration_day, as.numeric(dc_15$TA_umol_kg)/1000, 
       type = "b",
       pch = 23,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("topleft", 
       title = expression(paste(bold("Water-Rock Ratio"))),
       legend=c("1:2", "1:3", "1:5"),
       col = "black",
       pch = c(21,22,23),
       cex = 1,
       pt.bg = "#9ab973",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



############################################################################X
##### Water Replacement ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Dunite
#Subset data
dc_nwr <- subset(db_st, db_st$id_code == "DC-13-NWR-50")
dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")


plot(dc_nwr$duration_day, as.numeric(dc_nwr$TA_umol_kg)/1000,
     main = "D",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("Total Alkalinity in mEq/kg"))),
     xlim = c(0, 7),
     ylim = c(0, 50),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,
)
points(dc_13_50$duration_day, as.numeric(dc_13_50$TA_umol_kg)/1000, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)

#legend
legend("topleft", 
       title = expression(paste(bold("Water Replacement"))),
       legend=c("No Water Replacement", "Replaced Daily (33%)"),
       col = "black",
       pch = c(21,22),
       cex = 1,
       pt.bg = c("#9ab973", "#9ab973"),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



#### Basalt Scatter -Alkalinity #############################################
par(mfrow=c(2,2))
par(cex.main = 1.5,  # Font size for main title
    cex.lab = 1.25,  # Font size for xlab and ylab
    cex.axis = 1) # Font size for axis tick labels

############################################################################x
##### Mechanical Effects ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Basalt
#Subset data based for dbasalt with RPM variation
rpm_0_basalt <- subset(db_st, id_code == "base_basalt")
rpm_50_basalt <- subset(db_st, id_code == "BF-13-50")

#Plot
plot(rpm_0_basalt$duration_day, as.numeric(rpm_0_basalt$TA_umol_kg)/1000, 
     main = "A",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("Total Alkalinity in mEq/kg"))),
     xlim = c(0, 7),
     ylim = c(0, 10),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)
points(rpm_50_basalt$duration_day, as.numeric(rpm_50_basalt$TA_umol_kg)/1000, 
       type = "b",
       pch = 23,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("topleft", 
       title = expression(paste(bold("Mechanical Speed"))),
       legend=c("No Mixing", "50 RPM"),
       col = "black",
       pch = c(21,23),
       cex = 1,
       pt.bg = "grey50",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)


############################################################################x
##### Grain Size Effect ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#####Basalt Coarse vs Fine
#Subset data
bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")
bc_13_50 <- subset(db_st, db_st$id_code == "BC-13-50")

#Plot Basalt Fine
plot(bf_13_50$duration_day, as.numeric(bf_13_50$TA_umol_kg)/1000, 
     main = "B",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("Total Alkalinity in mEq/kg"))),
     xlim = c(0, 7),
     ylim = c(0, 10),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
     
)
#Plot Basalt Coarse
points(bc_13_50$duration_day, as.numeric(bc_13_50$TA_umol_kg)/1000,
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("topleft",
       title = expression(paste(bold("Grain Size"))),
       legend=c("Fine", "Coarse"),
       col = "black",
       pch = c(21,22),
       pt.bg = "grey50",
       cex = 1,
       ncol = 1,
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



############################################################################x
##### Rock-Water Ratio #####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Basalt
#Subset data
bc_12 <- subset(db_st, db_st$id_code == "BC-12-50")
bc_13 <- subset(db_st, db_st$id_code == "BC-13-50")
bc_15 <- subset(db_st, db_st$id_code == "BC-15-50")

#Plot
plot(bc_12$duration_day, as.numeric(bc_12$TA_umol_kg)/1000, 
     main = "C",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("Total Alkalinity in mEq/kg"))),
     xlim = c(0, 7),
     ylim = c(0, 10),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)
points(bc_13$duration_day, as.numeric(bc_13$TA_umol_kg)/1000, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
points(bc_15$duration_day, as.numeric(bc_15$TA_umol_kg)/1000, 
       type = "b",
       pch = 23,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("topleft", 
       title = expression(paste(bold("Water-Rock Ratio"))),
       legend=c("1:2", "1:3", "1:5"),
       col = "black",
       pch = c(21,22,23),
       cex = 1,
       pt.bg = "grey50",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)


############################################################################x
##### Water Replacement ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#####Plot Basalt 
#Subset data
bf_nwr <- subset(db_st, db_st$id_code == "BF-13-NWR-50")
bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")

#### normalize nwr data
bf_nwr <- bf_nwr %>% mutate(TA_umol_kg_norm = case_when(
  duration_day < 1 ~ bf_nwr$TA_umol_kg,
  duration_day < 2 & duration_day >= 1 ~ bf_nwr$TA_umol_kg*1.5,
  duration_day < 3 & duration_day >= 2 ~ bf_nwr$TA_umol_kg*1.25,
  duration_day < 4 & duration_day >= 3 ~ bf_nwr$TA_umol_kg*1.1,
  duration_day < 5 & duration_day >= 4 ~ bf_nwr$TA_umol_kg*1.1,
  duration_day < 6 & duration_day >= 5 ~ bf_nwr$TA_umol_kg*1.1,
  duration_day < 7 & duration_day >= 6 ~ bf_nwr$TA_umol_kg*1.1,
  duration_day < 8 & duration_day >= 7 ~ bf_nwr$TA_umol_kg,
  
))



#Plot
plot(bf_nwr$duration_day, as.numeric(bf_nwr$TA_umol_kg_norm)/1000, 
     main = "D",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("Alkalinity in mEq/kg"))),
     xlim = c(0, 7),
     ylim = c(0, 10),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)
points(bf_13_50$duration_day, as.numeric(bf_13_50$TA_umol_kg)/1000, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("topleft", 
       title = expression(paste(bold("Water Replacement"))),
       legend=c("No Water Replacement", "Replaced Daily (33%)"),
       col = "black",
       pch = c(21,22),
       cex = 1,
       pt.bg = c("grey50", "grey50"),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



```

```{r "Scatter Plot - Alkalinity Rate", include=TRUE}

#### Subset data from db_st ####
db_st_rate <- db_st[db_st$duration_day %in% 0:7, ]
db_st_rate <- db_st_rate[, c("seq", "id_code", "water_replacement","duration_day", "TA_umol_kg", "TA_after_replaced_umol_kg")]

#### Fill TA After Replace if NA
db_st_rate <- db_st_rate %>% mutate(TA_after_replaced_umol_kg = case_when(
  !is.na(TA_after_replaced_umol_kg) ~ TA_after_replaced_umol_kg,  # If not NA, keep the original value
  is.na(TA_after_replaced_umol_kg) ~ TA_umol_kg * 0.66            # If NA, replace with TA_umol_kg * 0.66
))

#### Mutate TA = TA Water Replaced for non-water replaced
db_st_rate <- db_st_rate %>% mutate(TA_after_replaced_umol_kg = case_when(
  water_replacement == "no" ~ TA_umol_kg,
  water_replacement == "yes" ~ TA_after_replaced_umol_kg,
))

#### Calculate rate
db_st_rate["TA_rate_umol_kg"] <- db_st_rate$TA_umol_kg - lag(db_st_rate$TA_after_replaced_umol_kg)

#### Turn Day 0 Rate into 0
db_st_rate <- db_st_rate %>% mutate(TA_rate_umol_kg = case_when(
  duration_day == 0 ~ 0,
  duration_day > 0 ~ TA_rate_umol_kg,
))


#### Dunite Scatter -Alkalinity #############################################
par(mfrow=c(2,2)) #merging multiple plots into one figure
par(cex.main = 2,  # Font size for main title
    cex.lab = 1.5,  # Font size for xlab and ylab
    cex.axis = 1.1,    #Font size for axis tick labels
    las = 1,         #Turn Y-Label 90% from original
    mar = c(2, 3, 3,5))          #Set Margin

############################################################################X
##### Mechanical Effects ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Dunite 
#Subset data based for dunite with RPM variation
rpm_0_dunite <- subset(db_st_rate, id_code == "base_dunite" & duration_day <=4)
rpm_0_dunite <- subset(rpm_0_dunite , duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_30_dunite <- subset(db_st_rate, id_code == "rpm_slow")
rpm_30_dunite <- subset(rpm_30_dunite, duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_50_dunite <- subset(db_st_rate, id_code == "rpm_medium" & duration_day <=4)
rpm_50_dunite <- subset(rpm_50_dunite,  duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_90_dunite <- subset(db_st_rate, id_code == "rpm_high")
rpm_90_dunite <- subset(rpm_90_dunite, duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

# rpm_0_dunite$pH <- c(5.79, 7.11, 7.19, 7.37, 7.39, 7.44)


#Plot
# plot(rpm_0_dunite$duration_day, rpm_0_dunite$pH, 
#      main = "A",
#      xlab = substitute(paste(bold("Day"))), 
#      ylab = substitute(paste(bold("pH"))),
#      xlim = c(0, 4),
#      ylim = c(5, 10),
#      type = "b",
#      pch = 21,
#      col = "black",
#      bg = "#9ab973",
#      cex = 2,
#      axes = FALSE,
# )
# axis(side =1)
# axis(side = 2, at = seq(5, 10, by = 0.5))
# box ()


plot(rpm_30_dunite$duration_day, rpm_30_dunite$TA_rate_umol_kg / 1000,
     main = "A",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0,4),
     ylim = c(0,30),
     type = "b",
     pch = 22,
     col = "black",
     bg = "#9ab973",
     cex = 2,
)

points(rpm_50_dunite$duration_day, rpm_50_dunite$TA_rate_umol_kg / 1000,
       type = "b",
       pch = 23,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
points(rpm_90_dunite$duration_day, rpm_90_dunite$TA_rate_umol_kg / 1000,
       type = "b",
       pch = 24,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("bottomright", 
       title = expression(paste(bold("Mechanical Speed"))),
       # legend=c("No Mixing", "30 RPM", "50 RPM", "90 RPM"),
       legend=c("30 RPM", "50 RPM", "90 RPM"),
       col = "black",
       # pch = c(21,22,23,24),
       pch = c(22,23,24),
       cex = 1,
       pt.bg = "#9ab973",
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.01,
       bty = "n"
)


############################################################################X
##### Grain Size Effect ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Dunite Coarse, Medium, vs Fine
#Subset data
df_13_50 <- subset(db_st_rate, db_st_rate$id_code == "DF-13-50")
dm_13_50 <- subset(db_st_rate, db_st_rate$id_code == "DM-13-50")
dc_13_50 <- subset(db_st_rate, db_st_rate$id_code == "DC-13-50")

#plot Dunite Fine
plot(df_13_50$duration_day, df_13_50$TA_rate_umol_kg / 1000, 
     main = "B",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0,30),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2
)

#plot Dunite Medium
points(dm_13_50$duration_day, dm_13_50$TA_rate_umol_kg / 1000,
       type = "b",
       pch = 24,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#plot Dunite Coarse
points(dc_13_50$duration_day, dc_13_50$TA_rate_umol_kg / 1000,
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("bottomright",
       title = expression(paste(bold("Grain Size"))),
       legend=c("Fine", "Medium", "Coarse"),
       col = "black",
       pch = c(21,24,22),
       cex = 1,
       pt.bg = "#9ab973",
       ncol = 1,
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       bty = "n"
)



############################################################################X
##### Rock-Water Ratio #####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Dunite
#Subset data
dc_12 <- subset(db_st_rate, db_st_rate$id_code == "DC-12-50")
dc_13 <- subset(db_st_rate, db_st_rate$id_code == "DC-13-50")
dc_15 <- subset(db_st_rate, db_st_rate$id_code == "DC-15-50")

#Plot
plot(dc_12$duration_day, dc_12$TA_rate_umol_kg / 1000, 
     main = "C",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0,30),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,
)


points(dc_13$duration_day, dc_13$TA_rate_umol_kg / 1000, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
points(dc_15$duration_day, dc_15$TA_rate_umol_kg / 1000, 
       type = "b",
       pch = 23,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("bottomright", 
       title = expression(paste(bold("Water-Rock Ratio"))),
       legend=c("1:2", "1:3", "1:5"),
       col = "black",
       pch = c(21,22,23),
       cex = 1,
       pt.bg = "#9ab973",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



############################################################################X
##### Water Replacement ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Dunite
#Subset data
dc_nwr <- subset(db_st_rate, db_st_rate$id_code == "DC-13-NWR-50")
dc_13_50 <- subset(db_st_rate, db_st_rate$id_code == "DC-13-50")


plot(dc_nwr$duration_day, dc_nwr$TA_rate_umol_kg / 1000,
     main = "D",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0,30),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,     
)

points(dc_13_50$duration_day, dc_13_50$TA_rate_umol_kg / 1000, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)

#legend
legend("bottomright", 
       title = expression(paste(bold("Water Replacement"))),
       legend=c("No Water Replacement", "Replaced Daily (33%)"),
       col = "black",
       pch = c(21,22),
       cex = 1,
       pt.bg = c("#9ab973", "#9ab973"),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



#### Basalt Scatter -Alkalinity #############################################
# par(mfrow=c(2,2)) #merging multiple plots into one figure
# par(cex.main = 2,  # Font size for main title
#     cex.lab = 1.5,  # Font size for xlab and ylab
#     cex.axis = 1.1,    #Font size for axis tick labels
#     las = 1,         #Turn Y-Label 90% from original
#     mar = c(2, 2, 3, 2))          #Set Margin


############################################################################x
##### Mechanical Effects ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Basalt
#Subset data based for dbasalt with RPM variation
rpm_0_basalt <- subset(db_st_rate, id_code == "base_basalt")
rpm_50_basalt <- subset(db_st_rate, id_code == "BF-13-50")

#rpm_0_basalt$pH <- c(5.71, 6.39, 6.80, 6.85, 6.93, 6.97, 7.01, 7.12)

#Plot
plot(rpm_50_basalt$duration_day, rpm_50_basalt$TA_rate_umol_kg / 1000, 
     main = "A",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0, 5),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)

#legend
legend("bottomright", 
       title = expression(paste(bold("Mechanical Speed"))),
       # legend=c("No Mixing", "50 RPM"),
       legend=c("50 RPM"),
       col = "black",
       # pch = c(21,23),
       pch = c(23),
       cex = 1,
       pt.bg = "grey50",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)


############################################################################x
##### Grain Size Effect ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#####Basalt Coarse vs Fine
#Subset data
bf_13_50 <- subset(db_st_rate, db_st_rate$id_code == "BF-13-50")
bc_13_50 <- subset(db_st_rate, db_st_rate$id_code == "BC-13-50")

#Plot Basalt Fine
plot(bf_13_50$duration_day, bf_13_50$TA_rate_umol_kg / 1000, 
     main = "B",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0, 5),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)

#Plot Basalt Coarse
points(bc_13_50$duration_day, bc_13_50$TA_rate_umol_kg / 1000,
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("bottomright",
       title = expression(paste(bold("Grain Size"))),
       legend=c("Fine", "Coarse"),
       col = "black",
       pch = c(21,22),
       pt.bg = "grey50",
       cex = 1,
       ncol = 1,
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



############################################################################x
##### Rock-Water Ratio #####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Basalt
#Subset data
bc_12 <- subset(db_st_rate, db_st_rate$id_code == "BC-12-50")
bc_13 <- subset(db_st_rate, db_st_rate$id_code == "BC-13-50")
bc_15 <- subset(db_st_rate, db_st_rate$id_code == "BC-15-50")

#Plot
plot(bc_12$duration_day, bc_12$TA_rate_umol_kg / 1000, 
     main = "C",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0, 5),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)

points(bc_13$duration_day, bc_13$TA_rate_umol_kg / 1000, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
points(bc_15$duration_day, bc_15$TA_rate_umol_kg / 1000, 
       type = "b",
       pch = 23,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("bottomright", 
       title = expression(paste(bold("Water-Rock Ratio"))),
       legend=c("1:2", "1:3", "1:5"),
       col = "black",
       pch = c(21,22,23),
       cex = 1,
       pt.bg = "grey50",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)


############################################################################x
##### Water Replacement ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#####Plot Basalt 
#Subset data
bf_nwr <- subset(db_st_rate, db_st_rate$id_code == "BF-13-NWR-50")
bf_13_50 <- subset(db_st_rate, db_st_rate$id_code == "BF-13-50")

#Plot
plot(bf_nwr$duration_day, bf_nwr$TA_rate_umol_kg / 1000, 
     main = "D",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0, 5),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)


points(bf_13_50$duration_day, bf_13_50$TA_rate_umol_kg / 1000, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("bottomright", 
       title = expression(paste(bold("Water Replacement"))),
       legend=c("No Water Replacement", "Replaced Daily (33%)"),
       col = "black",
       pch = c(21,22),
       cex = 1,
       pt.bg = c("grey50", "grey50"),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)


##### Rate for only water replacement ####
par(mfrow=c(1,2)) #merging multiple plots into one figure
par(cex.main = 2,  # Font size for main title
    cex.lab = 1.5,  # Font size for xlab and ylab
    cex.axis = 1.1,    #Font size for axis tick labels
    las = 1,         #Turn Y-Label 90% from original
    mar = c(2, 3, 3,5))          #Set Margin

# Dunite - Subset data
dc_nwr <- subset(db_st_rate, db_st_rate$id_code == "DC-13-NWR-50")
dc_13_50 <- subset(db_st_rate, db_st_rate$id_code == "DC-13-50")


plot(dc_nwr$duration_day, dc_nwr$TA_rate_umol_kg / 1000,
     main = "D",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0,30),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,     
)

points(dc_13_50$duration_day, dc_13_50$TA_rate_umol_kg / 1000, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)

#legend
legend("bottomright", 
       title = expression(paste(bold("Water Replacement"))),
       legend=c("No Water Replacement", "Replaced Daily (33%)"),
       col = "black",
       pch = c(21,22),
       cex = 1,
       pt.bg = c("#9ab973", "#9ab973"),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)

# Basanite - Subset data
bf_nwr <- subset(db_st_rate, db_st_rate$id_code == "BF-13-NWR-50")
bf_13_50 <- subset(db_st_rate, db_st_rate$id_code == "BF-13-50")

#Plot
plot(bf_nwr$duration_day, bf_nwr$TA_rate_umol_kg / 1000, 
     main = "Basanite",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0, 5),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)


points(bf_13_50$duration_day, bf_13_50$TA_rate_umol_kg / 1000, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("bottomright", 
       title = expression(paste(bold("Water Replacement"))),
       legend=c("No Water Replacement", "Replaced Daily (33%)"),
       col = "black",
       pch = c(21,22),
       cex = 1,
       pt.bg = c("grey50", "grey50"),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)

```

```{r "Scatter Plot - pH", include=TRUE}
#### Dunite Scatter -Alkalinity #############################################
par(mfrow=c(2,2)) #merging multiple plots into one figure
par(cex.main = 2,  # Font size for main title
    cex.lab = 1.5,  # Font size for xlab and ylab
    cex.axis = 1.1,    #Font size for axis tick labels
    las = 1,         #Turn Y-Label 90% from original
    mar = c(2, 3, 3, 2))          #Set Margin

############################################################################X
##### Mechanical Effects ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Dunite 
#Subset data based for dunite with RPM variation
rpm_0_dunite <- subset(db_st, id_code == "base_dunite" & duration_day <=4)
rpm_0_dunite <- subset(rpm_0_dunite , duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_30_dunite <- subset(db_st, id_code == "rpm_slow")
rpm_30_dunite <- subset(rpm_30_dunite, duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_50_dunite <- subset(db_st, id_code == "rpm_medium" & duration_day <=4)
rpm_50_dunite <- subset(rpm_50_dunite,  duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_90_dunite <- subset(db_st, id_code == "rpm_high")
rpm_90_dunite <- subset(rpm_90_dunite, duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_0_dunite$pH <- c(5.79, 7.11, 7.19, 7.37, 7.39, 7.44)


#Plot
plot(rpm_0_dunite$duration_day, rpm_0_dunite$pH, 
     main = "A",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("pH"))),
     xlim = c(0, 4),
     ylim = c(5, 10),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,
     axes = FALSE,
)

axis(side =1)
axis(side = 2, at = seq(5, 10, by = 0.5))
box ()


points(rpm_30_dunite$duration_day, rpm_30_dunite$pH, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
points(rpm_50_dunite$duration_day, rpm_50_dunite$pH, 
       type = "b",
       pch = 23,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
points(rpm_90_dunite$duration_day, rpm_90_dunite$pH, 
       type = "b",
       pch = 24,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("bottomright", 
       title = expression(paste(bold("Mechanical Speed"))),
       legend=c("No Mixing", "30 RPM", "50 RPM", "90 RPM"),
       col = "black",
       pch = c(21,22,23,24),
       cex = 1,
       pt.bg = "#9ab973",
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.01,
       bty = "n"
)


############################################################################X
##### Grain Size Effect ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Dunite Coarse, Medium, vs Fine
#Subset data
df_13_50 <- subset(db_st, db_st$id_code == "DF-13-50")
dm_13_50 <- subset(db_st, db_st$id_code == "DM-13-50")
dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")

#plot Dunite Fine
plot(df_13_50$duration_day, df_13_50$pH, 
     main = "B",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("pH"))),
     xlim = c(0, 7),
     ylim = c(5, 10),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,
     axes = FALSE,
)

axis(side =1)
axis(side = 2, at = seq(5, 10, by = 0.5))
box ()

#plot Dunite Medium
points(dm_13_50$duration_day, dm_13_50$pH,
       type = "b",
       pch = 24,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#plot Dunite Coarse
points(dc_13_50$duration_day, dc_13_50$pH,
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("bottomright",
       title = expression(paste(bold("Grain Size"))),
       legend=c("Fine", "Medium", "Coarse"),
       col = "black",
       pch = c(21,24,22),
       cex = 1,
       pt.bg = "#9ab973",
       ncol = 1,
       #horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       bty = "n"
)



############################################################################X
##### Rock-Water Ratio #####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Dunite
#Subset data
dc_12 <- subset(db_st, db_st$id_code == "DC-12-50")
dc_13 <- subset(db_st, db_st$id_code == "DC-13-50")
dc_15 <- subset(db_st, db_st$id_code == "DC-15-50")

#Plot
plot(dc_12$duration_day, dc_12$pH, 
     main = "C",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("pH"))),
     xlim = c(0, 7),
     ylim = c(5, 10),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,     
     axes = FALSE,
)

axis(side =1)
axis(side = 2, at = seq(5, 10, by = 0.5))
box ()


points(dc_13$duration_day, dc_13$pH, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
points(dc_15$duration_day, dc_15$pH, 
       type = "b",
       pch = 23,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("bottomright", 
       title = expression(paste(bold("Water-Rock Ratio"))),
       legend=c("1:2", "1:3", "1:5"),
       col = "black",
       pch = c(21,22,23),
       cex = 1,
       pt.bg = "#9ab973",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



############################################################################X
##### Water Replacement ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Dunite
#Subset data
dc_nwr <- subset(db_st, db_st$id_code == "DC-13-NWR-50")
dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")


plot(dc_nwr$duration_day, dc_nwr$pH,
     main = "D",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("pH"))),
     xlim = c(0, 7),
     ylim = c(5, 10),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,     
     axes = FALSE,
)

axis(side =1)
axis(side = 2, at = seq(5, 10, by = 0.5))
box ()


points(dc_13_50$duration_day, dc_13_50$pH, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)

#legend
legend("bottomright", 
       title = expression(paste(bold("Water Replacement"))),
       legend=c("No Water Replacement", "Replaced Daily (33%)"),
       col = "black",
       pch = c(21,22),
       cex = 1,
       pt.bg = c("#9ab973", "#9ab973"),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



#### Basalt Scatter -Alkalinity #############################################
# par(mfrow=c(2,2)) #merging multiple plots into one figure
# par(cex.main = 2,  # Font size for main title
#     cex.lab = 1.5,  # Font size for xlab and ylab
#     cex.axis = 1.1,    #Font size for axis tick labels
#     las = 1,         #Turn Y-Label 90% from original
#     mar = c(2, 2, 3, 2))          #Set Margin


############################################################################x
##### Mechanical Effects ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Basalt
#Subset data based for dbasalt with RPM variation
rpm_0_basalt <- subset(db_st, id_code == "base_basalt")
rpm_50_basalt <- subset(db_st, id_code == "BF-13-50")

rpm_0_basalt$pH <- c(5.71, 6.39, 6.80, 6.85, 6.93, 6.97, 7.01, 7.12)

#Plot
plot(rpm_0_basalt$duration_day, rpm_0_basalt$pH, 
     main = "A",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("pH"))),
     xlim = c(0, 7),
     ylim = c(5, 10),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
     axes = FALSE,
)

axis(side =1)
axis(side = 2, at = seq(5, 10, by = 0.5))
box ()
points(rpm_50_basalt$duration_day, rpm_50_basalt$pH, 
       type = "b",
       pch = 23,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("bottomright", 
       title = expression(paste(bold("Mechanical Speed"))),
       legend=c("No Mixing", "50 RPM"),
       col = "black",
       pch = c(21,23),
       cex = 1,
       pt.bg = "grey50",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)


############################################################################x
##### Grain Size Effect ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#####Basalt Coarse vs Fine
#Subset data
bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")
bc_13_50 <- subset(db_st, db_st$id_code == "BC-13-50")

#Plot Basalt Fine
plot(bf_13_50$duration_day, bf_13_50$pH, 
     main = "B",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("pH"))),
     xlim = c(0, 7),
     ylim = c(5, 10),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
     axes = FALSE,
)

axis(side =1)
axis(side = 2, at = seq(5, 10, by = 0.5))
box ()


#Plot Basalt Coarse
points(bc_13_50$duration_day, bc_13_50$pH,
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("bottomright",
       title = expression(paste(bold("Grain Size"))),
       legend=c("Fine", "Coarse"),
       col = "black",
       pch = c(21,22),
       pt.bg = "grey50",
       cex = 1,
       ncol = 1,
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



############################################################################x
##### Rock-Water Ratio #####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Basalt
#Subset data
bc_12 <- subset(db_st, db_st$id_code == "BC-12-50")
bc_13 <- subset(db_st, db_st$id_code == "BC-13-50")
bc_15 <- subset(db_st, db_st$id_code == "BC-15-50")

#Plot
plot(bc_12$duration_day, bc_12$pH, 
     main = "C",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("pH"))),
     xlim = c(0, 7),
     ylim = c(5, 10),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
     axes = FALSE,
)

axis(side =1)
axis(side = 2, at = seq(5, 10, by = 0.5))
box ()


points(bc_13$duration_day, bc_13$pH, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
points(bc_15$duration_day, bc_15$pH, 
       type = "b",
       pch = 23,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("bottomright", 
       title = expression(paste(bold("Water-Rock Ratio"))),
       legend=c("1:2", "1:3", "1:5"),
       col = "black",
       pch = c(21,22,23),
       cex = 1,
       pt.bg = "grey50",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)


############################################################################x
##### Water Replacement ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#####Plot Basalt 
#Subset data
bf_nwr <- subset(db_st, db_st$id_code == "BF-13-NWR-50")
bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")

#Plot
plot(bf_nwr$duration_day, bf_nwr$pH, 
     main = "D",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("pH"))),
     xlim = c(0, 7),
     ylim = c(5, 10),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
     axes = FALSE,
)

axis(side =1)
axis(side = 2, at = seq(5, 10, by = 0.5))
box ()


points(bf_13_50$duration_day, bf_13_50$pH, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("bottomright", 
       title = expression(paste(bold("Water Replacement"))),
       legend=c("No Water Replacement", "Replaced Daily (33%)"),
       col = "black",
       pch = c(21,22),
       cex = 1,
       pt.bg = c("grey50", "grey50"),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)

```

```{r "Scatter Plot - EC", include=TRUE}
# #### Dunite Scatter -Alkalinity #############################################
# par(mfrow=c(2,2)) #merging multiple plots into one figure
# par(cex.main = 2,  # Font size for main title
#     cex.lab = 1.5,  # Font size for xlab and ylab
#     cex.axis = 1.1,    #Font size for axis tick labels
#     las = 1,         #Turn Y-Label 90% from original
#     mar = c(2, 3, 3,5))          #Set Margin

par(mfrow=c(2,2)) #merging multiple plots into one figure
par(cex.main = 2,  # Font size for main title
    cex.lab = 1.5,  # Font size for xlab and ylab
    cex.axis = 1.1,    #Font size for axis tick labels
    las = 1,         #Turn Y-Label 90% from original
    mar = c(2, 3, 3, 2))          #Set Margin
############################################################################X
##### Mechanical Effects ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Dunite 
#Subset data based for dunite with RPM variation
rpm_0_dunite <- subset(db_st, id_code == "base_dunite" & duration_day <=4)
rpm_0_dunite <- subset(rpm_0_dunite , duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_30_dunite <- subset(db_st, id_code == "rpm_slow")
rpm_30_dunite <- subset(rpm_30_dunite, duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_50_dunite <- subset(db_st, id_code == "rpm_medium" & duration_day <=4)
rpm_50_dunite <- subset(rpm_50_dunite,  duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_90_dunite <- subset(db_st, id_code == "rpm_high")
rpm_90_dunite <- subset(rpm_90_dunite, duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

# rpm_0_dunite$pH <- c(5.79, 7.11, 7.19, 7.37, 7.39, 7.44)


#Plot
# plot(rpm_0_dunite$duration_day, rpm_0_dunite$pH, 
#      main = "A",
#      xlab = substitute(paste(bold("Day"))), 
#      ylab = substitute(paste(bold("pH"))),
#      xlim = c(0, 4),
#      ylim = c(5, 10),
#      type = "b",
#      pch = 21,
#      col = "black",
#      bg = "#9ab973",
#      cex = 2,
#      axes = FALSE,
# )
# axis(side =1)
# axis(side = 2, at = seq(5, 10, by = 0.5))
# box ()


plot(rpm_30_dunite$duration_day, rpm_30_dunite$ec_uS_cm,
     main = "A",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0,4),
     ylim = c(0,2500),
     type = "b",
     pch = 22,
     col = "black",
     bg = "#9ab973",
     cex = 2,
)

points(rpm_50_dunite$duration_day, rpm_50_dunite$ec_uS_cm,
       type = "b",
       pch = 23,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
points(rpm_90_dunite$duration_day, rpm_90_dunite$ec_uS_cm,
       type = "b",
       pch = 24,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("topleft", 
       title = expression(paste(bold("Mechanical Speed"))),
       # legend=c("No Mixing", "30 RPM", "50 RPM", "90 RPM"),
       legend=c("30 RPM", "50 RPM", "90 RPM"),
       col = "black",
       # pch = c(21,22,23,24),
       pch = c(22,23,24),
       cex = 1,
       pt.bg = "#9ab973",
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.01,
       bty = "n"
)


############################################################################X
##### Grain Size Effect ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Dunite Coarse, Medium, vs Fine
#Subset data
df_13_50 <- subset(db_st, db_st$id_code == "DF-13-50")
dm_13_50 <- subset(db_st, db_st$id_code == "DM-13-50")
dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")

#plot Dunite Fine
plot(df_13_50$duration_day, df_13_50$ec_uS_cm, 
     main = "B",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0, 2500),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2
)

#plot Dunite Medium
points(dm_13_50$duration_day, dm_13_50$ec_uS_cm,
       type = "b",
       pch = 24,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#plot Dunite Coarse
points(dc_13_50$duration_day, dc_13_50$ec_uS_cm,
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("topleft",
       title = expression(paste(bold("Grain Size"))),
       legend=c("Fine", "Medium", "Coarse"),
       col = "black",
       pch = c(21,24,22),
       cex = 1,
       pt.bg = "#9ab973",
       ncol = 1,
       #horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       bty = "n"
)



############################################################################X
##### Rock-Water Ratio #####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Dunite
#Subset data
dc_12 <- subset(db_st, db_st$id_code == "DC-12-50")
dc_13 <- subset(db_st, db_st$id_code == "DC-13-50")
dc_15 <- subset(db_st, db_st$id_code == "DC-15-50")

#Plot
plot(dc_12$duration_day, dc_12$ec_uS_cm, 
     main = "C",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0, 2500),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,
)


points(dc_13$duration_day, dc_13$ec_uS_cm, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
points(dc_15$duration_day, dc_15$ec_uS_cm, 
       type = "b",
       pch = 23,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("topleft", 
       title = expression(paste(bold("Water-Rock Ratio"))),
       legend=c("1:2", "1:3", "1:5"),
       col = "black",
       pch = c(21,22,23),
       cex = 1,
       pt.bg = "#9ab973",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



############################################################################X
##### Water Replacement ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Dunite
#Subset data
dc_nwr <- subset(db_st, db_st$id_code == "DC-13-NWR-50")
dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")


plot(dc_nwr$duration_day, dc_nwr$ec_uS_cm,
     main = "D",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0, 2500),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,     
)

points(dc_13_50$duration_day, dc_13_50$ec_uS_cm, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)

#legend
legend("topleft", 
       title = expression(paste(bold("Water Replacement"))),
       legend=c("No Water Replacement", "Replaced Daily (33%)"),
       col = "black",
       pch = c(21,22),
       cex = 1,
       pt.bg = c("#9ab973", "#9ab973"),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



#### Basalt Scatter -Alkalinity #############################################
# par(mfrow=c(2,2)) #merging multiple plots into one figure
# par(cex.main = 2,  # Font size for main title
#     cex.lab = 1.5,  # Font size for xlab and ylab
#     cex.axis = 1.1,    #Font size for axis tick labels
#     las = 1,         #Turn Y-Label 90% from original
#     mar = c(2, 2, 3, 2))          #Set Margin


############################################################################x
##### Mechanical Effects ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Basalt
#Subset data based for dbasalt with RPM variation
rpm_0_basalt <- subset(db_st, id_code == "base_basalt")
rpm_50_basalt <- subset(db_st, id_code == "BF-13-50")

rpm_0_basalt$pH <- c(5.71, 6.39, 6.80, 6.85, 6.93, 6.97, 7.01, 7.12)

#Plot
plot(rpm_50_basalt$duration_day, rpm_50_basalt$ec_uS_cm, 
     main = "A",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0, 800),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)

#legend
legend("topleft", 
       title = expression(paste(bold("Mechanical Speed"))),
       # legend=c("No Mixing", "50 RPM"),
       legend=c("50 RPM"),
       col = "black",
       # pch = c(21,23),
       pch = c(23),
       cex = 1,
       pt.bg = "grey50",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)


############################################################################x
##### Grain Size Effect ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#####Basalt Coarse vs Fine
#Subset data
bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")
bc_13_50 <- subset(db_st, db_st$id_code == "BC-13-50")

#Plot Basalt Fine
plot(bf_13_50$duration_day, bf_13_50$ec_uS_cm, 
     main = "B",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0, 800),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)

#Plot Basalt Coarse
points(bc_13_50$duration_day, bc_13_50$ec_uS_cm,
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("topleft",
       title = expression(paste(bold("Grain Size"))),
       legend=c("Fine", "Coarse"),
       col = "black",
       pch = c(21,22),
       pt.bg = "grey50",
       cex = 1,
       ncol = 1,
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



############################################################################x
##### Rock-Water Ratio #####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Basalt
#Subset data
bc_12 <- subset(db_st, db_st$id_code == "BC-12-50")
bc_13 <- subset(db_st, db_st$id_code == "BC-13-50")
bc_15 <- subset(db_st, db_st$id_code == "BC-15-50")

#Plot
plot(bc_12$duration_day, bc_12$ec_uS_cm, 
     main = "C",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0, 800),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)

points(bc_13$duration_day, bc_13$ec_uS_cm, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
points(bc_15$duration_day, bc_15$ec_uS_cm, 
       type = "b",
       pch = 23,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("topleft", 
       title = expression(paste(bold("Water-Rock Ratio"))),
       legend=c("1:2", "1:3", "1:5"),
       col = "black",
       pch = c(21,22,23),
       cex = 1,
       pt.bg = "grey50",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)


############################################################################x
##### Water Replacement ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#####Plot Basalt 
#Subset data
bf_nwr <- subset(db_st, db_st$id_code == "BF-13-NWR-50")
bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")

#Plot
plot(bf_nwr$duration_day, bf_nwr$ec_uS_cm, 
     main = "D",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     ylim = c(0, 800),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)


points(bf_13_50$duration_day, bf_13_50$ec_uS_cm, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("topleft", 
       title = expression(paste(bold("Water Replacement"))),
       legend=c("No Water Replacement", "Replaced Daily (33%)"),
       col = "black",
       pch = c(21,22),
       cex = 1,
       pt.bg = c("grey50", "grey50"),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)

```

```{r "Scatter Plot - Temperature", include=TRUE}
#### Dunite Scatter -Alkalinity #############################################
par(mfrow=c(2,2)) #merging multiple plots into one figure
par(cex.main = 2,  # Font size for main title
    cex.lab = 1.5,  # Font size for xlab and ylab
    cex.axis = 1.1,    #Font size for axis tick labels
    las = 1,         #Turn Y-Label 90% from original
    mar = c(2, 3, 3,5))          #Set Margin

############################################################################X
##### Mechanical Effects ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Dunite 
#Subset data based for dunite with RPM variation
rpm_0_dunite <- subset(db_st, id_code == "base_dunite" & duration_day <=4)
rpm_0_dunite <- subset(rpm_0_dunite , duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_30_dunite <- subset(db_st, id_code == "rpm_slow")
rpm_30_dunite <- subset(rpm_30_dunite, duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_50_dunite <- subset(db_st, id_code == "rpm_medium" & duration_day <=4)
rpm_50_dunite <- subset(rpm_50_dunite,  duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_90_dunite <- subset(db_st, id_code == "rpm_high")
rpm_90_dunite <- subset(rpm_90_dunite, duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

# rpm_0_dunite$pH <- c(5.79, 7.11, 7.19, 7.37, 7.39, 7.44)


#Plot
# plot(rpm_0_dunite$duration_day, rpm_0_dunite$pH, 
#      main = "A",
#      xlab = substitute(paste(bold("Day"))), 
#      ylab = substitute(paste(bold("pH"))),
#      xlim = c(0, 4),
#      ylim = c(5, 10),
#      type = "b",
#      pch = 21,
#      col = "black",
#      bg = "#9ab973",
#      cex = 2,
#      axes = FALSE,
# )
# axis(side =1)
# axis(side = 2, at = seq(5, 10, by = 0.5))
# box ()


plot(rpm_30_dunite$duration_day, rpm_30_dunite$temperature_c,
     main = "A",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0,4),
     #ylim = c(0,2000),
     type = "b",
     pch = 22,
     col = "black",
     bg = "#9ab973",
     cex = 2,
)

points(rpm_50_dunite$duration_day, rpm_50_dunite$temperature_c,
       type = "b",
       pch = 23,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
points(rpm_90_dunite$duration_day, rpm_90_dunite$temperature_c,
       type = "b",
       pch = 24,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("bottomright", 
       title = expression(paste(bold("Mechanical Speed"))),
       # legend=c("No Mixing", "30 RPM", "50 RPM", "90 RPM"),
       legend=c("30 RPM", "50 RPM", "90 RPM"),
       col = "black",
       # pch = c(21,22,23,24),
       pch = c(22,23,24),
       cex = 1,
       pt.bg = "#9ab973",
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.01,
       bty = "n"
)


############################################################################X
##### Grain Size Effect ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Dunite Coarse, Medium, vs Fine
#Subset data
df_13_50 <- subset(db_st, db_st$id_code == "DF-13-50")
dm_13_50 <- subset(db_st, db_st$id_code == "DM-13-50")
dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")

#plot Dunite Fine
plot(df_13_50$duration_day, df_13_50$temperature_c, 
     main = "B",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     #ylim = c(0, 2000),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2
)

#plot Dunite Medium
points(dm_13_50$duration_day, dm_13_50$temperature_c,
       type = "b",
       pch = 24,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#plot Dunite Coarse
points(dc_13_50$duration_day, dc_13_50$temperature_c,
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("bottomright",
       title = expression(paste(bold("Grain Size"))),
       legend=c("Fine", "Medium", "Coarse"),
       col = "black",
       pch = c(21,24,22),
       cex = 1,
       pt.bg = "#9ab973",
       ncol = 1,
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       bty = "n"
)



############################################################################X
##### Rock-Water Ratio #####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Dunite
#Subset data
dc_12 <- subset(db_st, db_st$id_code == "DC-12-50")
dc_13 <- subset(db_st, db_st$id_code == "DC-13-50")
dc_15 <- subset(db_st, db_st$id_code == "DC-15-50")

#Plot
plot(dc_12$duration_day, dc_12$temperature_c, 
     main = "C",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     #ylim = c(0, 2000),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,
)


points(dc_13$duration_day, dc_13$temperature_c, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
points(dc_15$duration_day, dc_15$temperature_c, 
       type = "b",
       pch = 23,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)
#legend
legend("bottomright", 
       title = expression(paste(bold("Water-Rock Ratio"))),
       legend=c("1:2", "1:3", "1:5"),
       col = "black",
       pch = c(21,22,23),
       cex = 1,
       pt.bg = "#9ab973",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



############################################################################X
##### Water Replacement ####################################################
############################################################################X
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Dunite
#Subset data
dc_nwr <- subset(db_st, db_st$id_code == "DC-13-NWR-50")
dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")


plot(dc_nwr$duration_day, dc_nwr$temperature_c,
     main = "D",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     #ylim = c(0, 2000),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2,     
)

points(dc_13_50$duration_day, dc_13_50$temperature_c, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2,
)

#legend
legend("bottomright", 
       title = expression(paste(bold("Water Replacement"))),
       legend=c("No Water Replacement", "Replaced Daily (33%)"),
       col = "black",
       pch = c(21,22),
       cex = 1,
       pt.bg = c("#9ab973", "#9ab973"),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



#### Basalt Scatter -Alkalinity #############################################
# par(mfrow=c(2,2)) #merging multiple plots into one figure
# par(cex.main = 2,  # Font size for main title
#     cex.lab = 1.5,  # Font size for xlab and ylab
#     cex.axis = 1.1,    #Font size for axis tick labels
#     las = 1,         #Turn Y-Label 90% from original
#     mar = c(2, 2, 3, 2))          #Set Margin


############################################################################x
##### Mechanical Effects ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#### Basalt
#Subset data based for dbasalt with RPM variation
rpm_0_basalt <- subset(db_st, id_code == "base_basalt")
rpm_50_basalt <- subset(db_st, id_code == "BF-13-50")

rpm_0_basalt$pH <- c(5.71, 6.39, 6.80, 6.85, 6.93, 6.97, 7.01, 7.12)

#Plot
plot(rpm_50_basalt$duration_day, rpm_50_basalt$temperature_c, 
     main = "A",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     #ylim = c(0, 1000),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)

#legend
legend("bottomright", 
       title = expression(paste(bold("Mechanical Speed"))),
       # legend=c("No Mixing", "50 RPM"),
       legend=c("50 RPM"),
       col = "black",
       # pch = c(21,23),
       pch = c(23),
       cex = 1,
       pt.bg = "grey50",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)


############################################################################x
##### Grain Size Effect ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#####Basalt Coarse vs Fine
#Subset data
bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")
bc_13_50 <- subset(db_st, db_st$id_code == "BC-13-50")

#Plot Basalt Fine
plot(bf_13_50$duration_day, bf_13_50$temperature_c, 
     main = "B",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     #ylim = c(0, 1000),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)

#Plot Basalt Coarse
points(bc_13_50$duration_day, bc_13_50$temperature_c,
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("bottomright",
       title = expression(paste(bold("Grain Size"))),
       legend=c("Fine", "Coarse"),
       col = "black",
       pch = c(21,22),
       pt.bg = "grey50",
       cex = 1,
       ncol = 1,
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)



############################################################################x
##### Rock-Water Ratio #####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
##### Basalt
#Subset data
bc_12 <- subset(db_st, db_st$id_code == "BC-12-50")
bc_13 <- subset(db_st, db_st$id_code == "BC-13-50")
bc_15 <- subset(db_st, db_st$id_code == "BC-15-50")

#Plot
plot(bc_12$duration_day, bc_12$temperature_c, 
     main = "C",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     #ylim = c(0, 1000),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)

points(bc_13$duration_day, bc_13$temperature_c, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
points(bc_15$duration_day, bc_15$temperature_c, 
       type = "b",
       pch = 23,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("bottomright", 
       title = expression(paste(bold("Water-Rock Ratio"))),
       legend=c("1:2", "1:3", "1:5"),
       col = "black",
       pch = c(21,22,23),
       cex = 1,
       pt.bg = "grey50",
       horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)


############################################################################x
##### Water Replacement ####################################################
############################################################################x
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
#####Plot Basalt 
#Subset data
bf_nwr <- subset(db_st, db_st$id_code == "BF-13-NWR-50")
bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")

#Plot
plot(bf_nwr$duration_day, bf_nwr$temperature_c, 
     main = "D",
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("EC in uS/cm"))),
     xlim = c(0, 7),
     #ylim = c(0, 1000),
     type = "b",
     pch = 21,
     col = "black",
     bg = "grey50",
     cex = 2,
)


points(bf_13_50$duration_day, bf_13_50$temperature_c, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2,
)
#legend
legend("bottomright", 
       title = expression(paste(bold("Water Replacement"))),
       legend=c("No Water Replacement", "Replaced Daily (33%)"),
       col = "black",
       pch = c(21,22),
       cex = 1,
       pt.bg = c("grey50", "grey50"),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n"
)

```

```{r "Bar plot - Alkalinity Production vs Treatment", include=TRUE}


par(mfrow=c(2,2)) #merging multiple plots into one figure
par(cex.main = 2,  # Font size for main title
    cex.lab = 1.5,  # Font size for xlab and ylab
    cex.axis = 1.1,    #Font size for axis tick labels
    las = 1,         #Turn Y-Label 90% from original
    mar = c(3, 5, 3, 2))          #Set Margin

##### A. Mechanical Effects ###################################################
#Data Frame
#rpm_0_dunite <- subset(db_st, id_code == "base_dunite" & duration_day <=4)
#rpm_30_dunite <- subset(db_st, id_code == "rpm_slow")
#rpm_50_dunite <- subset(db_st, id_code == "rpm_medium" & duration_day <=4)
#rpm_90_dunite <- subset(db_st, id_code == "rpm_high")

#rpm_0_basalt <- subset(db_st, id_code == "base_basalt")
#rpm_50_basalt <- subset(db_st, id_code == "BF-13-50")

#x = c(db_st$TA_umol_kg[db_st$id_code == "base_dunite" & db_st$duration_day == 0],
#      db_st$TA_umol_kg[db_st$id_code == "base_dunite" & db_st$duration_day == 1],
#      db_st$TA_umol_kg[db_st$id_code == "base_dunite" & db_st$duration_day == 2],
#      db_st$TA_umol_kg[db_st$id_code == "base_dunite" & db_st$duration_day == 3],
#      db_st$TA_umol_kg[db_st$id_code == "base_dunite" & db_st$duration_day == 4]
#)

x <- 0
y <- 0
#base_basalt
for (i in c(1,3,4)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "base_basalt" & db_st$duration_day == i])))
  base_basalt = (sum(x[c(1,3)]) + (x[4]*3))*3
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "base_basalt" & db_st$duration_day == i]))) * x[i] / 100
  base_basalt_sd = mean(y[c(1,3,4)])
}
#50_basalt_fine
for (i in c(1,3,4)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BF-13-50" & db_st$duration_day == i])))
  basalt_50 = sum(x[c(1,3)]) + (x[4]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BF-13-50" & db_st$duration_day == i]))) * x[i] / 100
  basalt_50_sd = mean(y[c(1,3,4)])
}
#
#base_dunite_coarse
for (i in c(1,3,4)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "base_dunite" & db_st$duration_day == i])))
  base_dunite = (sum(x[c(1,3)]) + (x[4]*3))*2
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "base_dunite" & db_st$duration_day == i]))) * x[i] / 100
  base_dunite_sd = mean(y[c(1,3,4)])
}
#30_dunite_coarse
for (i in 1:4){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "rpm_slow" & db_st$duration_day == i])))
  dunite_30 = sum(x[1:3]) + (x[4]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "rpm_slow" & db_st$duration_day == i]))) * x[i] / 100
  dunite_30_sd = mean(y[c(1:4)])
}
#50_dunite_coarse
for (i in 1:4){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "rpm_medium" & db_st$duration_day == i])))
  dunite_50 = sum(x[1:3]) + (x[4]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "rpm_medium" & db_st$duration_day == i]))) * x[i] / 100
  dunite_50_sd = mean(y[c(1:4)])
}
#90_dunite_coarse
for (i in 1:4){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "rpm_high" & db_st$duration_day == i])))
  dunite_90 = sum(x[1:3]) + (x[4]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "rpm_high" & db_st$duration_day == i]))) * x[i] / 100
  dunite_90_sd = mean(y[c(1:4)])
}

mech_effect <- data.frame(treatment =c("base_basalt", "basalt_50","base_dunite", "dunite_30", "dunite_50", "dunite_90"),
                          TAlk_mmol_l = c(base_basalt/1000, basalt_50/1000, base_dunite/1000, dunite_30/1000, dunite_50/1000, dunite_90/1000),
                          sd = c(base_basalt_sd/1000, basalt_50_sd/1000, base_dunite_sd/1000, dunite_30_sd/1000, dunite_50_sd/1000, dunite_90_sd/1000)
)

#barplot
ME = barplot(height=mech_effect$TAlk_mmol_l, 
             #main = "A. Mechanical Effect",
             ylim = c(0,220),
             #ylab = substitute(paste(bold("Total Alkalinity in mEq"))),
             col=c(rep("grey40",2),rep("#9ab973",4)),
             names.arg = c("0 RPM", "50 RPM",
                           "0 RPM", "30 RPM", "50 RPM", "90 RPM"),
             font.axis = 2,
             yaxt = "n",  # Suppress default Y-axis
             
)
mtext("A. Mechanical Effect", side = 3, line = -1.0, adj = 0, cex = 1.75, font = 2)
axis(2, cex.axis = 1.7, font = 2)  # the character expansion factor


text(
  x = ME,
  y = mech_effect$TAlk_mmol_l,
  labels = round(mech_effect$TAlk_mmol_l, 1),
  pos = 3,
  srt = 0,
  offset = 1,
  font = 2,
  cex = 1.2
)
#standard deviation legend
arrows(x0 = ME, y0 = mech_effect$TAlk_mmol_l + mech_effect$sd,
       x1 = ME, y1 = mech_effect$TAlk_mmol_l - mech_effect$sd,
       code = 3, angle = 90, length = 0.2)



##### B. Grain Size Effects ###################################################

#basalt
#bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")
#bc_13_50 <- subset(db_st, db_st$id_code == "BC-13-50")
#dunite
#df_13_50 <- subset(db_st, db_st$id_code == "DF-13-50")
#dm_13_50 <- subset(db_st, db_st$id_code == "DM-13-50")
#dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")


x <- 0
y <- 0
#basalt_fine
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BF-13-50" & db_st$duration_day == i])))
  basalt_fine = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BF-13-50" & db_st$duration_day == i]))) * x[i] / 100
  basalt_fine_sd = mean(y[c(1:4,7)])
}
#basalt_coarse
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BC-13-50" & db_st$duration_day == i])))
  basalt_coarse = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BC-13-50" & db_st$duration_day == i]))) * x[i] / 100
  basalt_coarse_sd = mean(y[c(1:4,7)])
}
#dunite_fine
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DF-13-50" & db_st$duration_day == i])))
  dunite_fine = sum(x[c(1:4)]) + (x[7]*2)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DF-13-50" & db_st$duration_day == i]))) * x[i] / 100
  dunite_fine_sd = mean(y[c(1:4,7)])
}
#dunite_medium
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DM-13-50" & db_st$duration_day == i])))
  dunite_medium = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DM-13-50" & db_st$duration_day == i]))) * x[i] / 100
  dunite_medium_sd = mean(y[c(1:4,7)])
}
#dunite_coarse
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DC-13-50" & db_st$duration_day == i])))
  dunite_coarse= sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DC-13-50" & db_st$duration_day == i]))) * x[i] / 100
  dunite_coarse_sd = mean(y[c(1:4,7)])
}

#concate
grain_effect <- data.frame(treatment =c("Basalt Fine", "Basalt Coarse", 
                                        "Dunite Fine", "Dunite Medium", "Dunite Coarse"),
                           TAlk_mmol_l = c(basalt_fine/1000, basalt_coarse/1000, dunite_fine/1000, dunite_medium/1000, dunite_coarse/1000),
                           sd = c(basalt_fine_sd/1000, basalt_coarse_sd/1000, dunite_fine_sd/1000, dunite_medium_sd/1000, dunite_coarse_sd/1000)
                           
)

#barplot
GE = barplot(height=grain_effect$TAlk_mmol_l, 
             #main = "B. Grain Sizes Effect",
             ylim = c(0,220),
             #ylab = substitute(paste(bold("Total Alkalinity in mEq"))),
             col=c(rep("grey40",2),rep("#9ab973",3)),
             names.arg = c("Fine", "Coarse",            #basalt lable
                           "Fine", "Medium", "Coarse"), #dunite lable
             font.axis = 2,
             yaxt = "n",  # Suppress default Y-axis
             
)
mtext("B. Grain Size Effect", side = 3, line = -1.0, adj = 0, cex = 1.75, font = 2)
axis(2, cex.axis = 1.7, font = 2)  # the character expansion factor


text(
  x = GE,
  y = grain_effect$TAlk_mmol_l,
  labels = round(grain_effect$TAlk_mmol_l, 1),
  pos = 3,
  srt = 0,
  offset = 1,
  font = 2,
  cex = 1.2
)
#standard deviation legend
arrows(x0 = GE, y0 = grain_effect$TAlk_mmol_l + grain_effect$sd,
       x1 = GE, y1 = grain_effect$TAlk_mmol_l - grain_effect$sd,
       code = 3, angle = 90, length = 0.2)



##### C. Rock-Water Ratio #####################################################

#bc_12 <- subset(db_st, db_st$id_code == "BC-12-50")
#bc_13 <- subset(db_st, db_st$id_code == "BC-13-50")
#bc_15 <- subset(db_st, db_st$id_code == "BC-15-50")
#dc_12 <- subset(db_st, db_st$id_code == "DC-12-50")
#dc_13 <- subset(db_st, db_st$id_code == "DC-13-50")
#dc_15 <- subset(db_st, db_st$id_code == "DC-15-50")


x <- 0
y <- 0
#Basalt 1 to 2
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BC-12-50" & db_st$duration_day == i])))
  bc_12 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BC-12-50" & db_st$duration_day == i]))) * x[i] / 100
  bc_12_sd = mean(y[c(1:4,7)])
}

#Basalt 1 to 3
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BC-13-50" & db_st$duration_day == i])))
  bc_13 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BC-13-50" & db_st$duration_day == i]))) * x[i] / 100
  bc_13_sd = mean(y[c(1:4,7)])
}

#Basalt 1 to 5
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BC-15-50" & db_st$duration_day == i])))
  bc_15 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BC-15-50" & db_st$duration_day == i]))) * x[i] / 100
  bc_15_sd = mean(y[c(1:4,7)])
}

#Dunite 1 to 2
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DC-12-50" & db_st$duration_day == i])))
  dc_12 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DC-12-50" & db_st$duration_day == i]))) * x[i] / 100
  dc_12_sd = mean(y[c(1:4,7)])
}

#Dunite 1 to 3
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DC-13-50" & db_st$duration_day == i])))
  dc_13 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DC-13-50" & db_st$duration_day == i]))) * x[i] / 100
  dc_13_sd = mean(y[c(1:4,7)])
}

#Dunite 1 to 5
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DC-15-50" & db_st$duration_day == i])))
  dc_15 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DC-15-50" & db_st$duration_day == i]))) * x[i] / 100
  dc_15_sd = mean(y[c(1:4,7)])
}

#concate
water_ratio <- data.frame(treatment =c("Basalt 1:2", "Basalt 1:3", "Basalt 1:5",
                                       "Dunite 1:2", "Dunite 1:3", "Dunite 1:5"),
                          TAlk_mmol_l = c(bc_12/1000, bc_13/1000, bc_15/1000, dc_12/1000, dc_13/1000, dc_15/1000),
                          sd = c(bc_12_sd/1000, bc_13_sd/1000, bc_15_sd/1000, dc_12_sd/1000, dc_13_sd/1000, dc_15_sd/1000)
                          
)

#barplot
RW = barplot(height=water_ratio$TAlk_mmol_l, 
             #main = "C. Rock-Water Ratio",
             ylim = c(0,220),
             #ylab = substitute(paste(bold("Total Alkalinity in mEq"))),
             col=c(rep("grey40",3),rep("#9ab973",3)),
             names.arg = c("1:2", "1:3", "1:5",  #basalt lable
                           "1:2", "1:3", "1:5"), #dunite lable
             font.axis = 2,
             yaxt = "n",  # Suppress default Y-axis
             
)
mtext("C. Rock-Water Ratio", side = 3, line = -1.0, adj = 0, cex = 1.75, font = 2)
axis(2, cex.axis = 1.7, font = 2)  # the character expansion factor


text(
  x = RW,
  y = water_ratio$TAlk_mmol_l,
  labels = round(water_ratio$TAlk_mmol_l, 1),
  pos = 3,
  srt = 0,
  offset = 1,
  font = 2,
  cex = 1.2
)
#standard deviation legend
arrows(x0 = RW, y0 = water_ratio$TAlk_mmol_l + water_ratio$sd,
       x1 = RW, y1 = water_ratio$TAlk_mmol_l - water_ratio$sd,
       code = 3, angle = 90, length = 0.2)

##### D. Water Replacement ####################################################
#Data Frame
bf_nwr <- subset(db_st, db_st$id_code == "BF-13-NWR-50")
#bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")
dc_nwr <- subset(db_st, db_st$id_code == "DC-13-NWR-50")
#dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")

x <- 0
y <- 0
#basalt no water replacement
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BF-13-NWR-50" & db_st$duration_day == i])))
  bf_nwr_st = (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BF-13-NWR-50" & db_st$duration_day == i]))) * x[i] / 100
  bf_nwr_sd = mean(y[c(1:4,7)])
}
#basalt 1:3
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BF-13-50" & db_st$duration_day == i])))
  bf_13 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BF-13-50" & db_st$duration_day == i]))) * x[i] / 100
  bf_13_sd = mean(y[c(1:4,7)])
}
#dunite no water replacement
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DC-13-NWR-50" & db_st$duration_day == i])))
  dc_nwr_st = (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DC-13-NWR-50" & db_st$duration_day == i]))) * x[i] / 100
  dc_nwr_sd = mean(y[c(1:4,7)])
}
#dunite 1:3
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DC-13-50" & db_st$duration_day == i])))
  dc_13 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DC-13-50" & db_st$duration_day == i]))) * x[i] / 100
  dc_13_sd = mean(y[c(1:4,7)])
}

#
replace_effect <- data.frame(treatment =c("bf_nwr_st", "bf_13", "dc_nwr_st", "dc_13"),
                             TAlk_mmol_l = c(bf_nwr_st/1000, bf_13/1000, dc_nwr_st/1000, dc_13/1000),
                             sd = c(bf_nwr_sd/1000, bf_13_sd/1000, dc_nwr_sd/1000, dc_13_sd/1000)
)
#barplot
RE = barplot(height=replace_effect$TAlk_mmol_l, 
             #main = "D. Water Replacement Effect",
             ylim = c(0,220),
             #ylab = substitute(paste(bold("Total Alkalinity in mEq"))),
             col=c(rep("grey40",2),rep("#9ab973",2)),
             names.arg = c("No", "33% Daily",
                           "No", "33% Daily"),
             font.axis = 2,
             yaxt = "n",  # Suppress default Y-axis
             
)
mtext("D. Water Replacement", side = 3, line = -1.0, adj = 0, cex = 1.75, font = 2)
axis(2, cex.axis = 1.7, font = 2)  # the character expansion factor

text(
  x = RE,
  y = replace_effect$TAlk_mmol_l,
  labels = round(replace_effect$TAlk_mmol_l, 1),
  pos = 3,
  srt = 0,
  offset = 1,
  font = 2,
  cex = 1.2
)
#standard deviation legend
arrows(x0 = RE, y0 = replace_effect$TAlk_mmol_l + replace_effect$sd,
       x1 = RE, y1 = replace_effect$TAlk_mmol_l - replace_effect$sd,
       code = 3, angle = 90, length = 0.2)










```

```{r "Alkalinity Produced per Surface Area", include=TRUE}

####### Data Wrangling ####
#Basanite
bf_13_50_flux <- subset(bf_13_50, duration_day >= 1)
bc_13_50_flux <- subset(bc_13_50, duration_day >= 1)
#Dunite
df_13_50_flux <- subset(df_13_50, duration_day >= 1)
dm_13_50_flux <- subset(dm_13_50, duration_day >= 1)
dc_13_50_flux <- subset(dc_13_50, duration_day >= 1)

#### Legends ####
#type of rocks
plot.new()
legend("topleft",
       title = expression(bold("Type of Rocks")),
       legend=c("Basanite", "Dunite" ),
       col =  c("grey50", "#9ab973"),
       pch = c(22,22),
       cex = 1.25,
       pt.bg = c("grey50", "#9ab973"),
       # horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n",
       # x.intersp = 1,
       # y.intersp=2,
)

#grain size
plot.new()
legend("topleft",
       title = expression(bold("Grain Size")),
       legend=c("Fine", "Medium", "Coarse" ),
       col =  "black",
       pch = c(21, 24, 22),
       cex = 1.25,
       pt.bg = "black",
       # horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n",
       # x.intersp = 1,
       # y.intersp=2,
)



####### Set Layout ####
#### Export as a PNG with width = 1200 and height = 600
par(cex.main = 1.5,  # Font size for main title
    cex.lab = 1.25,  # Font size for xlab and ylab
    cex.axis = 1.25, # Font size for axis tick labels
    las = 1)
par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right

par(mfrow=c(1,2)) #merging multiple plots into one figure


#### Alkalinity Flux  ####
#### Basalt
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
plot(bf_13_50_flux$duration_day, ((bf_13_50_flux$TA_AWR_umol_kg*3)/(ssa_basalt_fine*1000)), 
     # main = "Basanite - Alkalinity Flux",
     type = "b", cex=2.75, pch = 21, col = "black", bg = "grey50",
     ylim = c(0,3),
     xlab = substitute(paste(bold("Day"))), 
     #ylab = expression(bold("µmol of Alkalinity Produced / m"^"2")),
     # ylab = expression(bold("Alkalinity Flux in µEq / m"^"2"*".day")),
     ylab = expression(bold("TA Flux in"~µEq %.% m^-2 %.% day^-1)),

)

points(bc_13_50_flux$duration_day, ((bc_13_50_flux$TA_AWR_umol_kg*3)/(ssa_basalt_coarse*1000)), 
       type = "b", cex=2.75, pch = 22, col = "black", bg = "grey50")

#add sub-heading
text(x = 2,
     y = 2.75,
     labels = expression(bold("A")),
     cex = 3,
     pos = 2
     )

#Title
mtext(expression(bold("Basanite")), side = 3, cex = 2, adj = 0, line = 1)

legend("topright",
       title = expression(bold("Grain Size")),
       legend=c("Fine", "Coarse" ),
       col =  "black",
       pch = c(21, 22),
       cex = 1.25,
       pt.bg = "black",
       # horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n",
       # x.intersp = 1,
       y.intersp=2,
)


#### Corrected flux - assuming no grinding effects
#bf_13_50_flux <- bf_13_50_flux %>% mutate (TA_normalized_umol_kg = case_when(
#  duration_day < 1 ~ TA_AWR_umol_kg,
#  duration_day < 2 & duration_day >= 1 ~ TA_AWR_umol_kg*1.4,
#  duration_day < 3 & duration_day >= 2 ~ TA_AWR_umol_kg*2.2,
#  duration_day < 4 & duration_day >= 3 ~ TA_AWR_umol_kg*2.25,
#  duration_day >= 4 ~ TA_AWR_umol_kg*3,
#))

#points(bf_13_50_flux$duration_day, ((bf_13_50_flux$TA_normalized_umol_kg*3)/(ssa_basalt_fine*1000)), 
#       type = "b", cex=2.75, lty = 2, pch = 21, col = "black", bg = "darkblue")

# legend("topleft", 
#        #title = "Mechanical Speed",
#        legend=c("Fine Grain Size", "Coarse Grain Size"),
#        col = "black",
#        pch = c(21,22),
#        cex = 1.15,
#        pt.bg = c("grey50", "grey50"),
#        lty = c(1,1),
#        #horiz = TRUE,
#        ncol = 1,
#        inset = 0.02,
#        title.adj=0.1,
#        bty = "n",
# )


#### Dunite
#par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
plot(df_13_50_flux$duration_day, ((df_13_50_flux$TA_AWR_umol_kg*3)/(ssa_dunite_fine*1000)),
     # main = "Dunite - Alkalinity Flux",
     type = "b", cex=2.75, pch = 21, col = "black", bg = "#9ab973",
     ylim = c(0,30),
     xlab = substitute(paste(bold("Day"))), 
     #ylab = expression(bold("µmol of Alkalinity Produced / m"^"2")),
     # ylab = expression(bold("Alkalinity Flux in µEq / m"^"2"*".day")),
     ylab = expression(bold("TA Flux in"~µEq %.% m^-2 %.% day^-1)),
     )

points(dm_13_50_flux$duration_day, ((dm_13_50_flux$TA_AWR_umol_kg*3)/(ssa_dunite_medium*1000)), 
       type = "b", cex=2.75, pch = 24, col = "black", bg = "#9ab973")
points(dc_13_50_flux$duration_day, ((dc_13_50_flux$TA_AWR_umol_kg*3)/(ssa_dunite_coarse*1000)), 
       type = "b", cex=2.75, pch = 22, col = "black", bg = "#9ab973")

#add sub-heading
text(x = 2,
     y = 27.5,
     labels = expression(bold("B")),
     cex = 3,
     pos = 2
     )

#Title
mtext(expression(bold("Dunite")), side = 3, cex = 2, adj = 0, line = 1)

legend(x = 5, y = 15,
       title = expression(bold("Grain Size")),
       legend=c("Fine", "Medium", "Coarse" ),
       col =  "black",
       pch = c(21, 24, 22),
       cex = 1.25,
       pt.bg = "black",
       # horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n",
       # x.intersp = 1,
       y.intersp=2,
)

#### Corrected flux - assuming no grinding effects
#points(df_13_50_flux$duration_day, ((df_13_50_flux$TA_AWR_umol_kg*3)/(ssa_dunite_fine*1000)*9.25), 
#       type = "b", lty = 2, cex=2.75, pch = 22, col = "black", bg = "darkblue")

# legend("topleft", 
#        #title = "Mechanical Speed",
#        legend=c("Fine Grain Size", "Medium Grain Size","Coarse Grain Size"),
#        col = "black",
#        pch = c(21,24,22),
#        cex = 1.15,
#        pt.bg = c("#9ab973", "#9ab973", "#9ab973"),
#        lty = c(1,1,1),
#        #horiz = TRUE,
#        ncol = 1,
#        inset = 0.02,
#        title.adj=0.1,
#        bty = "n",
# )

##############################################################################x
#### Alkalinity per Mass of Rocks #############################################
##############################################################################x

#### Basalt
par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
plot(bf_13_50_flux$duration_day, ((bf_13_50_flux$TA_AWR_umol_kg*3)/(1000)), 
     # main = "Basanite - TA Produced/Mass of Rock",
     type = "b", cex=2.75, pch = 21, col = "black", bg = "grey50",
     ylim = c(0,25),
     xlab = substitute(paste(bold("Day"))), 
     #ylab = expression(bold("µmol of Alkalinity Produced / m"^"2")),
     ylab = expression(bold("Alkalinity Produced in µEq / gram of rock. day"))
)

points(bc_13_50_flux$duration_day, ((bc_13_50_flux$TA_AWR_umol_kg*3)/(1000)), 
       type = "b", cex=2.75, pch = 22, col = "black", bg = "grey50")

#add sub-heading
text(x = 7,
     y = 22.5,
     labels = expression(bold("C")),
     cex = 3,
     pos = 2
     )

#### Corrected flux - assuming no grinding effects
#bf_13_50_flux <- bf_13_50_flux %>% mutate (TA_normalized_umol_kg = case_when(
#  duration_day < 1 ~ TA_AWR_umol_kg,
#  duration_day < 2 & duration_day >= 1 ~ TA_AWR_umol_kg*1.4,
#  duration_day < 3 & duration_day >= 2 ~ TA_AWR_umol_kg*2.2,
#  duration_day < 4 & duration_day >= 3 ~ TA_AWR_umol_kg*2.25,
#  duration_day >= 4 ~ TA_AWR_umol_kg*3,
#))

#points(bf_13_50_flux$duration_day, ((bf_13_50_flux$TA_normalized_umol_kg*3)/(1000)), 
#       type = "b", cex=2.75, lty = 2, pch = 21, col = "black", bg = "darkblue")

# legend("topleft", 
#        #title = "Mechanical Speed",
#        legend=c("Fine Grain Size", "Coarse Grain Size"),
#        col = "black",
#        pch = c(21,22),
#        cex = 1.15,
#        pt.bg = c("grey50", "grey50"),
#        lty = c(1,1),
#        #horiz = TRUE,
#        ncol = 1,
#        inset = 0.02,
#        title.adj=0.1,
#        bty = "n",
# )


#### Dunite
par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
plot(df_13_50_flux$duration_day, ((df_13_50_flux$TA_AWR_umol_kg*3)/(1000)),
     # main = "Dunite - TA Produced/Mass of Rock",
     type = "b", cex=2.75, pch = 21, col = "black", bg = "#9ab973",
     ylim = c(0,50),
     xlab = substitute(paste(bold("Day"))), 
     #ylab = expression(bold("µmol of Alkalinity Produced / m"^"2")),
     ylab = expression(bold("Alkalinity Produced in µEq / gram of rock. day"))
     
)

points(dm_13_50_flux$duration_day, ((dm_13_50_flux$TA_AWR_umol_kg*3)/(1000)), 
       type = "b", cex=2.75, pch = 24, col = "black", bg = "#9ab973")
points(dc_13_50_flux$duration_day, ((dc_13_50_flux$TA_AWR_umol_kg*3)/(1000)), 
       type = "b", cex=2.75, pch = 22, col = "black", bg = "#9ab973")

#add sub-heading
text(x = 7,
     y = 45,
     labels = expression(bold("D")),
     cex = 3,
     pos = 2
     )


#### Corrected flux - assuming no grinding effects
#points(df_13_50_flux$duration_day, ((df_13_50_flux$TA_AWR_umol_kg*3)/(1000)*9.25), 
#      type = "b", lty = 2, cex=2.75, pch = 21, col = "black", bg = "darkblue")

# legend("topleft", 
#        #title = "Mechanical Speed",
#        legend=c("Fine Grain Size", "Medium Grain Size","Coarse Grain Size"),
#        col = "black",
#        pch = c(21,24,22),
#        cex = 1.15,
#        pt.bg = c("#9ab973", "#9ab973", "#9ab973"),
#        lty = c(1,1,1),
#        #horiz = TRUE,
#        ncol = 1,
#        inset = 0.02,
#        title.adj=0.1,
#        bty = "n",
# )


```

```{r "Subset Data - According to the rocks!", include=TRUE}
#### Subset data for Dunite only #############################################################
#subset data for dunite 
db_st_dunite <- subset(db_st, db_st$rock_type == "dunite")


#### Data Wrangling for db_st_dunite #########################################################x
#delete data for day 7 where Mg concentration = 0
db_st_dunite <- db_st_dunite[!(db_st_dunite$duration_day == 7 & db_st_dunite$Mg_umol_l == 0), ]
#delete data for where Mg is missing (NA)
db_st_dunite <- db_st_dunite[complete.cases(db_st_dunite$Mg_umol_l), ]

#delete data for day 7 where Ca concentration = 0
db_st_dunite <- db_st_dunite[!(db_st_dunite$Ca_umol_l == 0), ]

#### Data Wrangling for db_st_dunite per grain size ############################################x
#subset data according to its grain size
db_st_dunite_fine <- subset(db_st_dunite , db_st_dunite$grain_size == "fine")
db_st_dunite_medium <- subset(db_st_dunite , db_st_dunite$grain_size == "medium")
db_st_dunite_coarse <- subset(db_st_dunite , db_st_dunite$grain_size == "coarse")

#### Data Wrangling for db_st_dunite_fraction ###################################################x
# only water replaced
db_st_dunite_fraction <- db_st_dunite[!db_st_dunite$water_replacement == "no",]
# only normal treatment (no pressure cooked nor cooked, only 50 rpm)
db_st_dunite_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$pressure_cooked == "no",]
db_st_dunite_fraction <- db_st_dunite_fraction[!db_st_dunite_fraction$id_code == "DM-13-C-50",]
db_st_dunite_fraction <- db_st_dunite_fraction[!db_st_dunite_fraction$id_code == "rpm_medium",]
db_st_dunite_fraction <- db_st_dunite_fraction[!db_st_dunite_fraction$id_code == "DC-13-C-50",]

# only 1:3 ratio
db_st_dunite_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$rock_water_ratio == "1 to 3",]

#dunite fine, medium, and coarse for db_st_fraction
db_st_dunite_fine_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$grain_size == "fine",]
db_st_dunite_coarse_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$grain_size == "coarse",]


#### Subset data for Basalt only #############################################################
#subset data for basalt
db_st_basalt <- subset(db_st, db_st$rock_type == "basalt")

#delete data for where Ca is missing (NA)
db_st_basalt<- db_st_basalt[complete.cases(db_st_basalt$Ca_umol_l), ]
#delete data for where Ca is 0
db_st_basalt <- db_st_basalt[!(db_st_basalt$Ca_umol_l == 0), ]

#### Data Wrangling for db_st_basalt per grain size ############################################x
db_st_basalt_fine <- subset(db_st_basalt , db_st_basalt$grain_size == "fine")
db_st_basalt_coarse <- subset(db_st_basalt , db_st_basalt$grain_size == "coarse")

#### Data Wrangling for db_st_basalt_fraction ###################################################x
# only water replaced
db_st_basalt_fraction <- db_st_basalt[!db_st_basalt$water_replacement == "no",]

# only normal treatment
db_st_basalt_fraction <- db_st_basalt_fraction[db_st_basalt_fraction$pressure_cooked == "no",]

# only 1:3 ratio
db_st_basalt_fraction <- db_st_basalt_fraction[db_st_basalt_fraction$rock_water_ratio == "1 to 3",]

#dunite fine, medium, and coarse
db_st_basalt_fine_fraction <- db_st_basalt_fraction[db_st_basalt_fraction$grain_size == "fine",]
db_st_basalt_medium_fraction <- db_st_basalt_fraction[db_st_basalt_fraction$grain_size == "medium",]
db_st_basalt_coarse_fraction <- db_st_basalt_fraction[db_st_basalt_fraction$grain_size == "coarse",]


#level coarse:22, fine:21, medium:24
#level coarse:"#034e7b", fine:"#f1eef6", medium:"#74a9cf"


```

```{r "Basanite and Dunite - Cation and Anion Fraction", include=TRUE}
##### Cations ####
##### Set the layout ####
par(mfrow=c(2,3), #rows, columns several plots into one
    cex.main = 1.5,  # Font size for main title
    cex.lab = 1.75,  # Font size for xlab and ylab
    cex.axis = 1.5, # Font size for axis tick labels
    las = 1) #Rotate 90% for y-label
par(mar = c(4, 5, 5, 1)) #margin bottom, left, up, right
#### Dunite ####
# par(mar = c(3, 5, 5, 2)) #margin bottom, left, up, right
#magnesium
plot(x = db_st_dunite_fraction$duration_day, 
     y = db_st_dunite_fraction$fraction_Mg*100,
     ylim = c(0,100),
     xlab = expression(bold("Day")),
     ylab = expression(bold("Mg"^paste(2,"+")*"  fraction from ΣCations (%)")),
     pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)],
     col = "black", 
     bg = c( "#034e7b", "#f1eef6", "#74a9cf")[as.factor(db_st_dunite_fraction$grain_size)], 
     cex = 3,
)
#Label for Sub-Title
text(x = 0,
     y = 95,
     labels = expression(bold("Mg"^paste(2,"+"))),
     cex = 2.5,
     pos = 4
     )
#Title
mtext("Dunite", side=3, cex = 2, adj = 0, line = 1)



#na + k
plot(x = db_st_dunite_fraction$duration_day, 
     y = (db_st_dunite_fraction$fraction_Na + db_st_dunite_fraction$fraction_K)*100,
     ylim = c(0,100),
     xlab = expression(bold("Day")),
     ylab = expression(bold("Na"^paste("+")*" + K"^paste("+")*"  fraction from ΣCations (%)")),
     pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)],
     col = "black", 
     bg = c( "#034e7b", "#f1eef6", "#74a9cf")[as.factor(db_st_dunite_fraction$grain_size)], 
     cex = 3,
)
#Label for Sub-Title
text(x = 0,
     y = 95,
     labels = expression(bold("Na"^paste("+")*" + K"^paste("+"))),
     cex = 2.5,
     pos = 4
     )



#calcium
plot(x = db_st_dunite_fraction$duration_day, 
     y = db_st_dunite_fraction$fraction_Ca*100,
     ylim = c(0,100),
     xlab = expression(bold("Day")),
     ylab = expression(bold("Ca"^paste(2,"+")*"  fraction from ΣCations (%)")),
     pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)],
     col = "black", 
     bg = c( "#034e7b", "#f1eef6", "#74a9cf")[as.factor(db_st_dunite_fraction$grain_size)], 
     cex = 3,
)
#Label for Sub-Title
text(x = 0,
     y = 95,
     labels = expression(bold("Ca"^paste(2,"+"))),
     cex = 2.5,
     pos = 4
     )


#### Basanite ####
# par(mar = c(5, 5, 5, 2)) #margin bottom, left, up, right
#Mg
plot(x = db_st_basalt_fraction$duration_day, 
     y = db_st_basalt_fraction$fraction_Mg*100,
     ylim = c(0,100),
     xlab = expression(bold("Day")),
     ylab = expression(bold("Mg"^paste(2,"+")*"  fraction from ΣCations (%)")),
     pch = c(22,21)[as.factor(db_st_basalt_fraction$grain_size)],
     col = "black", 
     bg = c("#034e7b", "#f1eef6")[as.factor(db_st_basalt_fraction$grain_size)],
     cex = 3,
)
#Label for Sub-Title
text(x = 0,
     y = 95,
     labels = expression(bold("Mg"^paste(2,"+"))),
     cex = 2.5,
     pos = 4
     )
#Title
mtext("Basanite", side=3, cex = 2, adj = 0, line = 1)



#Na+K
plot(x = db_st_basalt_fraction$duration_day, 
     y = (db_st_basalt_fraction$fraction_Na + db_st_basalt_fraction$fraction_K)*100,
     ylim = c(0,100),
     xlab = expression(bold("Day")),
     ylab = expression(bold("Na"^paste("+")*" + K"^paste("+")*"  fraction from ΣCations (%)")),
     pch = c(22,21)[as.factor(db_st_basalt_fraction$grain_size)],
     col = "black", 
     bg = c("#034e7b", "#f1eef6")[as.factor(db_st_basalt_fraction$grain_size)],
     cex = 3,
)
#Label for Sub-Title
text(x = 0,
     y = 95,
     labels = expression(bold("Na"^paste("+")*" + K"^paste("+"))),
     cex = 2.5,
     pos = 4
     )




#Ca
plot(x = db_st_basalt_fraction$duration_day, 
     y = db_st_basalt_fraction$fraction_Ca*100,
     ylim = c(0,100),
     xlab = expression(bold("Day")),
     ylab = expression(bold("Ca"^paste(2,"+")*"  fraction from ΣCations (%)")),
     pch = c(22,21)[as.factor(db_st_basalt_fraction$grain_size)],
     col = "black", 
     bg = c("#034e7b", "#f1eef6")[as.factor(db_st_basalt_fraction$grain_size)],
     cex = 3,
)
#Label for Sub-Title
text(x = 0,
     y = 95,
     labels = expression(bold("Ca"^paste(2,"+"))),
     cex = 2.5,
     pos = 4
     )

#####Anions ####
##### Set the layout ####
par(mfrow=c(2,4), #rows, columns several plots into one
    cex.main = 1.5,  # Font size for main title
    cex.lab = 1.75,  # Font size for xlab and ylab
    cex.axis = 1.5, # Font size for axis tick labels
    las = 1) #Rotate 90% for y-label
par(mar = c(4, 5, 5, 1)) #margin bottom, left, up, right

#### Dunite ####
###Anion
#TA
plot(x = db_st_dunite_fraction$duration_day, 
     y = db_st_dunite_fraction$fraction_TA*100,
     ylim = c(60,100),
     xlab = expression(bold("Day")),
     ylab = expression(bold("TA fraction from ΣAnions (%)")),
     pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)],
     col = "black", 
     bg = c( "#034e7b", "#f1eef6", "#74a9cf")[as.factor(db_st_dunite_fraction$grain_size)], 
     cex = 2.5,
)
#Label for Sub-Title
text(x = 7,
     y = 80,
     labels = expression(bold("TA")),
     cex = 2.5,
     pos = 2
     )
#Title
mtext("Dunite", side=3, cex = 2, adj = 0, line = 1)



#SO42
plot(x = db_st_dunite_fraction$duration_day, 
     y = db_st_dunite_fraction$fraction_SO42*100,
     ylim = c(0,20),
     xlab = expression(bold("Day")),
     ylab = expression(bold("SO"[4]^paste(2,"-")*"  fraction from ΣAnions (%)")),
     pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)],
     col = "black", 
     bg = c( "#034e7b", "#f1eef6", "#74a9cf")[as.factor(db_st_dunite_fraction$grain_size)], 
     cex = 2.5,
)
#Label for Sub-Title
text(x = 7,
     y = 10,
     labels =  expression(bold("SO"[4]^paste(2,"-"))),
     cex = 2.5,
     pos = 2
     )


#NO3
plot(x = db_st_dunite_fraction$duration_day, 
     y = (db_st_dunite_fraction$fraction_NO3)*100,
     ylim = c(0,20),
     xlab = expression(bold("Day")),
     ylab = expression(bold("NO"[3]^paste("-")*"  fraction from ΣAnions (%)")),
     pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)],
     col = "black", 
     bg = c( "#034e7b", "#f1eef6", "#74a9cf")[as.factor(db_st_dunite_fraction$grain_size)], 
     cex = 2.5,
)
#Label for Sub-Title
text(x = 7,
     y = 10,
     labels =  expression(bold("NO"[3]^paste("-"))),
     cex = 2.5,
     pos = 2
     )


#Cl
plot(x = db_st_dunite_fraction$duration_day, 
     y = (db_st_dunite_fraction$fraction_Cl)*100,
     ylim = c(0,20),
     xlab = expression(bold("Day")),
     ylab = expression(bold("Cl"^paste("-")*"  fraction from ΣAnions (%)")),
     pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)],
     col = "black", 
     bg = c( "#034e7b", "#f1eef6", "#74a9cf")[as.factor(db_st_dunite_fraction$grain_size)], 
     cex = 2.5,
)
#Label for Sub-Title
text(x = 7,
     y = 10,
     labels =  expression(bold("Cl"^paste("-"))),
     cex = 2.5,
     pos = 2
     )

#### Basanite ####
###Anion
#TA
plot(x = db_st_basalt_fraction$duration_day, 
     y = db_st_basalt_fraction$fraction_TA*100,
     ylim = c(60,100),
     xlab = expression(bold("Day")),
     ylab = expression(bold("TA fraction from ΣAnions (%)")),
     pch = c(22,21)[as.factor(db_st_basalt_fraction$grain_size)],
     col = "black", 
     bg = c("#034e7b", "#f1eef6")[as.factor(db_st_basalt_fraction$grain_size)],
     cex = 2.5,
)
#Label for Sub-Title
text(x = 7,
     y = 80,
     labels = expression(bold("TA")),
     cex = 2.5,
     pos = 2
     )
#Title
mtext("Basanite", side=3, cex = 2, adj = 0, line = 1)



#SO42
plot(x = db_st_basalt_fraction$duration_day, 
     y = db_st_basalt_fraction$fraction_SO42*100,
     ylim = c(0,20),
     xlab = expression(bold("Day")),
     ylab = expression(bold("SO"[4]^paste(2,"-")*"  fraction from ΣAnions (%)")),
     pch = c(22,21)[as.factor(db_st_basalt_fraction$grain_size)],
     col = "black", 
     bg = c("#034e7b", "#f1eef6")[as.factor(db_st_basalt_fraction$grain_size)],
     cex = 2.5,
)
#Label for Sub-Title
text(x = 7,
     y = 10,
     labels =  expression(bold("SO"[4]^paste(2,"-"))),
     cex = 2.5,
     pos = 2
     )



#NO3
plot(x = db_st_basalt_fraction$duration_day, 
     y = (db_st_basalt_fraction$fraction_NO3)*100,
     ylim = c(0,20),
     xlab = expression(bold("Day")),
     ylab = expression(bold("NO"[3]^paste("-")*"  fraction from ΣAnions (%)")),
     pch = c(22,21)[as.factor(db_st_basalt_fraction$grain_size)],
     col = "black", 
     bg = c("#034e7b", "#f1eef6")[as.factor(db_st_basalt_fraction$grain_size)],
     cex = 2.5,
)
#Label for Sub-Title
text(x = 7,
     y = 10,
     labels =  expression(bold("NO"[3]^paste("-"))),
     cex = 2.5,
     pos = 2
     )



#Cl
plot(x = db_st_basalt_fraction$duration_day, 
     y = (db_st_basalt_fraction$fraction_Cl)*100,
     ylim = c(0,20),
     xlab = expression(bold("Day")),
     ylab = expression(bold("Cl"^paste("-")*"  fraction from ΣAnions (%)")),
     pch = c(22,21)[as.factor(db_st_basalt_fraction$grain_size)],
     col = "black", 
     bg = c("#034e7b", "#f1eef6")[as.factor(db_st_basalt_fraction$grain_size)],
     cex = 2.5,
)
#Label for Sub-Title
text(x = 7,
     y = 10,
     labels =  expression(bold("Cl"^paste("-"))),
     cex = 2.5,
     pos = 2
     )

 
#### Legend ####

plot.new()
# plot(x = c(0,10),
#      y = c(0,10),
#      xlab = "",
#      ylab = "",
#      axes = FALSE,
#      bty = "n",
#      col = "white"
# )

#### Grain Size by the shapes
legend("topleft",
       title = as.expression(bquote(bold("Grain Size"))),
       legend = c(levels(as.factor(db_st_dunite_fraction$grain_size))),
       pt.bg = c( "#034e7b", "#f1eef6", "#74a9cf"),
       col = "black",
       pch = c(22,21,24),
       ncol = 1,
       bty = "n",
       cex = 1.5,
       horiz = TRUE
)



# 
# plot.new()
# #### Rock-Water Ratio
# legend("topleft",
#        title = as.expression(bquote(bold("Rock-Water Ratio"))),
#        legend = c(levels(as.factor(db_st_dunite_fraction$rock_water_ratio))),
#        pt.bg = c("#f1eef6", "#74a9cf", "#034e7b"),
#        col = "black",
#        pch = 21,
#        ncol = 1,
#        bty = "n",
#        cex = 1.5,
#        #horiz = TRUE
# )


```

```{r "Basanite and Dunite - Cations and TA", include=TRUE}

################################################################################
##### Plot all scneario into 1 plot#####
par(mfrow=c(2,3))
par(mfrow=c(2,3), #rows, columns several plots into one
    cex.main = 1.5,  # Font size for main title
    cex.lab = 1.75,  # Font size for xlab and ylab
    cex.axis = 1.5, # Font size for axis tick labels
    las = 1)
############################################X



#### Sequence for data (line) ####
seq_x <-seq(from = -10000, to = 100000, by = 1)


###########################################X
##### Legend ###############################
###########################################X

# plot.new()
# #### Legend Day
# legend("topleft",
#        title = as.expression(bquote(bold("Day of Observation"))),
#        legend = c(levels(as.factor(db_st_dunite$legend_day))),
#        pt.bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b"),
#        col = "black",
#        pch = 21,
#        ncol = 2,
#        bty = "n",
#        cex = 1.1,
#        horiz = TRUE
# )
# #### Grain Size
# legend("topright",
#        title = as.expression(bquote(bold("Grain Size"))),
#        legend = c(levels(as.factor(db_st_dunite$grain_size))),
#        pt.bg = c("black"),
#        col = "black",
#        pch = c(22,21,24),
#        ncol = 1,
#        bty = "n",
#        cex = 1.1,
#        horiz = TRUE
# )
# #### Legend line
# legend("bottomleft",
#        legend = c("Quadratic - 2nd Degree"),
#        lty = 2,
#        col = c("darkblue"),
#        bty = "n"
# )



##################################################################X
#### Dunite Mg vs Total Alkalinity (represent HCO3 and CO32-) ####
##################################################################X
par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
plot(x = db_st_dunite$Mg_umol_l * 2 * 10^-3, 
     y = db_st_dunite$TA_umol_kg * 10^-3,
     xlim = c(0, 30),
     ylim = c(0, 30),
     xlab = expression(bold("Mg"^"2+"*" in mEq/L")),
     #ylab = expression(bold("Total Alkalinity in mEq/L")),
     ylab = expression(bold("TA in"~mEq %.% kg^-1)),
     pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
     col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
     cex = 4
)
##### 1:1 Line #####
# lines(seq_x, (seq_x*1),
#       lty = 1)
# text(x = 20, y = 20,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 4,
#      cex = 1.5)
# #1:5 lines
# lines(seq_x, (seq_x*1.5),
#       lty = 6)
# text(x = 30, y = 45,
#      labels = as.expression(bquote(bold("y = 1.5 x"))),
#      pos = 2,
#      cex = 1.5)
# # 1:1.1 lines
# lines(seq_x, (seq_x*1.1),
#       lty = 6)
# text(x = 40.5, y = 45,
#      labels = as.expression(bquote(bold("y = 1.1 x"))),
#      pos = 2,
#      cex = 1.5)

##### linear regression ####
# Fit linear regression model
x = db_st_dunite$Mg_umol_l * 2 * 10^-3
y = db_st_dunite$TA_umol_kg * 10^-3
lm_model <- lm(y ~ x)

# Summary of the regression model
summary(lm_model)

# Plot the data and regression line
abline(lm_model, 
       col = "black",
       lty = 2)

# Get the coefficients
coefficients <- coef(lm_model)

# Print the coefficients
print(coefficients)

# Add lable for formula
text(x = 23, y = 1.1*23,
     labels = as.expression(bquote(bold("y = 1.1 x"))),
     pos = 2,
     cex = 1.5)

# Calculate R-squared value
rsquared <- summary(lm_model)$r.squared
print(paste("R-squared:", rsquared))

# Add lable for R-squared
text(x = 22, y = 1.1*22,
     labels = expression(bold("R"^"2"*" = 0.99")),
     pos = 2,
     cex = 1.5)


##################################################################X
#### Dunite Na+K vs Total Alkalinity (represent HCO3 and CO32-) ####
##################################################################X
par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
plot(x = (db_st_dunite$Na_umol_l + db_st_dunite$K_umol_l) * 10^-3, 
     y = (db_st_dunite$TA_umol_kg) * 10^-3,
     xlim = c(0, 2),
     ylim = c(0, 30),
     xlab = expression(bold("Na"^"+"*" + K"^"+"*" in mEq/L")),
     ylab = expression(bold("TA in"~mEq %.% kg^-1)),
     pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
     col = "black",  bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
     cex = 4
)


##### log relationship for all grain size #### ####
x = (db_st_dunite$Na_umol_l + db_st_dunite$K_umol_l) * 10^-3
y = (db_st_dunite$TA_umol_kg) * 10^-3
#plot(x, y)

# Fit an exponential regression model
model <- lm(log(y) ~ x)

# Extract coefficients
intercept <- exp(coef(model)[1])
slope <- coef(model)[2]

# Print coefficients
print(paste("Intercept:", intercept))
print(paste("Slope:", slope))

# Calculate R-squared value
rsquared <- summary(model)$r.squared
print(paste("R-squared:", rsquared))

# Plot the original data and the fitted exponential curve
x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 100)
y_pred <- intercept * exp(slope * x_pred)

#plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
lines(x_pred, y_pred, col = "black", type = "l", lty = 2)

# # Calculate upper and lower bounds of confidence interval
# se_intercept <- coef(summary(model))[1, "Std. Error"]
# se_slope <- coef(summary(model))[2, "Std. Error"]
# upper <- y_pred * exp(2 * sqrt(se_intercept^2 + (x * se_slope)^2))
# lower <- y_pred * exp(-2 * sqrt(se_intercept^2 + (x * se_slope)^2))
# polygon(c(x_pred, rev(x_pred)), c(upper, rev(lower)), col = "#CCCCCC80", border = NA)

#add text
text(x = 1.25, y = intercept * exp(slope * 1.25),
     labels = expression(bold("R"^"2"*" = 0.68")),
     pos = 4,
     cex = 1.5)

# ##### log relationship for fine grain size #### ####
# x = (db_st_dunite_fine$Na_umol_l + db_st_dunite_fine$K_umol_l) * 10^-3
# y = (db_st_dunite_fine$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# # Fit an exponential regression model
# model <- lm(log(y) ~ x)
# 
# # Extract coefficients
# intercept <- exp(coef(model)[1])
# slope <- coef(model)[2]
# 
# # Print coefficients
# print(paste("Intercept:", intercept))
# print(paste("Slope:", slope))
# 
# # Calculate R-squared value
# rsquared <- summary(model)$r.squared
# print(paste("R-squared:", rsquared))
# 
# # Plot the original data and the fitted exponential curve
# x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
# y_pred <- intercept * exp(slope * x_pred)
# 
# #plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
# lines(x_pred, y_pred, col = "black", type = "l", lty = 2)
# 
# # Calculate upper and lower bounds of confidence interval
# se_intercept <- coef(summary(model))[1, "Std. Error"]
# se_slope <- coef(summary(model))[2, "Std. Error"]
# upper <- y_pred * exp(2 * sqrt(se_intercept^2 + (x * se_slope)^2))
# lower <- y_pred * exp(-2 * sqrt(se_intercept^2 + (x * se_slope)^2))
# polygon(c(x_pred, rev(x_pred)), c(upper, rev(lower)), col = "#CCCCCC80", border = NA)
# 
# #add text
# text(x = 1.25, y = intercept * exp(slope * 1.25),
#      labels = expression(bold("R"^"2"*" = 0.68")),
#      pos = 4,
#      cex = 1.5)
# 
# ##### log relationship for medium grain size #### ####
# x = (db_st_dunite_medium$Na_umol_l + db_st_dunite_medium$K_umol_l) * 10^-3
# y = (db_st_dunite_medium$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# # Fit an exponential regression model
# model <- lm(log(y) ~ x)
# 
# # Extract coefficients
# intercept <- exp(coef(model)[1])
# slope <- coef(model)[2]
# 
# # Print coefficients
# print(paste("Intercept:", intercept))
# print(paste("Slope:", slope))
# 
# # Calculate R-squared value
# rsquared <- summary(model)$r.squared
# print(paste("R-squared:", rsquared))
# 
# # Plot the original data and the fitted exponential curve
# x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
# y_pred <- intercept * exp(slope * x_pred)
# 
# #plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
# lines(x_pred, y_pred, col = "black", type = "l", lty = 2)
# 
# # Calculate upper and lower bounds of confidence interval
# se_intercept <- coef(summary(model))[1, "Std. Error"]
# se_slope <- coef(summary(model))[2, "Std. Error"]
# upper <- y_pred * exp(2 * sqrt(se_intercept^2 + (x * se_slope)^2))
# lower <- y_pred * exp(-2 * sqrt(se_intercept^2 + (x * se_slope)^2))
# polygon(c(x_pred, rev(x_pred)), c(upper, rev(lower)), col = "#CCCCCC80", border = NA)
# 
# #add text
# text(x = 1.25, y = intercept * exp(slope * 1.25),
#      labels = expression(bold("R"^"2"*" = 0.68")),
#      pos = 4,
#      cex = 1.5)
# 
# ##### log relationship for coarse grain size #### ####
# x = (db_st_dunite_coarse$Na_umol_l + db_st_dunite_coarse$K_umol_l) * 10^-3
# y = (db_st_dunite_coarse$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# # Fit an exponential regression model
# model <- lm(log(y) ~ x)
# 
# # Extract coefficients
# intercept <- exp(coef(model)[1])
# slope <- coef(model)[2]
# 
# # Print coefficients
# print(paste("Intercept:", intercept))
# print(paste("Slope:", slope))
# 
# # Calculate R-squared value
# rsquared <- summary(model)$r.squared
# print(paste("R-squared:", rsquared))
# 
# # Plot the original data and the fitted exponential curve
# x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
# y_pred <- intercept * exp(slope * x_pred)
# 
# #plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
# lines(x_pred, y_pred, col = "black", type = "l", lty = 2)
# 
# # Calculate upper and lower bounds of confidence interval
# se_intercept <- coef(summary(model))[1, "Std. Error"]
# se_slope <- coef(summary(model))[2, "Std. Error"]
# upper <- y_pred * exp(2 * sqrt(se_intercept^2 + (x * se_slope)^2))
# lower <- y_pred * exp(-2 * sqrt(se_intercept^2 + (x * se_slope)^2))
# polygon(c(x_pred, rev(x_pred)), c(upper, rev(lower)), col = "#CCCCCC80", border = NA)
# 
# #add text
# text(x = 1.25, y = intercept * exp(slope * 1.25),
#      labels = expression(bold("R"^"2"*" = 0.68")),
#      pos = 4,
#      cex = 1.5)

##################################################################X
#### Dunite Ca vs Total Alkalinity (represent HCO3 and CO32-) ####
##################################################################X
par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
plot(x = db_st_dunite$Ca_umol_l * 2 * 10^-3, 
     y = (db_st_dunite$TA_umol_kg) * 10^-3,
     xlim = c(0, 0.15),
     ylim = c(0, 30),
     xlab = expression(bold("Ca"^"2+"*" in mEq/L")),
     ylab = expression(bold("TA in"~mEq %.% kg^-1)),
     pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
     col = "black",  bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
     cex = 4
)

##### #### #### ### border #### #### #### ####
# lines((seq_x*0)+0.115, (seq_x),
#       lty = 1)
# text(x =0.115, y = 2,
#      labels = as.expression(bquote(bold("limit x"))),
#      pos = 4,
#      cex = 1.5)

##### #### #### ### fine grain size #### #### #### ####
# x = db_st_dunite_fine$Ca_umol_l * 2 * 10^-3
# y = (db_st_dunite_fine$TA_umol_kg) * 10^-3

#subset the day 5,and 7
db_sub <- subset(db_st_dunite_fine, db_st_dunite_fine$duration_day < 4)

x = db_sub$Ca_umol_l * 2 * 10^-3
y = (db_sub$TA_umol_kg) * 10^-3
#plot(x, y)

# Fit an exponential regression model
model <- lm(log(y) ~ x)

# Extract coefficients
intercept <- exp(coef(model)[1])
slope <- coef(model)[2]

# Print coefficients
print(paste("Intercept:", intercept))
print(paste("Slope:", slope))

# Plot the original data and the fitted exponential curve
x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
y_pred <- intercept * exp(slope * x_pred)

#plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
lines(x_pred, y_pred, col = "black", type = "l", lty = 2)

# Calculate R-squared value
rsquared <- summary(model)$r.squared
print(paste("R-squared:", rsquared))

#add text for grain size
text(x =0.1100, y = intercept * exp(slope * 0.1100),
     labels = expression(bold("Fine (R"^"2"*" = 0.77)")),
     pos = 4,
     cex = 1.1)



##### #### #### ### medium grain size #### #### #### ####
# x = db_st_dunite_medium$Ca_umol_l * 2 * 10^-3
# y = (db_st_dunite_medium$TA_umol_kg) * 10^-3

#subset the day 5,and 7
db_sub <- subset(db_st_dunite_medium, db_st_dunite_medium$duration_day < 4)

x = db_sub$Ca_umol_l * 2 * 10^-3
y = (db_sub$TA_umol_kg) * 10^-3
#plot(x, y)

# Fit an exponential regression model
model <- lm(log(y) ~ x)

# Extract coefficients
intercept <- exp(coef(model)[1])
slope <- coef(model)[2]

# Print coefficients
print(paste("Intercept:", intercept))
print(paste("Slope:", slope))

# Plot the original data and the fitted exponential curve
x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
y_pred <- intercept * exp(slope * x_pred)

#plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
lines(x_pred, y_pred, col = "black", type = "l", lty = 2)

# Calculate R-squared value
rsquared <- summary(model)$r.squared
print(paste("R-squared:", rsquared))

#add text for grain size
text(x =0.0400, y = intercept * exp(slope * 0.0400),
     labels = expression(bold("Medium (R"^"2"*" = 0.56)")),
     pos = 4,
     cex = 1.1)

# #add text
# text(x =0.041, y = intercept * exp(slope * 0.041),
#      labels = as.expression(bquote(bold("Medium"))),
#      pos = 4,
#      cex = 1.5)



##### #### #### ### coarse grain size #### #### #### ####
x = db_st_dunite_coarse$Ca_umol_l * 2 * 10^-3
y = (db_st_dunite_coarse$TA_umol_kg) * 10^-3
#plot(x, y)

# Fit an exponential regression model
model <- lm(log(y) ~ x)

# Extract coefficients
intercept <- exp(coef(model)[1])
slope <- coef(model)[2]

# Print coefficients
print(paste("Intercept:", intercept))
print(paste("Slope:", slope))

# Plot the original data and the fitted exponential curve
x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
y_pred <- intercept * exp(slope * x_pred)

#plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
lines(x_pred, y_pred, col = "black", type = "l", lty = 2)


# Calculate R-squared value
rsquared <- summary(model)$r.squared
print(paste("R-squared:", rsquared))

#add text for grain size
text(x =0.104, y = intercept * exp(slope * 0.104),
     labels = expression(bold("Coarse (R"^"2"*" = 0.76)")),
     pos = 4,
     cex = 1.1)

# #add text
# text(x =0.103, y = intercept * exp(slope * 0.103),
#      labels = as.expression(bquote(bold("Coarse"))),
#      pos = 4,
#      cex = 1.5)


################################################################################
#### Sequence for data (line) ####
seq_x <-seq(from = -10000, to = 100000, by = 1)

###########################################X
#### Basanite Mg vs Total Alkalinity (represent HCO3 and CO32-) ####
##################################################################X
par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
plot(x = db_st_basalt$Mg_umol_l * 2 * 10^-3, 
     y = db_st_basalt$TA_umol_kg * 10^-3,
     xlim = c(0, 5),
     ylim = c(0, 10),
     xlab = expression(bold("Mg"^"2+"*" in mEq/L")),
     ylab = expression(bold("TA in"~mEq %.% kg^-1)),
     pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
     col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
     cex = 4
)

#### Linear regression (1:2)####
#### Basalt Coarse
#1:2 lines
lines(seq_x, (seq_x*2),
      lty = 6)
text(x = 8/2, y = 8,
     labels = as.expression(bquote(bold("y = 2x"))),
     pos = 4,
     cex = 1.5)

# # Fit linear regression model
# x = db_st_basalt_coarse$Mg_umol_l * 2 * 10^-3
# y = db_st_basalt_coarse$TA_umol_kg * 10^-3
# lm_model <- lm(y ~ x)
# # Summary of the regression model
# summary(lm_model)
# # Plot the data and regression line
# abline(lm_model,
#        col = "black",
#        lty = 2)
# # Get the coefficients
# coefficients <- coef(lm_model)
# # Print the coefficients
# print(coefficients)
# # Add coefficent into the plot
# text(x = 8/2, y = 8,
#      labels = as.expression(bquote(bold("y = 1.96x + 0.22"))),
#      pos = 4,
#      cex = 1.5)

text(x = 8/2, y = 7.5,
     labels = expression(bold("R"^"2"*" = 0.95")),
     pos = 4,
     cex = 1.5)

#### Linear regression ####
#### Basalt Fine
# Fit linear regression model
x = db_st_basalt_fine$Mg_umol_l * 2 * 10^-3
y = db_st_basalt_fine$TA_umol_kg * 10^-3
lm_model <- lm(y ~ x)

# Summary of the regression model
summary(lm_model)

# Plot the data and regression line
abline(lm_model, 
       col = "black",
       lty = 2)

# Get the coefficients
coefficients <- coef(lm_model)

# # Add lable for fine
# text(x = 2.5, y = ((1.435597*2.5)+ 2.606444),
#      labels = as.expression(bquote(bold("Fine"))),
#      pos = 2,
#      cex = 1.5)
# print(coefficients)

# # Add coefficent into the plot
# text(x = 2.5, y = ((1.735597*2.5)+ 2.606444),
#      labels = as.expression(bquote(bold("y = 1.44x + 2.61"))),
#      pos = 2,
#      cex = 1.5)

#add label for R-squared
text(x = 2.5, y = ((1.435597*2.5)+ 2.606444),
     labels = expression(bold("R"^"2"*" = 0.45")),
     pos = 2,
     cex = 1.5)

##################################################################X
#### Basanite Na+K vs Total Alkalinity (represent HCO3 and CO32-) ####
##################################################################X
par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
plot(x = (db_st_basalt$Na_umol_l + db_st_basalt$K_umol_l) * 10^-3, 
     y = (db_st_basalt$TA_umol_kg) * 10^-3,
     xlim = c(0, 5),
     ylim = c(0, 10),
     xlab = expression(bold("Na"^"+"*" + K"^"+"*" in mEq/L")),
     ylab = expression(bold("TA in"~mEq %.% kg^-1)),
     pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
     col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
     cex = 4
)

##### linear regression ####
lines(seq_x, ((seq_x*1)),
      lty = 6)
text(x = 1.5, y = 1.5-0.2,
     labels = as.expression(bquote(bold("y = x"))),
     pos = 4,
     cex = 1.5)

# db_st_basalt_fine <- subset(db_st_basalt_fine, db_st_basalt_fine$duration_day < 5)
# # Fit linear regression model
# x = (db_st_basalt_fine$Na_umol_l + db_st_basalt_fine$K_umol_l) * 10^-3
# y = db_st_basalt_fine$TA_umol_kg * 10^-3
# lm_model <- lm(y ~ x)
# # Summary of the regression model
# summary(lm_model)
# # Plot the data and regression line
# abline(lm_model,
#        col = "black",
#        lty = 2)
# # Get the coefficients
# coefficients <- coef(lm_model)

#add label for R-squared
text(x = 1.5, y = 1 - 0.2,
     labels = expression(bold("R"^"2"*" = 0.48")),
     pos = 4,
     cex = 1.5)


#### log model ####
##### #### #### ### coarse grain size #### #### #### ####x
x=(db_st_basalt_coarse$Na_umol_l + db_st_basalt_coarse$K_umol_l) * 10^-3
y=(db_st_basalt_coarse$TA_umol_kg) * 10^-3
#plot(x, y)

#fit the model
model <- lm(y ~ log(x))
#view the output of the model
summary(model)
# Get the coefficients
coefficients <- coef(model)
# Print the coefficients
print(coefficients)

#plot x vs. y
#plot(x, y)
#define x-values to use for regression line
x=seq(from=0.0001,to=1000,length.out=1000000)
#use the model to predict the y-values based on the x-values
y=predict(model,newdata=list(x=seq(from=0.0001,to=1000,length.out=1000000)))
#add the fitted regression line to the plot (lwd specifies the width of the line)
matlines(x,y, lwd=1, col = "black", lty = 2)

# Add text
text(x = 3, y = (3.703433+(1.954100*log(3))),
     labels = as.expression(bquote(bold("Coarse"))),
     pos = 4,
     cex = 1.5)

# # Add text for coefficient
# text(x = 3, y = (3.003433+(1.954100*log(3))),
#      labels = as.expression(bquote(bold("y=3.90+1.95*log(x)"))),
#      pos = 4,
#      cex = 1.5)

#add label for R-squared
text(x = 3, y = (3.203433+(1.954100*log(3))),
     labels = expression(bold("R"^"2"*" = 0.79")),
     pos = 4,
     cex = 1.5)

##################################################################X
#### Basanite Ca vs Total Alkalinity (represent HCO3 and CO32-) ####
##################################################################X
par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
plot(x = (db_st_basalt$Ca_umol_l * 2) * 10^-3, 
     y = (db_st_basalt$TA_umol_kg) * 10^-3,
     xlim = c(0, 2),
     ylim = c(0, 10),
     xlab = expression(bold("Ca"^"2+"*" in mEq/L")),
     ylab = expression(bold("TA in"~mEq %.% kg^-1)),
     pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
     col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
     cex = 4
)
####1:1 line####
# lines(seq_x, (seq_x*1),
#       lty = 6)
# text(x = 1, y = 1-0.2,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 1,
#      cex = 1.5)
##### border #####
# lines((seq_x*0)+1.4, (seq_x),
#       lty = 6)
# text(x =1.4, y = 0.5,
#      labels = as.expression(bquote(bold("limit x"))),
#      pos = 4,
#      cex = 1.5)

##### #### #### ### log fine grain size #### #### #### ####
x=(db_st_basalt_fine$Ca_umol_l * 2) * 10^-3
y=(db_st_basalt_fine$TA_umol_kg) * 10^-3
#plot(x, y)

#fit the model
model <- lm(y ~ log(x))
#view the output of the model
summary(model)
# Get the coefficients
coefficients <- coef(model)
# Print the coefficients
print(coefficients)

#plot x vs. y
#plot(x, y)
#define x-values to use for regression line
x=seq(from=0.0001,to=1000,length.out=1000000)
#use the model to predict the y-values based on the x-values
y=predict(model,newdata=list(x=seq(from=0.0001,to=1000,length.out=1000000)))
#add the fitted regression line to the plot (lwd specifies the width of the line)
matlines(x,y, lwd=1, col = "black", lty = 2)

# Add coefficent into the plot
text(x = 1.5, y = ((4.192892)+ (0.6849959*log(1.5))),
     labels = as.expression(bquote(bold("Fine"))),
     pos = 4,
     cex = 1.5)

# # Add coefficent into the plot
# text(x = 1.5, y = ((3.692892)+ (0.6849959*log(1.5))),
#      labels = as.expression(bquote(bold("y = 3.91x + 0.68*log(x)"))),
#      pos = 4,
#      cex = 1.5)

#add label for R-squared
text(x = 1.5, y = ((3.592892)+ (0.6849959*log(1.5))),
     labels = expression(bold("R"^"2"*" = 0.64")),
     pos = 4,
     cex = 1.5)


##### #### #### ### exp coarse grain size #### #### #### ####
x=(db_st_basalt_coarse$Ca_umol_l * 2) * 10^-3
y=(db_st_basalt_coarse$TA_umol_kg) * 10^-3
#plot(x, y)

# Fit an exponential regression model
model <- lm(log(y) ~ x)

# Extract coefficients
intercept <- exp(coef(model)[1])
slope <- coef(model)[2]

# Print coefficients
print(paste("Intercept:", intercept))
print(paste("Slope:", slope))

# Plot the original data and the fitted exponential curve
x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
y_pred <- intercept * exp(slope * x_pred)

#plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
lines(x_pred, y_pred, col = "black", type = "l", lty = 2)


# Add coefficent into the plot
text(x = 1.5, y = (intercept * exp(slope * 1.5)),
     labels = as.expression(bquote(bold("Coarse"))),
     pos = 4,
     cex = 1.5)

# # Add coefficent into the plot
# text(x = 1.5, y = (intercept * exp(slope * 1.5) - 0.5),
#      labels = as.expression(bquote(bold("y = 0.58 * exp(1.78x)"))),
#      pos = 4,
#      cex = 1.5)

#add label for R-squared
text(x = 1.5, y = (intercept+0.50 * exp(slope * 1.5)),
     labels = expression(bold("R"^"2"*" = 0.78")),
     pos = 4,
     cex = 1.5)


# legend("topleft",
#        legend = c("Regression - Basanite Fine", "Regression - Basanite Coarse"),
#        lty = c(2,2),
#        col = c("darkblue", "red"),
#        bty = "n",
#        cex = 1.5
# )



```

```{r "Basanite and Dunite - Cations and TA-Cations", include=TRUE}

################################################################################
##### Plot all scneario into 1 plot#####
par(mfrow=c(2,3))
par(mfrow=c(2,3), #rows, columns several plots into one
    cex.main = 1.5,  # Font size for main title
    cex.lab = 1.75,  # Font size for xlab and ylab
    cex.axis = 1.5) # Font size for axis tick labels
############################################X



#### Sequence for data (line) ####
seq_x <-seq(from = -10000, to = 100000, by = 1)


###########################################X
##### Legend ###############################
###########################################X

plot.new()
#### Legend Day
legend("topleft",
       title = as.expression(bquote(bold("Day of Observation"))),
       legend = c(levels(as.factor(db_st_basalt$legend_day))),
       pt.bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b"),
       col = "black",
       pch = 21,
       ncol = 2,
       bty = "n",
       cex = 1.1,
       horiz = TRUE
)
#### Grain Size
legend("topright",
       title = as.expression(bquote(bold("Grain Size"))),
       legend = c(levels(as.factor(db_st_dunite$grain_size))),
       pt.bg = c("black"),
       col = "black",
       pch = c(22,21,24),
       ncol = 1,
       bty = "n",
       cex = 1.1,
       horiz = TRUE
)
#### Legend line
legend("bottomleft",
       legend = c("Quadratic - 2nd Degree"),
       lty = 2,
       col = c("darkblue"),
       bty = "n"
)



##################################################################X
#### Dunite Mg vs Total Alkalinity (represent HCO3 and CO32-) ####
##################################################################X
par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
plot(x = db_st_dunite$Mg_umol_l * 2 * 10^-3, 
     y = (db_st_dunite$TA_umol_kg * 10^-3) - (((db_st_dunite$Ca_umol_l * 2) + (db_st_dunite$Na_umol_l * 1) + (db_st_dunite$K_umol_l * 1)) * 10^-3),
     xlim = c(0, 30),
     ylim = c(0, 30),
     xlab = expression(bold("Mg"^"2+"*" in mEq/L")),
     ylab = expression(bold("TA - (Ca"^"2+"*" + Na"^"+"*" + K"^"+"*") in mEq/L")),
     pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
     col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
     cex = 4
)
####1:1 Lines####
lines(seq_x, (seq_x*1),
      lty = 6)
text(x = 23, y = 23,
     labels = as.expression(bquote(bold("1:1 line"))),
     pos = 2,
     cex = 1.5)


##################################################################X
#### Dunite Na+K vs Total Alkalinity (represent HCO3 and CO32-) ####
##################################################################X
par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
plot(x = (db_st_dunite$Na_umol_l + db_st_dunite$K_umol_l) * 10^-3, 
     y = (db_st_dunite$TA_umol_kg * 10^-3) - (((db_st_dunite$Ca_umol_l * 2) + (db_st_dunite$Mg_umol_l * 2)) * 10^-3),
     xlim = c(0, 1.5),
     ylim = c(0, 3),
     xlab = expression(bold("Na"^"+"*" + K"^"+"*" in mEq/L")),
     ylab = expression(bold("TA - (Mg"^"2+"*" + Ca"^"2+"*") in mEq/L")),
     pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
     col = "black",  bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
     cex = 4
)

####1:1 Lines####
lines(seq_x, (seq_x*1),
      lty = 6)
text(x = 1, y = 1,
     labels = as.expression(bquote(bold("1:1 line"))),
     pos = 4,
     cex = 1.5)



##################################################################X
#### Dunite Ca vs Total Alkalinity (represent HCO3 and CO32-) ####
##################################################################X
par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
plot(x = db_st_dunite$Ca_umol_l * 2 * 10^-3, 
      y = (db_st_dunite$TA_umol_kg * 10^-3) - (((db_st_dunite$Mg_umol_l * 2) + (db_st_dunite$Na_umol_l * 1) + (db_st_dunite$K_umol_l * 1)) * 10^-3),
     xlim = c(0, 0.15),
     ylim = c(-0.5, 3),
     xlab = expression(bold("Ca"^"2+"*" in mEq/L")),
     ylab = expression(bold("TA - (Mg"^"2+"*" + Na"^"+"*" + K"^"+"*") in mEq/L")),
     pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
     col = "black",  bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
     cex = 4
)
####1:1 Lines####
lines(seq_x, (seq_x*1),
      lty = 6)
text(x = 0.13, y =0.13,
     labels = as.expression(bquote(bold("1:1 line"))),
     pos = 1,
     cex = 1.5)

################################################################################
#### Sequence for data (line) ####
seq_x <-seq(from = -10000, to = 100000, by = 1)

###########################################X
#### Basanite Mg vs Total Alkalinity (represent HCO3 and CO32-) ####
##################################################################X
par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
plot(x = db_st_basalt$Mg_umol_l * 2 * 10^-3, 
          y = (db_st_basalt$TA_umol_kg * 10^-3) - (((db_st_basalt$Ca_umol_l * 2) + (db_st_basalt$Na_umol_l * 1) + (db_st_basalt$K_umol_l * 1)) * 10^-3),
     xlim = c(0, 5),
     ylim = c(-1.5, 4),
     xlab = expression(bold("Mg"^"2+"*" in mEq/L")),
     ylab = expression(bold("TA - (Ca"^"2+"*" + Na"^"+"*" + K"^"+"*") in mEq/L")),
     pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
     col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
     cex = 4
)
####1:1 Lines####
lines(seq_x, (seq_x*1),
      lty = 6)
text(x = 3.25, y = 3.25,
     labels = as.expression(bquote(bold("1:1 line"))),
     pos = 2,
     cex = 1.5)

# # Fit linear regression model
# x = db_st_basalt_coarse$Mg_umol_l * 2 * 10^-3
# y = db_st_basalt_coarse$TA_umol_kg * 10^-3
# lm_model <- lm(y ~ x)
# # Summary of the regression model
# summary(lm_model)
# # Plot the data and regression line
# abline(lm_model, 
#        col = "black",
#        lty = 2)
# # Get the coefficients
# coefficients <- coef(lm_model)
# # Print the coefficients
# print(coefficients)
# # Add coefficent into the plot
# text(x = 8/2, y = 8,
#      labels = as.expression(bquote(bold("y = 1.96x + 0.22"))),
#      pos = 4,
#      cex = 1.5)

#### Basanite Na+K vs Total Alkalinity (represent HCO3 and CO32-) ####
##################################################################X
par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
plot(x = (db_st_basalt$Na_umol_l + db_st_basalt$K_umol_l) * 10^-3, 
     y = (db_st_basalt$TA_umol_kg * 10^-3) - (((db_st_basalt$Ca_umol_l * 2) + (db_st_basalt$Mg_umol_l * 2)) * 10^-3),
     xlim = c(0, 5),
     ylim = c(-1.5, 4),
     xlab = expression(bold("Na"^"+"*" + K"^"+"*" in mEq/L")),
     ylab = expression(bold("TA - (Mg"^"2+"*" + Ca"^"2+"*") in mEq/L")),
     pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
     col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
     cex = 4
)

####1:1 Lines####
lines(seq_x, (seq_x*1),
      lty = 6)
text(x = 3.5, y = 3.5,
     labels = as.expression(bquote(bold("1:1 line"))),
     pos = 2,
     cex = 1.5)


#### Basanite Ca vs Total Alkalinity (represent HCO3 and CO32-) ####
##################################################################X
par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
plot(x = (db_st_basalt$Ca_umol_l * 2) * 10^-3, 
     y = (db_st_basalt$TA_umol_kg * 10^-3) - (((db_st_basalt$Mg_umol_l * 2) + (db_st_basalt$Na_umol_l * 1) + (db_st_basalt$K_umol_l * 1)) * 10^-3),
     xlim = c(0, 1.5),
     ylim = c(-1.5, 4),
     xlab = expression(bold("Ca"^"2+"*" in mEq/L")),
     ylab = expression(bold("TA - (Mg"^"2+"*" + Na"^"+"*" + K"^"+"*") in mEq/L")),
     pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
     col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
     cex = 4
)
####1:1 Lines####
lines(seq_x, (seq_x*1),
      lty = 6)
text(x = 1, y = 1,
     labels = as.expression(bquote(bold("1:1 line"))),
     pos = 2,
     cex = 1.5)

```

```{r "Basalt and Dunite - Saturation Level", include=TRUE}

plot(db_st_si_basalt$si_Calcite, db_st_si_basalt$Ca_umol_l,
     xlim = c(-5,5),
     col = "black", bg = c("#B2182B",  "#EF8A62", "#FDBBC7",  "#F7F7F7", "#D1E5F0",  "#67A9CF", "#2166AC")[as.factor(db_st_si_basalt$legend_day)],
     pch = 21,
     cex = 2
     )
legend("topleft",
       title = as.expression(bquote(bold("Day of Observation"))),
       legend = c(levels(as.factor(db_st_si_basalt$legend_day))),
       pt.bg = c("#B2182B",  "#EF8A62", "#FDBBC7",  "#F7F7F7", "#D1E5F0",  "#67A9CF", "#2166AC"),
       col = "black",
       pch = 21,
       ncol = 2,
       bty = "o",
       cex = 1.1
)
```

```{r "Basalt and Dunite - Reaction Rate", include=TRUE}

par(cex.main = 2,  # Font size for main title
    cex.lab = 1.5,  # Font size for xlab and ylab
    cex.axis = 1.5,    #Font size for axis tick labels
    las = 1,     #Turn Y-Label 90% from original
    mar = c(5, 5, 1, 1))

# Dunite - Subset data
dc_nwr_rate <- subset(db_st_rate, db_st_rate$id_code == "DC-13-NWR-50" & db_st_rate$duration_day < 5)
dc_13_50_rate <- subset(db_st_rate, db_st_rate$id_code == "DC-13-50" &  db_st_rate$duration_day < 5)
# Basanite - Subset data
bf_nwr_rate <- subset(db_st_rate, db_st_rate$id_code == "BF-13-NWR-50" & db_st_rate$duration_day < 5)
bf_13_50_rate <- subset(db_st_rate, db_st_rate$id_code == "BF-13-50" & db_st_rate$duration_day < 5)



plot(dc_nwr_rate$duration_day, dc_nwr_rate$TA_rate_umol_kg / 1000,
     #main = "Dunite",
     xlab = substitute(paste(bold("Day"))), 
     ylab = expression(bold(v[TA]~(mol %.% L^-1 %.% day^-1))),
     xlim = c(0, 4),
     ylim = c(0, 10),
     type = "b",
     pch = 21,
     col = "black",
     bg = "#9ab973",
     cex = 2.5, 
     font.axis = 2,
)

points(dc_13_50_rate$duration_day, dc_13_50_rate$TA_rate_umol_kg / 1000, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "#9ab973",
       cex = 2.5,
)

points(bf_nwr_rate$duration_day, bf_nwr_rate$TA_rate_umol_kg / 1000, 
       type = "b",
       pch = 21,
       col = "black",
       bg = "grey50",
       cex = 2.5,
)
points(bf_13_50_rate$duration_day, bf_13_50_rate$TA_rate_umol_kg / 1000, 
       type = "b",
       pch = 22,
       col = "black",
       bg = "grey50",
       cex = 2.5,
)



#legend
legend("topleft", 
       #title = expression(paste(bold("Water Replacement"))),
       legend=c("Dunite", "Basanite","No Water Replacement", "Replaced Daily (33%)"),
       col = c(NA, NA, "black", "black"),,
       pch = c(21,21, 21, 22),
       cex = 1,
       pt.bg = c("#9ab973", "grey50", "white", "white"),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n",
       pt.cex = 1.25
)


```



## 6. Long Term Experiment

```{r "Dataframe for Long Term", include=FALSE}

##### Import Database ####
db_lt <- read_csv('/Users/reinaldy/Documents/Kitchen Aid Experiment/CSV Data/long_term.csv')

##### Tidy data ####
TA_lt_tidy <- db_lt[!is.na(db_lt$Accumulated_TA), ] #1 hour before replacement is not recorded
TA_lt_tidy <- TA_lt_tidy[-c(3,4,5),] #delete the fluctuation in day 0

##### Complete data ####
TA_lt_complete <- db_lt[!is.na(db_lt$TA_umol_kg), ] #1 hour after replacement is recorded

#### Add SSA value in the dataset for calculating the rates ####
db_lt <- db_lt %>% mutate(ssa_m2_g = case_when(
  rock_type == "basalt" & grain_size == "fine" ~ ssa_basalt_fine,
  rock_type == "basalt" & grain_size == "coarse" ~ ssa_basalt_coarse,
  rock_type == "dunite" & grain_size == "fine" ~ ssa_dunite_fine,
  rock_type == "dunite" & grain_size == "medium" ~ ssa_dunite_medium,
  rock_type == "dunite" & grain_size == "coarse" ~ ssa_dunite_coarse,
))

```

```{r "Long-Term Alkalinity", include=FALSE}
par(mfrow=c(1,2))
par(cex.main = 1.5,  # Font size for main title
    cex.lab = 1.25,  # Font size for xlab and ylab
    cex.axis = 1) # Font size for axis tick labels

#### Alkalinity Concentration vs Time (Tidy) ##################################
#1-hour after water replacement is not recorded - just end of observation per day

#### Subset Basalt ###########################################################
TA_lt_tidy_basalt <- subset(TA_lt_tidy, TA_lt_tidy$rock_type == "basalt")
TA_lt_complete_basalt <- subset(TA_lt_complete, TA_lt_complete$rock_type == "basalt")

#### Basalt Tidy: Scatter Plot ############################################################
par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right

plot(x = TA_lt_tidy_basalt$duration_day,
     y = TA_lt_tidy_basalt$TA_umol_kg/1000,
     main = "Basalt Fine - Long Term Observation",
     ylim = c(0,4),
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("Alkalinity in mEq/l"))),
     type = "b",
     pch = 21,
     cex = 2,
     col = "black",
     bg = "grey40"
)
lines(lowess(TA_lt_tidy_basalt$duration_day,TA_lt_tidy_basalt$TA_umol_kg/1000), 
      col = "#ca0020",
      lty = 3,
      lwd = 4)

#### Complete: Scatter Plot ############################################################
par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right

plot(x = TA_lt_complete_basalt$duration_day,
     y = TA_lt_complete_basalt$TA_umol_kg/1000,
     main = "Basalt Fine - Long Term Observation",
     ylim = c(0,4),
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("Alkalinity in mEq/l"))),
     type = "b",
     pch = 21,
     cex = 2,
     col = "black",
     bg = "grey40"
)
lines(lowess(TA_lt_complete_basalt$duration_day,TA_lt_complete_basalt$TA_umol_kg/1000), 
      col = "#ca0020",
      lty = 3,
      lwd = 4)


############################################# Basalt accumulation in barplot
#x = 0
#for (i in 1:26) {
#  x[i] = c(TA_lt_basalt$Accumulated_TA[i] + TA_lt_basalt$Accumulated_TA[i + 1])
#}
#accu_basalt <- data.frame(duration_day =c(TA_lt_basalt$duration_day[-1]), TAlk_umol_l = c(x))

#combined_TA_lt_basalt <- TA_lt_basalt %>% left_join(accu_basalt, by = "duration_day")

#basalt_bar <-ggplot(combined_TA_lt_basalt) +
#  geom_line(aes(x=duration_day, y=TA_umol_kg/1000), stat="identity")+
#  geom_bar(aes(x=duration_day, y=TAlk_umol_l/10000), stat="identity")+
#    labs(x = substitute(paste(bold("Rotational Speed (RPM)"))), 
#       y = substitute(paste(bold("Energy Consumption in kW")))) +
#  scale_y_continuous(sec.axis=sec_axis(~.*0.01,name="Percentage")) 
#basalt_bar
########################################################################### x



#### Alkalinity Concentration vs Time (Tidy) ##################################
####1-hour after water replacement is not recorded - just end of observation per day

#### Subset Dunite ###########################################################
TA_lt_tidy_dunite <- subset(TA_lt_tidy, TA_lt_tidy$rock_type == "dunite")
TA_lt_complete_dunite <- subset(TA_lt_complete, TA_lt_complete$rock_type == "dunite")

#### Dunite Tidy: Scatter Plot ############################################################
par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right

plot(x = TA_lt_tidy_dunite$duration_day,
     y = TA_lt_tidy_dunite$TA_umol_kg/1000,
     main = "Dunite Fine - Long Term Observation",
     ylim = c(0,20),
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("Alkalinity in mEq/l"))),
     type = "b",
     pch = 21,
     cex = 2,
     col = "black",
     bg = "#9ab973"
)
lines(lowess(TA_lt_tidy_dunite$duration_day,TA_lt_tidy_dunite$TA_umol_kg/1000), 
      col = "#ca0020",
      lty = 3,
      lwd = 4)

##### Dunite Complete: Scatter Plot ############################################################
par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right


plot(x = TA_lt_complete_dunite$duration_day,
     y = TA_lt_complete_dunite$TA_umol_kg/1000,
     main = "Dunite Fine - Long Term Observation",
     ylim = c(0,20),
     xlab = substitute(paste(bold("Day"))), 
     ylab = substitute(paste(bold("Alkalinity in mEql/l"))),
     type = "b",
     pch = 21,
     cex = 2,
     col = "black",
     bg = "#9ab973"
)
lines(lowess(TA_lt_complete_dunite$duration_day,TA_lt_complete_dunite$TA_umol_kg/1000), 
      col = "#ca0020",
      lty = 3,
      lwd = 4)

```

```{r "Basalt Long-Term = Weathering Rate"}

# Weathering rate of mineral ####
#1. Concentration netto per day (dM) ####
x <- 0
y <- 0
n <- as.numeric(nrow(TA_lt_complete_basalt))

for (i in c(1:n)){
  x[i] = as.numeric(TA_lt_complete_basalt[i, "TA_umol_kg"])
}
for (i in c(2:n)){
  y[i] = as.numeric(x[i] - x[i-1])
}

#2. Concatenate the alkalinity values produced per day into new row ####
TA_lt_complete_basalt$alkalinity_perday <- y

#3. Calculate rate (mol/m2.s) ####
rate <- ((TA_lt_complete_basalt$alkalinity_perday/1000000) * 3) / ((ssa_basalt_fine) * (1*1000) * (1*24*60*60))

#4. Concatenate the values of weathering rate into new row ####
TA_lt_complete_basalt$rate_mol_m2s <- rate

#5. Subset data with negative values in alkalinity production (due to water exchange) ####
TA_lt_complete_basalt <- TA_lt_complete_basalt[TA_lt_complete_basalt[, "alkalinity_perday"] > 0, ]

#6. Plot into two axis, concentration with weathering rate ####
par(mar = c(5, 4, 4, 5))  # c(bottom, left, top, right) default is 5,4,4,4
plot(x = TA_lt_complete_basalt$duration_day,
     y = TA_lt_complete_basalt$TA_umol_kg/1000,
     main = "Basalt Fine - Long Term Observation",
     ylim = c(0,4),
     xlab = substitute(paste(bold("Day"))), 
     ylab = NA,
     type = "b",
     pch = 21,
     cex = 2,
     col = "black",
     bg = "grey40"
)
lines(lowess(TA_lt_complete_basalt$duration_day,TA_lt_complete_basalt$TA_umol_kg/1000), 
      col = "#ca0020",
      lty = 3,
      lwd = 4)
mtext(text = substitute(paste(bold("Alkalinity in mmol/l"))), side = 2, col = "black", line = 2)
par(new = TRUE)
plot(x = TA_lt_complete_basalt$duration_day,
     y = log10(TA_lt_complete_basalt$rate_mol_m2s),
     main = "Basalt Fine - Long Term Observation",
     #ylim = c(0,4),
     xlab = substitute(paste(bold("Day"))), 
     ylab = NA,
     type = "b",
     pch = 21,
     cex = 2,
     col = "black",
     bg = "#0571b0",
     axes = FALSE
)
axis(4, at = pretty(range(log10(TA_lt_complete_basalt$rate_mol_m2s)), n = 4), labels = pretty(range(log10(TA_lt_complete_basalt$rate_mol_m2s)), n = 4), col.axis = "black", col.lab = "black")
mtext(text = substitute(paste(bold("Weathering Rate in mmol/m2.s1"))), side = 4, col = "black", line = 3)

#7. Plot only weathering rate
plot(x = TA_lt_complete_basalt$duration_day,
     y = log10(TA_lt_complete_basalt$rate_mol_m2s),
     main = "Basalt Fine - Long Term Observation",
     #ylim = c(0,4),
     xlab = substitute(paste(bold("Day"))), 
     ylab = NA,
     type = "b",
     pch = 21,
     cex = 2,
     col = "black",
     bg = "#0571b0")

```

```{r "Dunite Long-Term = Weathering Rate"}

#weathering rate of mineral
#1.concentration netto per day (dM) ####
x <- 0
y <- 0
n <- as.numeric(nrow(TA_lt_complete_dunite))

for (i in c(1:n)){
  x[i] = as.numeric(TA_lt_complete_dunite[i, "TA_umol_kg"])
}
for (i in c(2:n)){
  y[i] = as.numeric(x[i] - x[i-1])
}

#2.concatenate the alkalinity values produced per day into new row ####
TA_lt_complete_dunite$alkalinity_perday <- y

#3. Calculate rate (mol/m2.s) ####
rate <- ((TA_lt_complete_dunite$alkalinity_perday/1000000) * 3) / ((ssa_dunite_coarse) * (1*1000) * (1*24*60*60))

#4. concatenate the values of weathering rate into new row ####
TA_lt_complete_dunite$rate_mol_m2s <- rate

#5. Subset data with negative values in alkalinity production (due to water exchange) ####
TA_lt_complete_dunite <- TA_lt_complete_dunite[TA_lt_complete_dunite[, "alkalinity_perday"] > 0, ]

#6. Plot into two axis, concentration with weathering rate ####
par(mar = c(5, 4, 4, 5))  # c(bottom, left, top, right) default is 5,4,4,4
plot(x = TA_lt_complete_dunite$duration_day,
     y = TA_lt_complete_dunite$TA_umol_kg/1000,
     main = "dunite coarse - Long Term Observation",
     ylim = c(0,20),
     xlab = substitute(paste(bold("Day"))), 
     ylab = NA,
     type = "b",
     pch = 21,
     cex = 2,
     col = "black",
     bg = "grey40"
)
lines(lowess(TA_lt_complete_dunite$duration_day,TA_lt_complete_dunite$TA_umol_kg/1000), 
      col = "#ca0020",
      lty = 3,
      lwd = 4)
mtext(text = substitute(paste(bold("Alkalinity in mmol/l"))), side = 2, col = "black", line = 2)
par(new = TRUE)
plot(x = TA_lt_complete_dunite$duration_day,
     y = log10(TA_lt_complete_dunite$rate_mol_m2s),
     main = "dunite coarse - Long Term Observation",
     #ylim = c(0,4),
     xlab = substitute(paste(bold("Day"))), 
     ylab = NA,
     type = "b",
     pch = 21,
     cex = 2,
     col = "black",
     bg = "#0571b0",
     axes = FALSE
)
axis(4, at = pretty(range(log10(TA_lt_complete_dunite$rate_mol_m2s)), n = 4), labels = pretty(range(log10(TA_lt_complete_dunite$rate_mol_m2s)), n = 4), col.axis = "black", col.lab = "black")
mtext(text = substitute(paste(bold("Weathering Rate in mmol/m2.s1"))), side = 4, col = "black", line = 3)

#7. Plot only weathering rate
plot(x = TA_lt_complete_dunite$duration_day,
     y = log10(TA_lt_complete_dunite$rate_mol_m2s),
     main = "dunite coarse - Long Term Observation",
     #ylim = c(0,4),
     xlab = substitute(paste(bold("Day"))), 
     ylab = NA,
     type = "b",
     pch = 21,
     cex = 2,
     col = "black",
     bg = "#0571b0")

```


## 7. Weathering Rate

```{r "WR Calculation"}

#### calculation of pH dependent WR based on Brandstra & Brantley (2008) fitted ####
#### curves for forsterite and basalt

#### parameters for basalt fit
a <- 588                  # ?H+ for basalt
b <- 1.16                 # nH+ for basalt
c <- 0.0822               # ?OH- for basalt
d <- 0.16                 # nOH- for basalt
e <- 47500                # Activation energy Ea for basalt
f <- 8.3144598            # Gas constant 
g <- 298.15               # Temperature in K (25°C)

#### standard deviations for a-e
sd_a <- 558               
sd_b <- 0.107
sd_c <- 0.079
sd_d <- 0.0309
sd_e <- 2690

#### parameters for forsterite fit
h <- 5.55*10**-8          # kH+ for forsterite
i <- 0.372                # nH+ for forsterite

#### standard deviations for h, i
sd_h <- 6.63*10**-9              
sd_i <- 0.0053

#### depending parameters for figure creation
pH <- seq (from = 1, to = 14, by = 0.1)         # range of pH

#### calculate log R for forsterite
log_R_Fo_mean <- log10(h*10**(-i*pH))
Fo_log_R_TA_mean <- log10((h*10**(-i*pH))*4)
log_R_Fo_upSD <- log10((h+sd_h)*10**(-(i-sd_i)*pH))
Fo_log_R_TA_upSD <- log10((h+sd_h)*10**(-(i-sd_i)*pH)*4)
log_R_Fo_lowSD <- log10((h-sd_h)*10**(-(i+sd_i)*pH))
Fo_log_R_TA_lowSD <- log10((h-sd_h)*10**(-(i+sd_i)*pH)*4)

#### calculate log R for basalt
log_R_Ba_mean <- log10((a*10**(-b*pH)+c*10**(d*(pH-14)))*exp(-e/(f*g)))
Ba_log_R_TA_mean <- log10((a*10**(-b*pH)+c*10**(d*(pH-14)))*exp(-e/(f*g))*0.8)
log_R_Ba_upSD <- log10((((a+sd_a)*10**(-(b-sd_b)*pH))+((c+sd_c)*10**((d-sd_d)*(pH-14))))*exp(-(e-sd_e)/(f*g)))
Ba_log_R_TA_upSD <- log10((((a+sd_a)*10**(-(b-sd_b)*pH))+((c+sd_c)*10**((d-sd_d)*(pH-14))))*exp(-(e-sd_e)/(f*g))*0.8)
log_R_Ba_lowSD <- log10((((a-sd_a)*10**(-(b+sd_b)*pH))+((c-sd_c)*10**((d+sd_d)*(pH-14))))*exp(-(e+sd_e)/(f*g)))
Ba_log_R_TA_lowSD <- log10((((a-sd_a)*10**(-(b+sd_b)*pH))+((c-sd_c)*10**((d+sd_d)*(pH-14))))*exp(-(e+sd_e)/(f*g))*0.8)

#### area for dunite ####
plot(x = pH,
     y = log_R_Fo_lowSD,
     type = "l",
     xlim = c(6,10),
     ylab = NA,
     )
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))
points(x = pH,
       y = log_R_Fo_upSD,
       type = "l"
)
#Area for Dunite
polygon(c(pH, rev(pH)), c(log_R_Fo_upSD, rev(log_R_Fo_lowSD)), col = "lightgreen")
#Mean for Dunite
points(x = pH,
       y = log_R_Fo_mean,
       type = "l"
)

#### area for basalt ####
plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-15, -5),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Dunite
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)


```

```{r "Basalt - Weathering Rate"}

# WR Basalt: Short Term Experiment #####

# Subset data ####
#Subset data from short-term experience dataframe

####################################Raw data
#rpm
rpm_0_basalt <- subset(db_st, id_code == "base_basalt")
rpm_0_basalt$pH <- c(5.71, 6.39, 6.80, 6.85, 6.93, 6.97, 7.01, 7.12)
rpm_50_basalt <- subset(db_st, id_code == "BF-13-50")
#grain size
bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")
bc_13_50 <- subset(db_st, db_st$id_code == "BC-13-50")
#water ratio
bc_12 <- subset(db_st, db_st$id_code == "BC-12-50")
bc_13 <- subset(db_st, db_st$id_code == "BC-13-50")
bc_15 <- subset(db_st, db_st$id_code == "BC-15-50")
#water replacement
bf_nwr <- subset(db_st, db_st$id_code == "BF-13-NWR-50")
bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")


####Calculating the rates####

#Make a list from some variables/dataframes
df_short_basalt <- c("rpm_0_basalt", "rpm_50_basalt", 
                     "bf_13_50", "bc_13_50",
                     "bc_12", "bc_13", "bc_15", 
                     "bf_nwr", "bf_13_50")

list_df_short_basalt <- list(rpm_0_basalt, rpm_50_basalt, bf_13_50, bc_13_50,
                             bc_12, bc_13, bc_15, bf_nwr, bf_13_50)

# Define a function for your calculation
calculate_rate <- function(df) {
  #2/3 is the conservative calculation of TA after water replacement
  x <- (df$TA_umol_kg * 2) /3 
  x <- x[1:(length(x) - 1)]
  #Assign the calculation into new column
  df["TA_AR_umol_kg"] <- c(0, x)
  df["TA_gain_umol_kg"] <- df$TA_umol_kg - df$TA_AR_umol_kg
  #Calculating the rate
  df["rate"] <- ((df$TA_gain_umol_kg/1000000) * 3) / ((df$ssa_m2_g) * (1*1000) * (1*24*60*60))
  return(df)
}

# Perform the calculation for each dataframe in the list according the defined function
list_df_short_basalt_calculated <- lapply(list_df_short_basalt, calculate_rate)

#extract new dataframe from list
for (i in seq_along(list_df_short_basalt_calculated)){
  var_name <- df_short_basalt[i]
  assign(var_name, list_df_short_basalt_calculated[[i]])
}



############################################X
#### Plot All ###############################
############################################X

plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-17, -5),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Basalt
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)

#Loop for all basalt experiment
for (i in c(1:length(list_df_short_basalt_calculated))){
  df <- list_df_short_basalt_calculated[[i]]
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = 21, cex = 2, col = "black", bg = "red")
}



###########################################X
#### Legend Day
plot.new()
legend("center",
       title = expression(paste(bold("Day"))),
       #legend = c(df_short_dunite[1:4]),
       legend = c(levels(as.factor(df$legend_day))),
       pch = 21, 
       col = "black",
       pt.bg = c("#B2182B",  "#EF8A62", "#FDBBC7", "#D1E5F0",  "#67A9CF", "#2166AC"),
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )
############################################X

############################################
#### Plot all scneario into 1 plot ####
par(mfrow=c(2,2))
par(cex.main = 1.5,  # Font size for main title
    cex.lab = 1.25,  # Font size for xlab and ylab
    cex.axis = 1) # Font size for axis tick labels
############################################X

#### Margin########################################
par(mar = c(2, 5, 3, 2)) #margin bottom, left, up, right


############################################X
#### Plot ME Effects ########################
############################################X
plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-17, -5),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Basalt
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)

#Loop 
for (i in c(1:2)){
  df <- list_df_short_basalt_calculated[[i]]
  pch_seq = c(21,22)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i], cex = 3, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}



legend(x = 6,
       y = log10(10^-5.5),
       title = expression(paste(bold("Rotational Speed"))),
       legend = c("No Mixing","50 RPM"),
       pch = c(21,22), 
       col = "black",
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )

############################################X
#### Plot Grain Size ########################
############################################X
plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-17, -5),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Basalt
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)

#Loop 
for (i in c(3:4)){
  df <- list_df_short_basalt_calculated[[i]]
  pch_seq = c(21,22)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-2], cex = 3, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-5.5),
       title = expression(paste(bold("Grain Size"))),
       legend = c("Fine", "Coarse"),
       pch = c(21,22), 
       col = "black",
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )

############################################X
#### Plot Water Ratio########################
############################################X
plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-17, -5),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Basalt
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)

#Loop 
for (i in c(5:7)){
  df <- list_df_short_basalt_calculated[[i]]
  pch_seq = c(21,22,23)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-4], cex = 3, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-5.5),
       title = expression(paste(bold("Water Ratio"))),
       legend = c("1:2", "1:3", "1:5"),
       pch = c(21,22,23), 
       col = "black",
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )

############################################X
#### Water Replacement#######################
############################################X
plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-17, -5),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Basalt
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)

#Loop 
for (i in c(8:9)){
  df <- list_df_short_basalt_calculated[[i]]
  pch_seq = c(21,22)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-7], cex = 3, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-5.5),
       title = expression(paste(bold("Water Replacement"))),
       legend = c("Without", "Daily"),
       pch = c(21,22), 
       col = "black",
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )

```

```{r "Dunite - Weathering Rate"}

# WR Dunite: Short Term Experiment #####
############################################X
#### Subset data ####
#### Subset data from short-term experience dataframe

#### Mechanical Effects
rpm_0_dunite <- subset(db_st, id_code == "base_dunite" & duration_day <=4)
rpm_0_dunite <- subset(rpm_0_dunite , duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_30_dunite <- subset(db_st, id_code == "rpm_slow")
rpm_30_dunite <- subset(rpm_30_dunite, duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_50_dunite <- subset(db_st, id_code == "rpm_medium" & duration_day <=4)
rpm_50_dunite <- subset(rpm_50_dunite,  duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_90_dunite <- subset(db_st, id_code == "rpm_high")
rpm_90_dunite <- subset(rpm_90_dunite, duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_0_dunite$pH <- c(5.79, 7.11, 7.19, 7.37, 7.39, 7.44)

##### Grain Size
df_13_50 <- subset(db_st, db_st$id_code == "DF-13-50")
dm_13_50 <- subset(db_st, db_st$id_code == "DM-13-50")
dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")

#### Water Ratio
dc_12 <- subset(db_st, db_st$id_code == "DC-12-50")
dc_13 <- subset(db_st, db_st$id_code == "DC-13-50")
dc_15 <- subset(db_st, db_st$id_code == "DC-15-50")

#Water Replacement
dc_nwr <- subset(db_st, db_st$id_code == "DC-13-NWR-50")
dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")


############################################X
#### Calculating the rates ####
############################################X


#Make a list from some variables/dataframes
df_short_dunite <- c("rpm_0_dunite", "rpm_30_dunite", "rpm_50_dunite", "rpm_90_dunite",
                     "df_13_50", "dm_13_50", "dc_13_50",
                     "dc_12", "dc_13", "dc_15",
                     "dc_nwr", "dc_13_50")

list_df_short_dunite <- list(rpm_0_dunite, rpm_30_dunite, rpm_50_dunite, rpm_90_dunite,
                             df_13_50, dm_13_50, dc_13_50,
                             dc_12, dc_13, dc_15,
                             dc_nwr, dc_13_50)

# Define a function for your calculation
calculate_rate <- function(df) {
  #2/3 is the conservative calculation of TA after water replacement
  x <- (df$TA_umol_kg * 2) /3 
  x <- x[1:(length(x) - 1)]
  #Assign the calculation into new column
  df["TA_AR_umol_kg"] <- c(0, x)
  df["TA_gain_umol_kg"] <- df$TA_umol_kg - df$TA_AR_umol_kg
  #Calculating the rate
  df["rate"] <- ((df$TA_gain_umol_kg/1000000) * 3) / ((df$ssa_m2_g) * (1*1000) * (1*24*60*60))
  return(df)
}

# Perform the calculation for each dataframe in the list according the defined function
list_df_short_dunite_calculated <- lapply(list_df_short_dunite, calculate_rate)

#extract new dataframe from list
for (i in seq_along(list_df_short_dunite_calculated)){
  var_name <- df_short_dunite[i]
  assign(var_name, list_df_short_dunite_calculated[[i]])
}

############################################X
#### Plot All ###############################
############################################X


plot(x = pH,
     y = log_R_Fo_lowSD,
     type = "l",
     xlim = c(6,10),
     ylab = NA,
     )
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))
points(x = pH,
       y = log_R_Fo_upSD,
       type = "l"
)
#Area for Dunite
polygon(c(pH, rev(pH)), c(log_R_Fo_upSD, rev(log_R_Fo_lowSD)), col = "lightgreen")
#Mean for Dunite
points(x = pH,
       y = log_R_Fo_mean,
       type = "l"
)


#Loop for all dunite experiment
for (i in c(1:length(list_df_short_dunite_calculated))){
  df <- list_df_short_dunite_calculated[[i]]
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = 21, cex = 2, col = "black", bg = "red")
}



###########################################X
#### Legend Day
plot.new()
legend("center",
       title = expression(paste(bold("Day"))),
       #legend = c(df_short_dunite[1:4]),
       legend = c(levels(as.factor(df$legend_day))),
       pch = 21, 
       col = "black",
       pt.bg = c("#B2182B",  "#EF8A62", "#FDBBC7", "#D1E5F0",  "#67A9CF", "#2166AC"),
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )
############################################X


############################################X
############################################
############################################X
##### Plot all scneario into 1 plot #####
par(mfrow=c(2,2))
par(cex.main = 1.5,  # Font size for main title
    cex.lab = 1.25,  # Font size for xlab and ylab
    cex.axis = 1) # Font size for axis tick labels

############################################X
#### Margin########################################
par(mar = c(2, 5, 3, 2)) #margin bottom, left, up, right


############################################X
#### Plot ME Effects ########################
############################################X

plot(x = pH,
     y = log_R_Fo_lowSD,
     type = "l",
     xlim = c(6,10),
     ylab = NA,
     )
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))
points(x = pH,
       y = log_R_Fo_upSD,
       type = "l"
)
#Area for Dunite
polygon(c(pH, rev(pH)), c(log_R_Fo_upSD, rev(log_R_Fo_lowSD)), col = "lightgreen")
#Mean for Dunite
points(x = pH,
       y = log_R_Fo_mean,
       type = "l"
)


#Loop
for (i in seq(1, 4, 1)){
  df <- list_df_short_dunite_calculated[[i]]
  pch_seq = c(24,21,22, 23)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(df$rate)
  #plot points
  points(x, y, pch = pch_seq[i], cex = 3, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-7.5),
       title = expression(paste(bold("Rotational Speed"))),
       #legend = c(df_short_dunite[1:4]),
       legend = c("No Mixing", "30 RPM", "50 RPM", "90 RPM"),
       pch = c(24,21,22, 23), 
       col = "black",
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )

############################################X
#### Plot Grain Size ########################
############################################X

plot(x = pH,
     y = log_R_Fo_lowSD,
     type = "l",
     xlim = c(6,10),
     ylab = NA,
     )
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))
points(x = pH,
       y = log_R_Fo_upSD,
       type = "l"
)
#Area for Dunite
polygon(c(pH, rev(pH)), c(log_R_Fo_upSD, rev(log_R_Fo_lowSD)), col = "lightgreen")
#Mean for Dunite
points(x = pH,
       y = log_R_Fo_mean,
       type = "l"
)

#Loop
for (i in c(5:7)){
  df <- list_df_short_dunite_calculated[[i]]
  pch_seq = c(21,22, 24)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-4], cex = 3, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-7.5),
       title = expression(paste(bold("Grain Size"))),
       #legend = c(df_short_dunite[1:4]),
       legend = c("Fine", "Medium", "Coarse"),
       pch = c(21,22, 24), 
       col = "black",
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )


############################################X
#### Plot Water Ratio########################
############################################X

plot(x = pH,
     y = log_R_Fo_lowSD,
     type = "l",
     xlim = c(6,10),
     ylab = NA,
     )
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))
points(x = pH,
       y = log_R_Fo_upSD,
       type = "l"
)
#Area for Dunite
polygon(c(pH, rev(pH)), c(log_R_Fo_upSD, rev(log_R_Fo_lowSD)), col = "lightgreen")
#Mean for Dunite
points(x = pH,
       y = log_R_Fo_mean,
       type = "l"
)

#Loop
for (i in c(8:10)){
  df <- list_df_short_dunite_calculated[[i]]
  pch_seq = c(21,22, 24)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-7], cex = 3, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-7.5),
       title = expression(paste(bold("Rock:Water Ratio"))),
       #legend = c(df_short_dunite[1:4]),
       legend = c("1:2", "1:3", "1:5"),
       pch = c(21,22, 24), 
       col = "black",
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )


############################################X
#### Water Replacement#######################
############################################X

plot(x = pH,
     y = log_R_Fo_lowSD,
     type = "l",
     xlim = c(6,10),
     ylab = NA,
     )
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))
points(x = pH,
       y = log_R_Fo_upSD,
       type = "l"
)
#Area for Dunite
polygon(c(pH, rev(pH)), c(log_R_Fo_upSD, rev(log_R_Fo_lowSD)), col = "lightgreen")
#Mean for Dunite
points(x = pH,
       y = log_R_Fo_mean,
       type = "l"
)
#Loop
for (i in c(11:12)){
  df <- list_df_short_dunite_calculated[[i]]
  pch_seq = c(21,22,24)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-10], cex = 3, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-7.5),
       title = expression(paste(bold("Water Replacement"))),
       #legend = c(df_short_dunite[1:4]),
       legend = c("Without", "Daily"),
       pch = c(21,22, 24), 
       col = "black",
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )


```

```{r "Basalt and Dunite -  Weathering Rate"}
####################################################################################
#### Plot all scneario into 1 plot ##############
par(mfrow=c(2,4))
par(cex.main = 1.5,  # Font size for main title
    cex.lab = 1.5,  # Font size for xlab and ylab
    cex.axis = 1.5, # Font size for axis tick labels
    las = 1)
par(mar = c(4, 5, 4, 1)) #margin bottom, left, up, right

############################################X


############################################X
####################################################################################
# WR Dunite: Short Term Experiment ######
#### Subset data from short-term experience dataframe

#### Mechanical Effects
rpm_0_dunite <- subset(db_st, id_code == "base_dunite" & duration_day <=4)
rpm_0_dunite <- subset(rpm_0_dunite , duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_30_dunite <- subset(db_st, id_code == "rpm_slow")
rpm_30_dunite <- subset(rpm_30_dunite, duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_50_dunite <- subset(db_st, id_code == "rpm_medium" & duration_day <=4)
rpm_50_dunite <- subset(rpm_50_dunite,  duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_90_dunite <- subset(db_st, id_code == "rpm_high")
rpm_90_dunite <- subset(rpm_90_dunite, duration_day <=1 | duration_day == 2 | duration_day == 3 | duration_day == 4)

rpm_0_dunite$pH <- c(5.79, 7.11, 7.19, 7.37, 7.39, 7.44)

##### Grain Size
df_13_50 <- subset(db_st, db_st$id_code == "DF-13-50")
dm_13_50 <- subset(db_st, db_st$id_code == "DM-13-50")
dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")

#### Water Ratio
dc_12 <- subset(db_st, db_st$id_code == "DC-12-50")
dc_13 <- subset(db_st, db_st$id_code == "DC-13-50")
dc_15 <- subset(db_st, db_st$id_code == "DC-15-50")

#Water Replacement
dc_nwr <- subset(db_st, db_st$id_code == "DC-13-NWR-50")
dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")


############################################X
#### Calculating the rates ####
############################################X


#Make a list from some variables/dataframes
df_short_dunite <- c("rpm_0_dunite", "rpm_30_dunite", "rpm_50_dunite", "rpm_90_dunite",
                     "df_13_50", "dm_13_50", "dc_13_50",
                     "dc_12", "dc_13", "dc_15",
                     "dc_nwr", "dc_13_50")

list_df_short_dunite <- list(rpm_0_dunite, rpm_30_dunite, rpm_50_dunite, rpm_90_dunite,
                             df_13_50, dm_13_50, dc_13_50,
                             dc_12, dc_13, dc_15,
                             dc_nwr, dc_13_50)

# Define a function for your calculation
calculate_rate <- function(df) {
  #2/3 is the conservative calculation of TA after water replacement
  x <- (df$TA_umol_kg * 2) /3 
  x <- x[1:(length(x) - 1)]
  #Assign the calculation into new column
  df["TA_AR_umol_kg"] <- c(0, x)
  df["TA_gain_umol_kg"] <- df$TA_umol_kg - df$TA_AR_umol_kg
  #Calculating the rate
  df["rate"] <- ((df$TA_gain_umol_kg/1000000) * 3) / ((df$ssa_m2_g) * (1*1000) * (1*24*60*60))
  return(df)
}

# Perform the calculation for each dataframe in the list according the defined function
list_df_short_dunite_calculated <- lapply(list_df_short_dunite, calculate_rate)

#extract new dataframe from list
for (i in seq_along(list_df_short_dunite_calculated)){
  var_name <- df_short_dunite[i]
  assign(var_name, list_df_short_dunite_calculated[[i]])
}

############################################X
#### Plot ME Effects ########################
############################################X

plot(x = pH,
     y = log_R_Fo_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-14,-8),
     ylab = NA,
     )
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(3,1,0))
points(x = pH,
       y = log_R_Fo_upSD,
       type = "l"
)
#Area for Dunite
polygon(c(pH, rev(pH)), c(log_R_Fo_upSD, rev(log_R_Fo_lowSD)), col = "lightgreen")
#Mean for Dunite
points(x = pH,
       y = log_R_Fo_mean,
       type = "l"
)


#Loop
for (i in seq(1, 4, 1)){
  df <- list_df_short_dunite_calculated[[i]]
  pch_seq = c(24,21,22, 23)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(df$rate)
  #plot points
  points(x, y, pch = pch_seq[i], cex = 3.5, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 8,
       y = log10(10^-12.1),
       # title = expression(paste(bold("Rotational Speed"))),
       # legend = c(df_short_dunite[1:4]),
       legend = c("No Mixing", "30 RPM", "50 RPM", "90 RPM"),
       pch = c(24,21,22, 23), 
       col = "black",
       bty = "n",
       # horiz = TRUE,
       # inset = 0.02,
       # title.adj=0.05,
       x.intersp = 0.8,
       # ncol = 2,
       y.intersp=1.25,
       cex = 1.5,
       pt.cex = 2
)


#Label for Sub-Title
text(x = 10,
     y = log10(10^-8.5),
     labels = expression(bold("A")),
     cex = 4,
     pos = 2
     )

#Label for Legend Title
text(x = 8,
     y = log10(10^-12),
     labels = expression(bold("Rotational Speed")),
     cex = 1.5,
     pos = 4
)

#Title
mtext(expression(bold("Dunite")), side = 3, cex = 2, adj = 0, line = 1)

############################################X
#### Plot Grain Size ########################
############################################X

plot(x = pH,
     y = log_R_Fo_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-14,-8),
     ylab = NA,
     )
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(3,1,0))
points(x = pH,
       y = log_R_Fo_upSD,
       type = "l"
)
#Area for Dunite
polygon(c(pH, rev(pH)), c(log_R_Fo_upSD, rev(log_R_Fo_lowSD)), col = "lightgreen")
#Mean for Dunite
points(x = pH,
       y = log_R_Fo_mean,
       type = "l"
)

#Loop
for (i in c(5:7)){
  df <- list_df_short_dunite_calculated[[i]]
  pch_seq = c(21,24, 22)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-4], cex = 3.5, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-12.1),
       # title = expression(paste(bold("Grain Size"))),
       # legend = c(df_short_dunite[1:4]),
       legend = c("Fine", "Medium", "Coarse"),
       pch = c(21,24, 22), 
       col = "black",
       bty = "n",
       # horiz = TRUE,
       # inset = 0.02,
       # title.adj=0.05,
       x.intersp = 0.8,
       # ncol = 2,
       y.intersp=1.25,
       cex = 1.5,
       pt.cex = 2
)


#Label for Sub-Title
text(x = 10,
     y = log10(10^-8.5),
     labels = expression(bold("B")),
     cex = 4,
     pos = 2
     )

#Label for Legend Title
text(x = 6,
     y = log10(10^-12),
     labels = expression(bold("Grain Size")),
     cex = 1.5,
     pos = 4
)

############################################X
#### Plot Water Ratio########################
############################################X

plot(x = pH,
     y = log_R_Fo_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-14,-8),
     ylab = NA,
     )
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(3,1,0))
points(x = pH,
       y = log_R_Fo_upSD,
       type = "l"
)
#Area for Dunite
polygon(c(pH, rev(pH)), c(log_R_Fo_upSD, rev(log_R_Fo_lowSD)), col = "lightgreen")
#Mean for Dunite
points(x = pH,
       y = log_R_Fo_mean,
       type = "l"
)

#Loop
for (i in c(8:10)){
  df <- list_df_short_dunite_calculated[[i]]
  pch_seq = c(21,22,23)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-7], cex = 3.5, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-12.1),
       # title = expression(paste(bold("Rock:Water Ratio"))),
       # legend = c(df_short_dunite[1:4]),
       legend = c("1:2", "1:3", "1:5"),
       pch = c(21,22,23), 
       col = "black",
       bty = "n",
       # horiz = TRUE,
       # inset = 0.02,
       # title.adj=0.05,
       x.intersp = 0.8,
       # ncol = 2,
       y.intersp=1.25,
       cex = 1.5,
       pt.cex = 2
)


#Label for Sub-Title
text(x = 10,
     y = log10(10^-8.5),
     labels = expression(bold("C")),
     cex = 4,
     pos = 2
     )

#Label for Legend Title
text(x = 6,
     y = log10(10^-12),
     labels = expression(bold("Rock-Water Ratio")),
     cex = 1.5,
     pos = 4
)



############################################X
#### Water Replacement#######################
############################################X

plot(x = pH,
     y = log_R_Fo_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-14,-8),
     ylab = NA,
     )
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(3,1,0))
points(x = pH,
       y = log_R_Fo_upSD,
       type = "l"
)
#Area for Dunite
polygon(c(pH, rev(pH)), c(log_R_Fo_upSD, rev(log_R_Fo_lowSD)), col = "lightgreen")
#Mean for Dunite
points(x = pH,
       y = log_R_Fo_mean,
       type = "l"
)
#Loop
for (i in c(11:12)){
  df <- list_df_short_dunite_calculated[[i]]
  pch_seq = c(21,22,24)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-10], cex = 3.5, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-12.1),
       # title = expression(paste(bold("Water Replacement"))),
       # legend = c(df_short_dunite[1:4]),
       legend = c("Without", "Daily"),
       pch = c(21,22, 24), 
       col = "black",
       bty = "n",
       # horiz = TRUE,
       # inset = 0.02,
       # title.adj=0.05,
       x.intersp = 0.8,
       # ncol = 2,
       y.intersp=1.25,
       cex = 1.5,
       pt.cex = 2
       )


#Label for Sub-Title
text(x = 10,
     y = log10(10^-8.5),
     labels = expression(bold("D")),
     cex = 4,
     pos = 2
     )

#Label for Legend Title
text(x = 6,
     y = log10(10^-12),
     labels = expression(bold("Water Replacement")),
     cex = 1.5,
     pos = 4
)


####################################################################################
# WR Basalt: Short Term Experiment ######

# Subset data
#Subset data from short-term experience dataframe

####################################Raw data
#rpm
rpm_0_basalt <- subset(db_st, id_code == "base_basalt")
rpm_0_basalt$pH <- c(5.71, 6.39, 6.80, 6.85, 6.93, 6.97, 7.01, 7.12)
rpm_50_basalt <- subset(db_st, id_code == "BF-13-50")
#grain size
bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")
bc_13_50 <- subset(db_st, db_st$id_code == "BC-13-50")
#water ratio
bc_12 <- subset(db_st, db_st$id_code == "BC-12-50")
bc_13 <- subset(db_st, db_st$id_code == "BC-13-50")
bc_15 <- subset(db_st, db_st$id_code == "BC-15-50")
#water replacement
bf_nwr <- subset(db_st, db_st$id_code == "BF-13-NWR-50")
bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")


#### Calculating the rates ####

#Make a list from some variables/dataframes
df_short_basalt <- c("rpm_0_basalt", "rpm_50_basalt", 
                     "bf_13_50", "bc_13_50",
                     "bc_12", "bc_13", "bc_15", 
                     "bf_nwr", "bf_13_50")

list_df_short_basalt <- list(rpm_0_basalt, rpm_50_basalt, bf_13_50, bc_13_50,
                             bc_12, bc_13, bc_15, bf_nwr, bf_13_50)

# Define a function for your calculation
calculate_rate <- function(df) {
  #2/3 is the conservative calculation of TA after water replacement
  x <- (df$TA_umol_kg * 2) /3 
  x <- x[1:(length(x) - 1)]
  #Assign the calculation into new column
  df["TA_AR_umol_kg"] <- c(0, x)
  df["TA_gain_umol_kg"] <- df$TA_umol_kg - df$TA_AR_umol_kg
  #Calculating the rate
  df["rate"] <- ((df$TA_gain_umol_kg/1000000) * 3) / ((df$ssa_m2_g) * (1*1000) * (1*24*60*60))
  return(df)
}

# Perform the calculation for each dataframe in the list according the defined function
list_df_short_basalt_calculated <- lapply(list_df_short_basalt, calculate_rate)

#extract new dataframe from list
for (i in seq_along(list_df_short_basalt_calculated)){
  var_name <- df_short_basalt[i]
  assign(var_name, list_df_short_basalt_calculated[[i]])
}



############################################X
#### Plot ME Effects ########################
############################################X


plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-14,-8),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(3,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Basalt
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)

#Loop 
for (i in c(1:2)){
  df <- list_df_short_basalt_calculated[[i]]
  pch_seq = c(24,22)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i], cex = 3.5, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}


legend(x = 8,
       y = log10(10^-13.1),
       # title = expression(paste(bold("Rotational Speed"))),
       legend = c("No Mixing","50 RPM"),
       pch = c(24,22), 
       col = "black",
       bty = "n",
       # horiz = TRUE,
       # inset = 0.02,
       # title.adj=0.05,
       x.intersp = 0.8,
       # ncol = 2,
       y.intersp=1.25,
       cex = 1.5,
       pt.cex = 2
)

#add sub-heading
text(x = 10,
     y = log10(10^-8.5),
     labels = expression(bold("E")),
     cex = 4,
     pos = 2
     )

#add title for legend
text(x = 8,
     y = log10(10^-13),
     labels = expression(bold("Rotational Speed")),
     cex = 1.5,
     pos = 4
)

#Title
mtext(expression(bold("Basanite")), side = 3, cex = 2, adj = 0, line = 1)

############################################X
#### Plot Grain Size ########################
############################################X

plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-14,-8),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(3,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Basalt
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)

#Loop 
for (i in c(3:4)){
  df <- list_df_short_basalt_calculated[[i]]
  pch_seq = c(21,22)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-2], cex = 3.5, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-13.1),
       # title = expression(paste(bold("Grain Size"))),
       legend = c("Fine", "Coarse"),
       pch = c(21,22), 
       col = "black",
       bty = "n",
       # horiz = TRUE,
       # inset = 0.02,
       # title.adj=0.05,
       x.intersp = 0.8,
       # ncol = 2,
       y.intersp=1.25,
       cex = 1.5,
       pt.cex = 2
)

#add sub-heading
text(x = 10,
     y = log10(10^-8.5),
     labels = expression(bold("F")),
     cex = 4,
     pos = 2
     )

#add title for legend
text(x = 6,
     y = log10(10^-13),
     labels = expression(bold("Grain Size")),
     cex = 1.5,
     pos = 4
)

############################################X
#### Plot Water Ratio########################
############################################X

plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-14,-8),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(3,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Basalt
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)

#Loop 
for (i in c(5:7)){
  df <- list_df_short_basalt_calculated[[i]]
  pch_seq = c(21,22,23)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-4], cex = 3.5, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-13.1),
       # title = expression(paste(bold("Rock:Water Ratio"))),
       legend = c("1:2", "1:3", "1:5"),
       pch = c(21,22,23), 
       col = "black",
       bty = "n",
       horiz = TRUE,
       # inset = 0.02,
       # title.adj=0.05,
       x.intersp = 0.8,
       # ncol = 2,
       y.intersp=1.25,
       cex = 1.5,
       pt.cex = 2
)

#add sub-heading
text(x = 10,
     y = log10(10^-8.5),
     labels = expression(bold("G")),
     cex = 4,
     pos = 2
     )

#add title for legend
text(x = 6,
     y = log10(10^-13),
     labels = expression(bold("Rock-Water Ratio")),
     cex = 1.5,
     pos = 4
)


############################################X
#### Water Replacement#######################
############################################X
plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-14,-8),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(3,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Basalt
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)

#Loop 
for (i in c(8:9)){
  df <- list_df_short_basalt_calculated[[i]]
  pch_seq = c(21,22)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-7], cex = 3.5, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-13.1),
       # title = expression(paste(bold("Water Replacement"))),
       legend = c("Without", "Daily"),
       pch = c(21,22), 
       col = "black",
       bty = "n",
       # horiz = TRUE,
       # inset = 0.02,
       # title.adj=0.05,
       x.intersp = 0.8,
       # ncol = 2,
       y.intersp=1.25,
       cex = 1.5,
       pt.cex = 2
)

#add sub-heading
text(x = 10,
     y = log10(10^-8.5),
     labels = expression(bold("H")),
     cex = 4,
     pos = 2
     )

#add title for legend
text(x = 6,
     y = log10(10^-13),
     labels = expression(bold("Water Replacement")),
     cex = 1.5,
     pos = 4
)

```

```{r "Basalt - Weathering Rate using DSi to generate TA"}

# WR Basalt: Short Term Experiment #####

# Subset data ####
#Subset data from short-term experience dataframe

####################################Raw data
#rpm
rpm_0_basalt <- subset(db_st, id_code == "base_basalt")
rpm_0_basalt$pH <- c(5.71, 6.39, 6.80, 6.85, 6.93, 6.97, 7.01, 7.12)
rpm_50_basalt <- subset(db_st, id_code == "BF-13-50")
#grain size
bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")
bc_13_50 <- subset(db_st, db_st$id_code == "BC-13-50")
#water ratio
bc_12 <- subset(db_st, db_st$id_code == "BC-12-50")
bc_13 <- subset(db_st, db_st$id_code == "BC-13-50")
bc_15 <- subset(db_st, db_st$id_code == "BC-15-50")
#water replacement
bf_nwr <- subset(db_st, db_st$id_code == "BF-13-NWR-50")
bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")


####Calculating the rates####

#Make a list from some variables/dataframes
df_short_basalt <- c("rpm_0_basalt", "rpm_50_basalt", 
                     "bf_13_50", "bc_13_50",
                     "bc_12", "bc_13", "bc_15", 
                     "bf_nwr", "bf_13_50")

list_df_short_basalt <- list(rpm_0_basalt, rpm_50_basalt, bf_13_50, bc_13_50,
                             bc_12, bc_13, bc_15, bf_nwr, bf_13_50)

# Define a function for your calculation
calculate_rate <- function(df) {
  #2/3 is the conservative calculation of TA after water replacement
  x <- (df$DSi_umol_l * 2.5 * 2) /3 
  x <- x[1:(length(x) - 1)]
  #Assign the calculation into new column
  df["DSi_AR_umol_kg"] <- c(0, x)
  df["DSi_gain_umol_kg"] <- (df$DSi_umol_l *2.5) - df$DSi_AR_umol_kg
  #Calculating the rate
  df["rate"] <- ((df$DSi_gain_umol_kg/1000000) * 3) / ((df$ssa_m2_g) * (1*1000) * (1*24*60*60))
  return(df)
}

# Perform the calculation for each dataframe in the list according the defined function
list_df_short_basalt_calculated <- lapply(list_df_short_basalt, calculate_rate)

#extract new dataframe from list
for (i in seq_along(list_df_short_basalt_calculated)){
  var_name <- df_short_basalt[i]
  assign(var_name, list_df_short_basalt_calculated[[i]])
}



############################################X
#### Plot All ###############################
############################################X

plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-17, -5),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Basalt
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)

#Loop for all basalt experiment
for (i in c(1:length(list_df_short_basalt_calculated))){
  df <- list_df_short_basalt_calculated[[i]]
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = 21, cex = 2, col = "black", bg = "red")
}



###########################################X
#### Legend Day
plot.new()
legend("center",
       title = expression(paste(bold("Day"))),
       #legend = c(df_short_dunite[1:4]),
       legend = c(levels(as.factor(df$legend_day))),
       pch = 21, 
       col = "black",
       pt.bg = c("#B2182B",  "#EF8A62", "#FDBBC7", "#D1E5F0",  "#67A9CF", "#2166AC"),
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )
############################################X

############################################
#### Plot all scneario into 1 plot ####
par(mfrow=c(2,2))
par(cex.main = 1.5,  # Font size for main title
    cex.lab = 1.25,  # Font size for xlab and ylab
    cex.axis = 1) # Font size for axis tick labels
############################################X

#### Margin########################################
par(mar = c(2, 5, 3, 2)) #margin bottom, left, up, right


############################################X
#### Plot ME Effects ########################
############################################X
plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-17, -5),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Basalt
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)

#Loop 
for (i in c(1:2)){
  df <- list_df_short_basalt_calculated[[i]]
  pch_seq = c(21,22)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i], cex = 3, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}



legend(x = 6,
       y = log10(10^-5.5),
       title = expression(paste(bold("Rotational Speed"))),
       legend = c("No Mixing","50 RPM"),
       pch = c(21,22), 
       col = "black",
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )

############################################X
#### Plot Grain Size ########################
############################################X
plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-17, -5),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Basalt
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)

#Loop 
for (i in c(3:4)){
  df <- list_df_short_basalt_calculated[[i]]
  pch_seq = c(21,22)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-2], cex = 3, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-5.5),
       title = expression(paste(bold("Grain Size"))),
       legend = c("Fine", "Coarse"),
       pch = c(21,22), 
       col = "black",
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )

############################################X
#### Plot Water Ratio########################
############################################X
plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-17, -5),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Basalt
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)

#Loop 
for (i in c(5:7)){
  df <- list_df_short_basalt_calculated[[i]]
  pch_seq = c(21,22,23)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-4], cex = 3, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-5.5),
       title = expression(paste(bold("Water Ratio"))),
       legend = c("1:2", "1:3", "1:5"),
       pch = c(21,22,23), 
       col = "black",
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )

############################################X
#### Water Replacement#######################
############################################X
plot(x = pH,
     y = log_R_Ba_lowSD,
     type = "l",
     xlim = c(6,10),
     ylim = c(-17, -5),
     ylab = NA,
)
title(ylab = expression(paste("log Weathering Rate [mol / m" ^ "2" ~ "s]")), mgp=c(2,1,0))

points(x = pH,
       y = log_R_Ba_upSD,
       type = "l"
)
#Area for Basalt
polygon(c(pH, rev(pH)), c(log_R_Ba_upSD, rev(log_R_Ba_lowSD)), col = "grey50")
#Mean for Basalt
points(x = pH,
       y = log_R_Ba_mean,
       type = "l"
)

#Loop 
for (i in c(8:9)){
  df <- list_df_short_basalt_calculated[[i]]
  pch_seq = c(21,22)
  #extract x and y from dataframe
  x <- df$pH
  y <- log10(as.numeric(df$rate))
  #plot points
  points(x, y, pch = pch_seq[i-7], cex = 3, col = "black",
         bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(df$legend_day)],
)
}

legend(x = 6,
       y = log10(10^-5.5),
       title = expression(paste(bold("Water Replacement"))),
       legend = c("Without", "Daily"),
       pch = c(21,22), 
       col = "black",
       bty = "n",
       horiz = TRUE,
       inset = 0.02,
       title.adj=0.05,
       cex = 1
       )

```


## 8. Backup

```{r "Dunite - Cations and TA", include=TRUE}
# 
# ############################################X
# ##### Plot all scneario into 1 plot#####
# par(mfrow=c(2,3))
# par(mfrow=c(2,3), #rows, columns several plots into one
#     cex.main = 1.5,  # Font size for main title
#     cex.lab = 1.75,  # Font size for xlab and ylab
#     cex.axis = 1.5) # Font size for axis tick labels
# ############################################X
# 
# 
# 
# #### Subset data for Dunite only ####
# db_st_dunite <- subset(db_st, db_st$rock_type == "dunite")
# db_st_dunite <- db_st_dunite[!(db_st_dunite$duration_day == 7 & db_st_dunite$Mg_umol_l == 0), ]
# db_st_dunite <- db_st_dunite[complete.cases(db_st_dunite$Mg_umol_l), ]
# 
# db_st_dunite <- db_st_dunite[!(db_st_dunite$Ca_umol_l == 0), ]
# 
# db_st_dunite_fine <- subset(db_st_dunite , db_st_dunite$grain_size == "fine")
# db_st_dunite_medium <- subset(db_st_dunite , db_st_dunite$grain_size == "medium")
# db_st_dunite_coarse <- subset(db_st_dunite , db_st_dunite$grain_size == "coarse")
# 
# 
# #### Sequence for data (line) ####
# seq_x <-seq(from = -10000, to = 100000, by = 1)
# 
# 
# ###########################################X
# ##### Legend ###############################
# ###########################################X
# 
# # plot.new()
# # #### Legend Day
# # legend("topleft",
# #        title = as.expression(bquote(bold("Day of Observation"))),
# #        legend = c(levels(as.factor(db_st_dunite$legend_day))),
# #        pt.bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b"),
# #        col = "black",
# #        pch = 21,
# #        ncol = 2,
# #        bty = "n",
# #        cex = 1.1,
# #        horiz = TRUE
# # )
# # #### Grain Size
# # legend("topright",
# #        title = as.expression(bquote(bold("Grain Size"))),
# #        legend = c(levels(as.factor(db_st_dunite$grain_size))),
# #        pt.bg = c("black"),
# #        col = "black",
# #        pch = c(22,21,24),
# #        ncol = 1,
# #        bty = "n",
# #        cex = 1.1,
# #        horiz = TRUE
# # )
# # #### Legend line
# # legend("bottomleft",
# #        legend = c("Quadratic - 2nd Degree"),
# #        lty = 2,
# #        col = c("darkblue"),
# #        bty = "n"
# # )
# 
# 
# 
# ##################################################################X
# #### Dunite Mg vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = db_st_dunite$Mg_umol_l * 2 * 10^-3, 
#      y = db_st_dunite$TA_umol_kg * 10^-3,
#      xlim = c(0, 50),
#      ylim = c(0, 50),
#      xlab = expression(bold("Mg"^"2+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity in mEq/L")),
#      pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
#      col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
#      cex = 4
# )
# ##### 1:1 Line #####
# lines(seq_x, (seq_x*1),
#       lty = 6)
# text(x = 35, y = 35,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 4,
#      cex = 1.5)
# # #1:5 lines
# # lines(seq_x, (seq_x*1.5),
# #       lty = 6)
# # text(x = 30, y = 45,
# #      labels = as.expression(bquote(bold("y = 1.5 x"))),
# #      pos = 2,
# #      cex = 1.5)
# #1:1.1 lines
# lines(seq_x, (seq_x*1.1),
#       lty = 6)
# text(x = 40.5, y = 45,
#      labels = as.expression(bquote(bold("y = 1.1 x"))),
#      pos = 2,
#      cex = 1.5)
# 
# 
# ##################################################################X
# #### Dunite Na+K vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = (db_st_dunite$Na_umol_l + db_st_dunite$K_umol_l) * 10^-3, 
#      y = (db_st_dunite$TA_umol_kg) * 10^-3,
#      xlim = c(0, 2),
#      ylim = c(0, 30),
#      xlab = expression(bold("Na"^"+"*" + K"^"+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity in mEq/L")),
#      pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
#      col = "black",  bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
#      cex = 4
# )
# 
# 
# ##### #### #### ### coarse grain size #### #### #### ####
# x = (db_st_dunite$Na_umol_l + db_st_dunite$K_umol_l) * 10^-3
# y = (db_st_dunite$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# 
# # Fit an exponential regression model
# model <- lm(log(y) ~ x)
# 
# # Extract coefficients
# intercept <- exp(coef(model)[1])
# slope <- coef(model)[2]
# 
# # Print coefficients
# print(paste("Intercept:", intercept))
# print(paste("Slope:", slope))
# 
# # Plot the original data and the fitted exponential curve
# x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
# y_pred <- intercept * exp(slope * x_pred)
# 
# #plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
# lines(x_pred, y_pred, col = "black", type = "l", lty = 2)
# 
# 
# ##################################################################X
# #### Dunite Ca vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = db_st_dunite$Ca_umol_l * 2 * 10^-3, 
#      y = (db_st_dunite$TA_umol_kg) * 10^-3,
#      xlim = c(0, 0.15),
#      ylim = c(0, 30),
#      xlab = expression(bold("Ca"^"2+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity in mEq/L")),
#      pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
#      col = "black",  bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
#      cex = 4
# )
# 
# ##### #### #### ### border #### #### #### ####
# lines((seq_x*0)+0.115, (seq_x),
#       lty = 1)
# text(x =0.115, y = 2,
#      labels = as.expression(bquote(bold("limit x"))),
#      pos = 4,
#      cex = 1.5)
# 
# ##### #### #### ### fine grain size #### #### #### ####
# x = db_st_dunite_fine$Ca_umol_l * 2 * 10^-3
# y = (db_st_dunite_fine$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# # Fit an exponential regression model
# model <- lm(log(y) ~ x)
# 
# # Extract coefficients
# intercept <- exp(coef(model)[1])
# slope <- coef(model)[2]
# 
# # Print coefficients
# print(paste("Intercept:", intercept))
# print(paste("Slope:", slope))
# 
# # Plot the original data and the fitted exponential curve
# x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
# y_pred <- intercept * exp(slope * x_pred)
# 
# #plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
# lines(x_pred, y_pred, col = "black", type = "l", lty = 2)
# 
# #add text
# text(x =0.125, y = intercept * exp(slope * 0.125),
#      labels = as.expression(bquote(bold("Fine"))),
#      pos = 4,
#      cex = 1.5)
# 
# 
# ##### #### #### ### medium grain size #### #### #### ####
# x = db_st_dunite_medium$Ca_umol_l * 2 * 10^-3
# y = (db_st_dunite_medium$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# # Fit an exponential regression model
# model <- lm(log(y) ~ x)
# 
# # Extract coefficients
# intercept <- exp(coef(model)[1])
# slope <- coef(model)[2]
# 
# # Print coefficients
# print(paste("Intercept:", intercept))
# print(paste("Slope:", slope))
# 
# # Plot the original data and the fitted exponential curve
# x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
# y_pred <- intercept * exp(slope * x_pred)
# 
# #plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
# lines(x_pred, y_pred, col = "black", type = "l", lty = 2)
# 
# #add text
# text(x =0.041, y = intercept * exp(slope * 0.041),
#      labels = as.expression(bquote(bold("Medium"))),
#      pos = 4,
#      cex = 1.5)
# 
# ##### #### #### ### coarse grain size #### #### #### ####
# x = db_st_dunite_coarse$Ca_umol_l * 2 * 10^-3
# y = (db_st_dunite_coarse$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# # Fit an exponential regression model
# model <- lm(log(y) ~ x)
# 
# # Extract coefficients
# intercept <- exp(coef(model)[1])
# slope <- coef(model)[2]
# 
# # Print coefficients
# print(paste("Intercept:", intercept))
# print(paste("Slope:", slope))
# 
# # Plot the original data and the fitted exponential curve
# x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
# y_pred <- intercept * exp(slope * x_pred)
# 
# #plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
# lines(x_pred, y_pred, col = "black", type = "l", lty = 2)
# 
# #add text
# text(x =0.103, y = intercept * exp(slope * 0.103),
#      labels = as.expression(bquote(bold("Coarse"))),
#      pos = 4,
#      cex = 1.5)




```

```{r "Basalt - Cations and TA", include=TRUE}
# 
# 
# # ############################################X
# # #Plot all scneario into 1 plot
# # par(mfrow=c(2,3))
# # par(cex.main = 2,  # Font size for main title
# #     cex.lab = 2,  # Font size for xlab and ylab
# #     cex.axis = 2) # Font size for axis tick labels
# # ############################################X
# 
# #### Subset data for Basalt only ####
# db_st_basalt <- subset(db_st, db_st$rock_type == "basalt")
# db_st_basalt<- db_st_basalt[complete.cases(db_st_basalt$Ca_umol_l), ]
# db_st_basalt <- db_st_basalt[!(db_st_basalt$Ca_umol_l == 0), ]
# 
# db_st_basalt_fine <- subset(db_st_basalt , db_st_basalt$grain_size == "fine")
# db_st_basalt_coarse <- subset(db_st_basalt , db_st_basalt$grain_size == "coarse")
# 
# #### Sequence for data (line) ####
# seq_x <-seq(from = -10000, to = 100000, by = 1)
# 
# ###########################################X
# ##### Legend ###############################
# ###########################################X
# 
# # plot.new()
# # #### Legend Day
# legend("topleft",
#        title = as.expression(bquote(bold("Day of Observation"))),
#        legend = c(levels(as.factor(db_st_basalt$legend_day))),
#        pt.bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b"),
#        col = "black",
#        pch = 21,
#        ncol = 1,
#        bty = "n",
#        cex = 1.1,
#        #horiz = TRUE
# )
# # #### Grain Size
# # legend("topright",
# #        title = as.expression(bquote(bold("Grain Size"))),
# #        legend = c(levels(as.factor(db_st_basalt$grain_size))),
# #        pt.bg = c("black"),
# #        col = "black",
# #        pch = c(22,21),
# #        ncol = 2,
# #        bty = "n",
# #        cex = 1.1,
# # )
# ############################################X
# 
# 
# 
# ############################################X
# #####Plot all scneario into 1 plot ####
# # par(mfrow=c(1,3))
# # par(cex.main = 2,  # Font size for main title
# #     cex.lab = 2,  # Font size for xlab and ylab
# #     cex.axis = 2) # Font size for axis tick labels
# ############################################X
# 
# 
# ##################################################################X
# #### Basanite Mg vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = db_st_basalt$Mg_umol_l * 2 * 10^-3, 
#      y = db_st_basalt$TA_umol_kg * 10^-3,
#      xlim = c(0, 5),
#      ylim = c(0, 10),
#      xlab = expression(bold("Mg"^"2+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity in mEq/L")),
#      pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
#      col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
#      cex = 4
# )
# 
# #### Linear regression ####
# #### Basalt Coarse
# #1:2 lines
# lines(seq_x, (seq_x*2),
#       lty = 6)
# text(x = 8/2, y = 8,
#      labels = as.expression(bquote(bold("1:2 line"))),
#      pos = 4,
#      cex = 1.5)
# 
# # # Fit linear regression model
# # x = db_st_basalt_coarse$Mg_umol_l * 2 * 10^-3
# # y = db_st_basalt_coarse$TA_umol_kg * 10^-3
# # lm_model <- lm(y ~ x)
# # # Summary of the regression model
# # summary(lm_model)
# # # Plot the data and regression line
# # abline(lm_model, 
# #        col = "black",
# #        lty = 2)
# # # Get the coefficients
# # coefficients <- coef(lm_model)
# # # Print the coefficients
# # print(coefficients)
# # # Add coefficent into the plot
# # text(x = 8/2, y = 8,
# #      labels = as.expression(bquote(bold("y = 1.96x + 0.22"))),
# #      pos = 4,
# #      cex = 1.5)
# 
# #### Log regression ####
# #### Basalt Fine
# # Fit linear regression model
# x = db_st_basalt_fine$Mg_umol_l * 2 * 10^-3
# y = db_st_basalt_fine$TA_umol_kg * 10^-3
# lm_model <- lm(y ~ x)
# # Summary of the regression model
# summary(lm_model)
# # Plot the data and regression line
# abline(lm_model, 
#        col = "black",
#        lty = 2)
# # Get the coefficients
# coefficients <- coef(lm_model)
# # Print the coefficients
# # Add lable
# text(x = 2.5, y = ((1.435597*2.5)+ 2.606444),
#      labels = as.expression(bquote(bold("Fine"))),
#      pos = 2,
#      cex = 1.5)
# print(coefficients)
# # # Add coefficent into the plot
# # text(x = 2.5, y = ((1.735597*2.5)+ 2.606444),
# #      labels = as.expression(bquote(bold("y = 1.44x + 2.61"))),
# #      pos = 2,
# #      cex = 1.5)
# 
# 
# 
# ##################################################################X
# #### Basanite Na+K vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = (db_st_basalt$Na_umol_l + db_st_basalt$K_umol_l) * 10^-3, 
#      y = (db_st_basalt$TA_umol_kg) * 10^-3,
#      xlim = c(0, 5),
#      ylim = c(0, 10),
#      xlab = expression(bold("Na"^"+"*" + K"^"+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity in mEq/L")),
#      pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
#      col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
#      cex = 4
# )
# 
# ##### 1:1 Lines ####
# lines(seq_x, ((seq_x*1)),
#       lty = 6)
# text(x = 1, y = 1-0.2,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 4,
#      cex = 1.5)
# # #1:5 lines
# # lines(seq_x, (seq_x*3),
# #       lty = 6)
# # text(x = 9/3, y =9,
# #      labels = as.expression(bquote(bold("y = 3 x"))),
# #      pos = 2,
# #      cex = 1.5)
# 
# #### log model ####
# ##### #### #### ### coarse grain size #### #### #### ####x
# x=(db_st_basalt_coarse$Na_umol_l + db_st_basalt_coarse$K_umol_l) * 10^-3
# y=(db_st_basalt_coarse$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# #fit the model
# model <- lm(y ~ log(x))
# #view the output of the model
# summary(model)
# # Get the coefficients
# coefficients <- coef(model)
# # Print the coefficients
# print(coefficients)
# 
# #plot x vs. y
# #plot(x, y)
# #define x-values to use for regression line
# x=seq(from=0.0001,to=1000,length.out=1000000)
# #use the model to predict the y-values based on the x-values
# y=predict(model,newdata=list(x=seq(from=0.0001,to=1000,length.out=1000000)))
# #add the fitted regression line to the plot (lwd specifies the width of the line)
# matlines(x,y, lwd=1, col = "black", lty = 2)
# 
# # Add text
# text(x = 3, y = (3.703433+(1.954100*log(3))),
#      labels = as.expression(bquote(bold("Coarse"))),
#      pos = 4,
#      cex = 1.5)
# # # Add text for coefficient
# # text(x = 3, y = (3.003433+(1.954100*log(3))),
# #      labels = as.expression(bquote(bold("y=3.90+1.95*log(x)"))),
# #      pos = 4,
# #      cex = 1.5)
# 
# ##################################################################X
# #### Basanite Ca vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = (db_st_basalt$Ca_umol_l * 2) * 10^-3, 
#      y = (db_st_basalt$TA_umol_kg) * 10^-3,
#      xlim = c(0, 2),
#      ylim = c(0, 10),
#      xlab = expression(bold("Ca"^"2+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity in mEq/L")),
#      pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
#      col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
#      cex = 4
# )
# ####1:1 Lines####
# lines(seq_x, (seq_x*1),
#       lty = 6)
# text(x = 1, y = 1-0.2,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 1,
#      cex = 1.5)
# #border
# lines((seq_x*0)+1.4, (seq_x),
#       lty = 6)
# text(x =1.4, y = 10,
#      labels = as.expression(bquote(bold("limit x"))),
#      pos = 2,
#      cex = 1.5)
# 
# 
# #### log model ####
# ##### #### #### ### log fine grain size #### #### #### ####
# x=(db_st_basalt_fine$Ca_umol_l * 2) * 10^-3
# y=(db_st_basalt_fine$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# #fit the model
# model <- lm(y ~ log(x))
# #view the output of the model
# summary(model)
# # Get the coefficients
# coefficients <- coef(model)
# # Print the coefficients
# print(coefficients)
# 
# #plot x vs. y
# #plot(x, y)
# #define x-values to use for regression line
# x=seq(from=0.0001,to=1000,length.out=1000000)
# #use the model to predict the y-values based on the x-values
# y=predict(model,newdata=list(x=seq(from=0.0001,to=1000,length.out=1000000)))
# #add the fitted regression line to the plot (lwd specifies the width of the line)
# matlines(x,y, lwd=1, col = "black", lty = 2)
# 
# # Add coefficent into the plot
# text(x = 1.5, y = ((4.192892)+ (0.6849959*log(1.5))),
#      labels = as.expression(bquote(bold("Fine"))),
#      pos = 4,
#      cex = 1.5)
# 
# # # Add coefficent into the plot
# # text(x = 1.5, y = ((3.692892)+ (0.6849959*log(1.5))),
# #      labels = as.expression(bquote(bold("y = 3.91x + 0.68*log(x)"))),
# #      pos = 4,
# #      cex = 1.5)
# 
# 
# ##### #### #### ### exp coarse grain size #### #### #### ####
# x=(db_st_basalt_coarse$Ca_umol_l * 2) * 10^-3
# y=(db_st_basalt_coarse$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# # Fit an exponential regression model
# model <- lm(log(y) ~ x)
# 
# # Extract coefficients
# intercept <- exp(coef(model)[1])
# slope <- coef(model)[2]
# 
# # Print coefficients
# print(paste("Intercept:", intercept))
# print(paste("Slope:", slope))
# 
# # Plot the original data and the fitted exponential curve
# x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
# y_pred <- intercept * exp(slope * x_pred)
# 
# #plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
# lines(x_pred, y_pred, col = "black", type = "l", lty = 2)
# 
# 
# # Add coefficent into the plot
# text(x = 1.5, y = (intercept * exp(slope * 1.5)),
#      labels = as.expression(bquote(bold("Coarse"))),
#      pos = 4,
#      cex = 1.5)
# 
# # # Add coefficent into the plot
# # text(x = 1.5, y = (intercept * exp(slope * 1.5) - 0.5),
# #      labels = as.expression(bquote(bold("y = 0.58 * exp(1.78x)"))),
# #      pos = 4,
# #      cex = 1.5)
# 
# 
# 
# 
# # legend("topleft",
# #        legend = c("Regression - Basanite Fine", "Regression - Basanite Coarse"),
# #        lty = c(2,2),
# #        col = c("darkblue", "red"),
# #        bty = "n",
# #        cex = 1.5
# # )
# 


```

```{r "Dunite - Cations and TA-Cations", include=TRUE}
# 
# ############################################X
# #Plot all scneario into 1 plot
# #par(mfrow=c(1,3))
# #par(cex.main = 1.5,  # Font size for main title
# #    cex.lab = 1.25,  # Font size for xlab and ylab
# #    cex.axis = 1) # Font size for axis tick labels
# ############################################X
# 
# 
# #### Subset data for Dunite only ####
# db_st_dunite <- subset(db_st, db_st$rock_type == "dunite")
# db_st_dunite <- db_st_dunite[!(db_st_dunite$duration_day == 7 & db_st_dunite$Mg_umol_l == 0), ]
# db_st_dunite <- db_st_dunite[complete.cases(db_st_dunite$Mg_umol_l), ]
# 
# db_st_dunite <- db_st_dunite[!(db_st_dunite$Ca_umol_l == 0), ]
# 
# 
# db_st_dunite_fine <- subset(db_st_dunite , db_st_dunite$grain_size == "fine")
# db_st_dunite_medium <- subset(db_st_dunite , db_st_dunite$grain_size == "medium")
# db_st_dunite_coarse <- subset(db_st_dunite , db_st_dunite$grain_size == "coarse")
# 
# 
# #### Sequence for data (line) ####
# seq_x <-seq(from = -10000, to = 100000, by = 1)
# 
# 
# ###########################################X
# ##### Legend ###############################
# ###########################################X
# 
# # plot.new()
# # #### Legend Day
# # legend("topleft",
# #        title = as.expression(bquote(bold("Day of Observation"))),
# #        legend = c(levels(as.factor(db_st_dunite$legend_day))),
# #        pt.bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b"),
# #        col = "black",
# #        pch = 21,
# #        ncol = 2,
# #        bty = "n",
# #        cex = 1.1,
# #        horiz = TRUE
# # )
# # #### Grain Size
# # legend("topright",
# #        title = as.expression(bquote(bold("Grain Size"))),
# #        legend = c(levels(as.factor(db_st_dunite$grain_size))),
# #        pt.bg = c("black"),
# #        col = "black",
# #        pch = c(22,21,24),
# #        ncol = 1,
# #        bty = "n",
# #        cex = 1.1,
# #        horiz = TRUE
# # )
# # #### Legend line
# # legend("bottomleft",
# #        legend = c("Quadratic - 2nd Degree"),
# #        lty = 2,
# #        col = c("darkblue"),
# #        bty = "n"
# # )
# 
# 
# 
# 
# 
# #####Plot all scneario into 1 plot ####
# # par(mfrow=c(1,3))
# # par(cex.main = 2,  # Font size for main title
# #     cex.lab = 2,  # Font size for xlab and ylab
# #     cex.axis = 2) # Font size for axis tick labels
# # ############################################X
# 
# 
# ##################################################################X
# #### Dunite Mg vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(5, 7, 2, 2)) #margin bottom, left, up, right
# plot(x = db_st_dunite$Mg_umol_l * 2 * 10^-3, 
#      y = db_st_dunite$TA_umol_kg * 10^-3,
#      xlim = c(0, 50),
#      ylim = c(0, 50),
#      xlab = expression(bold("Mg"^"2+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity in mEq/L")),
#      pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
#      col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
#      cex = 4
# )
# #1:1 Lines
# lines(seq_x, (seq_x*1),
#       lty = 6)
# text(x = 45, y = 45,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 4,
#      cex = 1.5)
# # #1:5 lines
# # lines(seq_x, (seq_x*1.5),
# #       lty = 6)
# # text(x = 30, y = 45,
# #      labels = as.expression(bquote(bold("y = 1.5 x"))),
# #      pos = 2,
# #      cex = 1.5)
# #1:1.1 lines
# lines(seq_x, (seq_x*1.1),
#       lty = 6)
# text(x = 40.5, y = 45,
#      labels = as.expression(bquote(bold("y = 1.1 x"))),
#      pos = 2,
#      cex = 1.5)
# 
# 
# ##################################################################X
# #### Dunite Na+K vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(5, 7, 2, 2)) #margin bottom, left, up, right
# plot(x = (db_st_dunite$Na_umol_l + db_st_dunite$K_umol_l) * 10^-3, 
#      y = (db_st_dunite$TA_umol_kg - db_st_dunite$Mg_umol_l * 2) * 10^-3,
#      xlim = c(0, 3),
#      ylim = c(0, 3),
#      xlab = expression(bold("Na"^"+"*" + K"^"+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity - Magnesium (Mg"^"2+"*") in mEq/L")),
#      pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
#      col = "black",  bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
#      cex = 4
# )
# #1:1 Lines
# lines(seq_x, (seq_x*1),
#       lty = 6)
# text(x = 2.7, y = 2.7,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 4,
#      cex = 1.5)
# #1:1.2 lines
# lines(seq_x, (seq_x*1.2),
#       lty = 6)
# text(x = 2.7/1.2, y = 2.7,
#      labels = as.expression(bquote(bold("y = 1.2 x"))),
#      pos = 2,
#      cex = 1.5)
# 
# 
# ##################################################################X
# #### Dunite Ca vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(5, 7, 2, 2)) #margin bottom, left, up, right
# plot(x = db_st_dunite$Ca_umol_l * 2 * 10^-3, 
#      y = (db_st_dunite$TA_umol_kg - db_st_dunite$Mg_umol_l * 2) * 10^-3,
#      xlim = c(0, 0.15),
#      ylim = c(0, 3),
#      xlab = expression(bold("Ca"^"2+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity - Magnesium (Mg"^"2+"*") in mEq/L")),
#      pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
#      col = "black",  bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
#      cex = 4
# )
# #1:11 Lines (for fine)
# lines(seq_x, (seq_x*11),
#       lty = 6)
# text(x = 0.10, y = 0.10*11,
#      labels = as.expression(bquote(bold("y = 11 x"))),
#      pos = 1,
#      cex = 1.5)
# #1:33 lines (for medium)
# lines(seq_x, (seq_x*33),
#       lty = 6,
#      cex = 2)
# text(x =3/33, y = 3,
#      labels = as.expression(bquote(bold("y = 33 x"))),
#      pos = 4,
#      cex = 1.5)
# #border
# lines((seq_x*0)+0.115, (seq_x),
#       lty = 6)
# text(x =0.115, y = 2,
#      labels = as.expression(bquote(bold("limit x"))),
#      pos = 4,
#      cex = 1.5)
# 
# # Fit log regression model (for coarse)
# x = db_st_dunite_coarse$Ca_umol_l * 2 * 10^-3
# y = (db_st_dunite_coarse$TA_umol_kg - db_st_dunite_coarse$Mg_umol_l * 2) * 10^-3
# #fit the model
# model <- lm(log(y) ~ x)
# #view the output of the model
# summary(model)
# 
# #plot x vs. y
# #plot(x, y)
# #define x-values to use for regression line
# x=seq(from=0.0001,to=1000,length.out=1000000)
# #use the model to predict the y-values based on the x-values
# y=exp(predict(model,newdata=list(x=seq(from=0.0001,to=1000,length.out=1000000))))
# #add the fitted regression line to the plot (lwd specifies the width of the line)
# matlines(x,y, lwd=1, col = "darkblue", lty = 2)
# 
# 
# # ##### Quadratic Model for Ca
# # x = (db_st_dunite$Ca_umol_l * 2 * 10^-3) 
# # y = (db_st_dunite$TA_umol_kg - db_st_dunite$Mg_umol_l * 2) * 10^-3
# # model <- lm(y ~ poly(x, degree = 2, raw = TRUE))
# # 
# # x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
# # y_pred <- predict(model, newdata = data.frame(x = x_pred))
# # 
# # lines(x_pred, y_pred, col = "darkblue", lwd = 1, type= "l", lty = 2 )  # Add regression line
# # 
# # 
# # plot.new()
# # #### Legend line
# # #legend("topleft",
# # #       legend = c("Quadratic - 2nd Degree"),
# # #       lty = 2,
# # #       col = c("darkblue"),
# # #       bty = "n"
# # #)
# # 
# # #### Legend line
# # legend("topleft",
# #        legend = c("Regression (all grain sizes)"),
# #        lty = 2,
# #        col = c("darkblue"),
# #        bty = "n"
# # )
# 
# ################################################
# plot(x = (db_st_dunite$Na_umol_l + db_st_dunite$K_umol_l) * 10^-3, 
#      y = (db_st_dunite$TA_umol_kg - db_st_dunite$Mg_umol_l * 2 - db_st_dunite$Ca_umol_l *2 ) * 10^-3,
#      xlim = c(0, 3),
#      #ylim = c(0, 30),
#      xlab = expression(bold("Na"^"+"*" + K"^"+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity in mEq/L")),
#      pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
#      col = "black",  bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
#      cex = 4
# )

############################################X
```

```{r "Basanite and Dunite - Cation and Anion Fraction backup", include=TRUE}
# ##### Cations
# ##### Set the layout ####
# par(mfrow=c(2,3), #rows, columns several plots into one
#     cex.main = 1.5,  # Font size for main title
#     cex.lab = 1.75,  # Font size for xlab and ylab
#     cex.axis = 1.5) # Font size for axis tick labels
# 
# #### Dunite ####
# #### Subset data 
# # only water replaced
# db_st_dunite_fraction <- db_st_dunite[!db_st_dunite$water_replacement == "no",]
# # only normal treatment
# db_st_dunite_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$pressure_cooked == "no",]
# # only 1:3 ratio
# db_st_dunite_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$rock_water_ratio == "1 to 3",]
# 
# #dunite fine, medium, and coarse
# db_st_dunite_fine_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$grain_size == "fine",]
# db_st_dunite_medium_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$grain_size == "medium",]
# db_st_dunite_coarse_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$grain_size == "coarse",]
# 
# 
# #fine
# plot(x = db_st_dunite_fine_fraction$duration_day, 
#      y = db_st_dunite_fine_fraction$fraction_Ca*100,
#      ylim = c(0,10),
#      xlab = "",
#      ylab = expression(bold("Ca"^paste(2,"+")*"  fraction from ΣCations (%)")),
#      pch = 21,
#      col = "black", 
#      bg = "#f1eef6",
#      cex = 2.5,
# )
# #medium
# points(x = db_st_dunite_medium_fraction$duration_day, 
#      y = db_st_dunite_medium_fraction$fraction_Ca*100,
#      pch = 24,
#      col = "black", 
#      bg = "#74a9cf",
#      cex = 2.5,
# )
# #coarse
# points(x = db_st_dunite_coarse_fraction$duration_day, 
#      y = db_st_dunite_coarse_fraction$fraction_Ca*100,
#      pch = 22,
#      col = "black", 
#      bg = "#034e7b",
#      cex = 2.5,
# )
# 
# plot(x = db_st_basalt_fine_fraction$duration_day, 
#      y = db_st_basalt_fine_fraction$fraction_Ca*100,
#      ylim = c(0,100),
#      xlab = "",
#      ylab = expression(bold("Ca"^paste(2,"+")*"  fraction from ΣCations (%)")),
#      pch = 21,
#      col = "black", 
#      bg = "#f1eef6",
#      cex = 2.5,
# )
# points(x = db_st_basalt_coarse_fraction$duration_day, 
#      y = db_st_basalt_coarse_fraction$fraction_Ca*100,
#      ylim = c(0,100),
#      xlab = "",
#      ylab = expression(bold("Ca"^paste(2,"+")*"  fraction from ΣCations (%)")),
#      pch = 22,
#      col = "black", 
#      bg ="#034e7b",
#      cex = 2.5,
# )
# 
# 
# #### Cation
# par(mar = c(3, 5, 5, 2)) #margin bottom, left, up, right
# #calcium
# plot(x = db_st_dunite_fraction$duration_day, 
#      y = db_st_dunite_fraction$fraction_Ca*100,
#      ylim = c(0,50),
#      xlab = "",
#      ylab = expression(bold("Ca"^paste(2,"+")*"  fraction from ΣCations (%)")),
#      pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)], #level coarse:22, fine:21, medium:24
#      col = "black", 
#      bg = c("#f1eef6", "#74a9cf", "#034e7b")[as.factor(db_st_dunite_fraction$grain_size)],
#      cex = 2.5,
# )
# 
# #magnesium
# plot(x = db_st_dunite_fraction$duration_day, 
#      y = db_st_dunite_fraction$fraction_Mg*100,
#      ylim = c(0,100),
#      xlab = "",
#      ylab = expression(bold("Mg"^paste(2,"+")*"  fraction from ΣCations (%)")),
#      pch = c(21,24,22)[as.factor(db_st_dunite_fraction$grain_size)],
#      col = "black", 
#      bg = c("#f1eef6", "#74a9cf", "#034e7b")[as.factor(db_st_dunite_fraction$grain_size)],
#      cex = 2.5,
# )
# #na + k
# plot(x = db_st_dunite_fraction$duration_day, 
#      y = (db_st_dunite_fraction$fraction_Na + db_st_dunite_fraction$fraction_K)*100,
#      ylim = c(0,100),
#      xlab = "",
#      ylab = expression(bold("Na"^paste("+")*" + K"^paste("+")*"  fraction from ΣCations (%)")),
#      pch = c(21,24,22)[as.factor(db_st_dunite_fraction$grain_size)],
#      col = "black", 
#      bg = c("#f1eef6", "#74a9cf", "#034e7b")[as.factor(db_st_dunite_fraction$grain_size)],
#      cex = 2.5,
# )
# 
# #### Basanite ####
# #### Subset data
# # only water replaced
# db_st_basalt_fraction <- db_st_basalt[!db_st_basalt$water_replacement == "no",]
# # only normal treatment
# db_st_basalt_fraction <- db_st_basalt_fraction[db_st_basalt_fraction$pressure_cooked == "no",]
# # only 1:3 ratio
# db_st_basalt_fraction <- db_st_basalt_fraction[db_st_basalt_fraction$rock_water_ratio == "1 to 3",]
# 
# 
# par(mar = c(5, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = db_st_basalt_fraction$duration_day, 
#      y = db_st_basalt_fraction$fraction_Ca*100,
#      ylim = c(0,100),
#      xlab = "",
#      ylab = expression(bold("Ca"^paste(2,"+")*"  fraction from ΣCations (%)")),
#      pch = c(21,22)[as.factor(db_st_basalt_fraction$grain_size)],
#      col = "black", 
#      bg = c("#f1eef6", "#034e7b")[as.factor(db_st_basalt_fraction$grain_size)],
#      cex = 2.5,
# )
# 
# plot(x = db_st_basalt_fraction$duration_day, 
#      y = db_st_basalt_fraction$fraction_Mg*100,
#      ylim = c(0,100),
#      xlab = expression(bold("--- DAY ---")),
#      ylab = expression(bold("Mg"^paste(2,"+")*"  fraction from ΣCations (%)")),
#      pch = c(21,22)[as.factor(db_st_basalt_fraction$grain_size)],
#      col = "black", 
#      bg = c("#f1eef6", "#034e7b")[as.factor(db_st_basalt_fraction$grain_size)],
#      cex = 2.5,
# )
# 
# plot(x = db_st_basalt_fraction$duration_day, 
#      y = (db_st_basalt_fraction$fraction_Na + db_st_basalt_fraction$fraction_K)*100,
#      ylim = c(0,100),
#      xlab = "",
#      ylab = expression(bold("Na"^paste("+")*" + K"^paste("+")*"  fraction from ΣCations (%)")),
#      pch = c(21,22)[as.factor(db_st_basalt_fraction$grain_size)],
#      col = "black", 
#      bg = c("#f1eef6", "#034e7b")[as.factor(db_st_basalt_fraction$grain_size)],
#      cex = 2.5,
# )
# 
# # #### Legend
# # 
# # #plot.new()
# # plot(x = c(0,10),
# #      y = c(0,10),
# #      xlab = "",
# #      ylab = "",
# #      axes = FALSE,
# #      bty = "n",
# #      col = "white"
# # )
# # 
# # #### Grain Size by the shapes
# # legend("topleft",
# #        title = as.expression(bquote(bold("Grain Size"))),
# #        legend = c(levels(as.factor(db_st_dunite_fraction$grain_size))),
# #        pt.bg = c("black"),
# #        col = "black",
# #        pch = c(21,24,22),
# #        ncol = 1,
# #        bty = "n",
# #        cex = 1.5,
# #        #horiz = TRUE
# # )
# # 
# # plot.new()
# # #### Rock-Water Ratio
# # legend("topleft",
# #        title = as.expression(bquote(bold("Rock-Water Ratio"))),
# #        legend = c(levels(as.factor(db_st_dunite_fraction$rock_water_ratio))),
# #        pt.bg = c("#f1eef6", "#74a9cf", "#034e7b"),
# #        col = "black",
# #        pch = 21,
# #        ncol = 1,
# #        bty = "n",
# #        cex = 1.5,
# #        #horiz = TRUE
# # )
# 
# 
# #####Anions
# ##### Set the layout ####
# par(mfrow=c(2,4), #rows, columns several plots into one
#     cex.main = 1.5,  # Font size for main title
#     cex.lab = 1.75,  # Font size for xlab and ylab
#     cex.axis = 1.5) # Font size for axis tick labels
# par(mar = c(3, 6, 5, 2)) #margin bottom, left, up, right
# 
# #### Dunite ####
# #### Subset data
# # only water replaced
# db_st_dunite_fraction <- db_st_dunite[!db_st_dunite$water_replacement == "no",]
# # only normal treatment
# db_st_dunite_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$pressure_cooked == "no",]
# # only 1:3 ratio
# db_st_dunite_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$rock_water_ratio == "1 to 3",]
# 
# 
# ###Anion
# #TA
# plot(x = db_st_dunite_fraction$duration_day, 
#      y = db_st_dunite_fraction$fraction_TA*100,
#      ylim = c(90,100),
#      xlab = "",
#      ylab = expression(bold("TA fraction from ΣAnions (%)")),
#      pch = c(21,24,22)[as.factor(db_st_dunite_fraction$grain_size)],
#      col = "black", 
#      bg = c("#f1eef6", "#74a9cf", "#034e7b")[as.factor(db_st_dunite_fraction$grain_size)],
#      cex = 2.5,
# )
# #SO42
# plot(x = db_st_dunite_fraction$duration_day, 
#      y = db_st_dunite_fraction$fraction_SO42*100,
#      ylim = c(0,5),
#      xlab = "",
#      ylab = expression(bold("SO"[4]^paste(2,"-")*"  fraction from ΣAnions (%)")),
#      pch = c(21,24,22)[as.factor(db_st_dunite_fraction$grain_size)],
#      col = "black", 
#      bg = c("#f1eef6", "#74a9cf", "#034e7b")[as.factor(db_st_dunite_fraction$grain_size)],
#      cex = 2.5,
# )
# #NO3
# plot(x = db_st_dunite_fraction$duration_day, 
#      y = (db_st_dunite_fraction$fraction_NO3)*100,
#      ylim = c(0,5),
#      xlab = "",
#      ylab = expression(bold("NO"[3]^paste("-")*"  fraction from ΣAnions (%)")),
#      pch = c(21,24,22)[as.factor(db_st_dunite_fraction$grain_size)],
#      col = "black", 
#      bg = c("#f1eef6", "#74a9cf", "#034e7b")[as.factor(db_st_dunite_fraction$grain_size)],
#      cex = 2.5,
# )
# #Cl
# plot(x = db_st_dunite_fraction$duration_day, 
#      y = (db_st_dunite_fraction$fraction_Cl)*100,
#      ylim = c(0,10),
#      xlab = "",
#      ylab = expression(bold("Cl"^paste("-")*"  fraction from ΣAnions (%)")),
#      pch = c(21,24,22)[as.factor(db_st_dunite_fraction$grain_size)],
#      col = "black", 
#      bg = c("#f1eef6", "#74a9cf", "#034e7b")[as.factor(db_st_dunite_fraction$grain_size)],
#      cex = 2.5,
# )
# 
# 
# #### Basanite ####
# #### Subset data
# # only water replaced
# db_st_basalt_fraction <- db_st_basalt[!db_st_basalt$water_replacement == "no",]
# # only normal treatment
# db_st_basalt_fraction <- db_st_basalt_fraction[db_st_basalt_fraction$pressure_cooked == "no",]
# # only 1:3 ratio
# db_st_basalt_fraction <- db_st_basalt_fraction[db_st_basalt_fraction$rock_water_ratio == "1 to 3",]
# 
# ###Anion
# #TA
# plot(x = db_st_basalt_fraction$duration_day, 
#      y = db_st_basalt_fraction$fraction_TA*100,
#      ylim = c(50,100),
#      xlab = "",
#      ylab = expression(bold("TA fraction from ΣAnions (%)")),
#      pch = c(21,22)[as.factor(db_st_basalt_fraction$grain_size)],
#      col = "black", 
#      bg = c("#f1eef6", "#034e7b")[as.factor(db_st_basalt_fraction$grain_size)],
#      cex = 2.5,
# )
# #SO42
# plot(x = db_st_basalt_fraction$duration_day, 
#      y = db_st_basalt_fraction$fraction_SO42*100,
#      ylim = c(0,25),
#      xlab = "",
#      ylab = expression(bold("SO"[4]^paste(2,"-")*"  fraction from ΣAnions (%)")),
#      pch = c(21,22)[as.factor(db_st_basalt_fraction$grain_size)],
#      col = "black", 
#      bg = c("#f1eef6", "#034e7b")[as.factor(db_st_basalt_fraction$grain_size)],
#      cex = 2.5,
# )
# #NO3
# plot(x = db_st_basalt_fraction$duration_day, 
#      y = (db_st_basalt_fraction$fraction_NO3)*100,
#      ylim = c(0,5),
#      xlab = "",
#      ylab = expression(bold("NO"[3]^paste("-")*"  fraction from ΣAnions (%)")),
#      pch = c(21,22)[as.factor(db_st_basalt_fraction$grain_size)],
#      col = "black", 
#      bg = c("#f1eef6", "#034e7b")[as.factor(db_st_basalt_fraction$grain_size)],
#      cex = 2.5,
# )
# #Cl
# plot(x = db_st_basalt_fraction$duration_day, 
#      y = (db_st_basalt_fraction$fraction_Cl)*100,
#      ylim = c(0,10),
#      xlab = "",
#      ylab = expression(bold("Cl"^paste("-")*"  fraction from ΣAnions (%)")),
#      pch = c(21,22)[as.factor(db_st_basalt_fraction$grain_size)],
#      col = "black", 
#      bg = c("#f1eef6", "#034e7b")[as.factor(db_st_basalt_fraction$grain_size)],
#      cex = 2.5,
# )
# 
#  
# #### Legend
# 
# #plot.new()
# plot(x = c(0,10),
#      y = c(0,10),
#      xlab = "",
#      ylab = "",
#      axes = FALSE,
#      bty = "n",
#      col = "white"
# )
# 
# #### Grain Size by the shapes
# legend("topleft",
#        title = as.expression(bquote(bold("Grain Size"))),
#        legend = c(levels(as.factor(db_st_dunite_fraction$grain_size))),
#        pt.bg = c("#f1eef6", "#74a9cf", "#034e7b"),
#        col = "black",
#        pch = c(21,24,22),
#        ncol = 1,
#        bty = "n",
#        cex = 1.5,
#        #horiz = TRUE
# )
# 
# 
# 
# # 
# # plot.new()
# # #### Rock-Water Ratio
# # legend("topleft",
# #        title = as.expression(bquote(bold("Rock-Water Ratio"))),
# #        legend = c(levels(as.factor(db_st_dunite_fraction$rock_water_ratio))),
# #        pt.bg = c("#f1eef6", "#74a9cf", "#034e7b"),
# #        col = "black",
# #        pch = 21,
# #        ncol = 1,
# #        bty = "n",
# #        cex = 1.5,
# #        #horiz = TRUE
# # )


```

```{r "Basanite and Dunite - Cation and Anion Fraction backup 1", include=TRUE}
# ##### Cations ####
# #### Subset Data ####
# #### Dunite ###################################################################x
# # only water replaced
# db_st_dunite_fraction <- db_st_dunite[!db_st_dunite$water_replacement == "no",]
# # only normal treatment
# db_st_dunite_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$pressure_cooked == "no",]
# db_st_dunite_fraction <- db_st_dunite_fraction[!db_st_dunite_fraction$id_code == "DM-13-C-50",]
# db_st_dunite_fraction <- db_st_dunite_fraction[!db_st_dunite_fraction$id_code == "rpm_medium",]
# db_st_dunite_fraction <- db_st_dunite_fraction[!db_st_dunite_fraction$id_code == "DC-13-C-50",]
# 
# # only 1:3 ratio
# db_st_dunite_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$rock_water_ratio == "1 to 3",]
# #dunite fine, medium, and coarse
# db_st_dunite_fine_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$grain_size == "fine",]
# db_st_dunite_coarse_fraction <- db_st_dunite_fraction[db_st_dunite_fraction$grain_size == "coarse",]
# 
# #### Basanite ###################################################################x
# # only water replaced
# db_st_basalt_fraction <- db_st_basalt[!db_st_basalt$water_replacement == "no",]
# # only normal treatment
# db_st_basalt_fraction <- db_st_basalt_fraction[db_st_basalt_fraction$pressure_cooked == "no",]
# # only 1:3 ratio
# db_st_basalt_fraction <- db_st_basalt_fraction[db_st_basalt_fraction$rock_water_ratio == "1 to 3",]
# #dunite fine, medium, and coarse
# db_st_basalt_fine_fraction <- db_st_basalt_fraction[db_st_basalt_fraction$grain_size == "fine",]
# db_st_basalt_medium_fraction <- db_st_basalt_fraction[db_st_basalt_fraction$grain_size == "medium",]
# db_st_basalt_coarse_fraction <- db_st_basalt_fraction[db_st_basalt_fraction$grain_size == "coarse",]
# 
# 
# #level coarse:22, fine:21, medium:24
# #level coarse:"#034e7b", fine:"#f1eef6", medium:"#74a9cf"
# 
# 
# ##### Set the layout ####
# par(mfrow=c(2,3), #rows, columns several plots into one
#     cex.main = 1.5,  # Font size for main title
#     cex.lab = 1.75,  # Font size for xlab and ylab
#     cex.axis = 1.5) # Font size for axis tick labels
# 
# #### Dunite ####
# par(mar = c(3, 5, 5, 2)) #margin bottom, left, up, right
# #calcium
# plot(x = db_st_dunite_fraction$duration_day, 
#      y = db_st_dunite_fraction$fraction_Ca*100,
#      ylim = c(0,10),
#      xlab = "",
#      ylab = expression(bold("Ca"^paste(2,"+")*"  fraction from ΣCations (%)")),
#      pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)],
#      col = "black", 
#      bg = c( "#034e7b", "#f1eef6", "#74a9cf")[as.factor(db_st_dunite_fraction$grain_size)], 
#      cex = 2.5,
# )
# 
# 
# #magnesium
# plot(x = db_st_dunite_fraction$duration_day, 
#      y = db_st_dunite_fraction$fraction_Mg*100,
#      ylim = c(0,100),
#      xlab = "",
#      ylab = expression(bold("Mg"^paste(2,"+")*"  fraction from ΣCations (%)")),
#      pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)],
#      col = "black", 
#      bg = c( "#034e7b", "#f1eef6", "#74a9cf")[as.factor(db_st_dunite_fraction$grain_size)], 
#      cex = 2.5,
# )
# #na + k
# plot(x = db_st_dunite_fraction$duration_day, 
#      y = (db_st_dunite_fraction$fraction_Na + db_st_dunite_fraction$fraction_K)*100,
#      ylim = c(0,100),
#      xlab = "",
#      ylab = expression(bold("Na"^paste("+")*" + K"^paste("+")*"  fraction from ΣCations (%)")),
#      pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)],
#      col = "black", 
#      bg = c( "#034e7b", "#f1eef6", "#74a9cf")[as.factor(db_st_dunite_fraction$grain_size)], 
#      cex = 2.5,
# )
# 
# #### Basanite ####
# par(mar = c(5, 5, 5, 2)) #margin bottom, left, up, right
# #Ca
# plot(x = db_st_basalt_fraction$duration_day, 
#      y = db_st_basalt_fraction$fraction_Ca*100,
#      ylim = c(0,100),
#      xlab = "",
#      ylab = expression(bold("Ca"^paste(2,"+")*"  fraction from ΣCations (%)")),
#      pch = c(22,21)[as.factor(db_st_basalt_fraction$grain_size)],
#      col = "black", 
#      bg = c("#034e7b", "#f1eef6")[as.factor(db_st_basalt_fraction$grain_size)],
#      cex = 2.5,
# )
# #Mg
# plot(x = db_st_basalt_fraction$duration_day, 
#      y = db_st_basalt_fraction$fraction_Mg*100,
#      ylim = c(0,100),
#      xlab = expression(bold("--- DAY ---")),
#      ylab = expression(bold("Mg"^paste(2,"+")*"  fraction from ΣCations (%)")),
#      pch = c(22,21)[as.factor(db_st_basalt_fraction$grain_size)],
#      col = "black", 
#      bg = c("#034e7b", "#f1eef6")[as.factor(db_st_basalt_fraction$grain_size)],
#      cex = 2.5,
# )
# #Na+K
# plot(x = db_st_basalt_fraction$duration_day, 
#      y = (db_st_basalt_fraction$fraction_Na + db_st_basalt_fraction$fraction_K)*100,
#      ylim = c(0,100),
#      xlab = "",
#      ylab = expression(bold("Na"^paste("+")*" + K"^paste("+")*"  fraction from ΣCations (%)")),
#      pch = c(22,21)[as.factor(db_st_basalt_fraction$grain_size)],
#      col = "black", 
#      bg = c("#034e7b", "#f1eef6")[as.factor(db_st_basalt_fraction$grain_size)],
#      cex = 2.5,
# )
# 
# #####Anions ####
# ##### Set the layout ####
# par(mfrow=c(2,4), #rows, columns several plots into one
#     cex.main = 1.5,  # Font size for main title
#     cex.lab = 1.75,  # Font size for xlab and ylab
#     cex.axis = 1.5) # Font size for axis tick labels
# par(mar = c(3, 6, 5, 2)) #margin bottom, left, up, right
# 
# #### Dunite ####
# ###Anion
# #TA
# plot(x = db_st_dunite_fraction$duration_day, 
#      y = db_st_dunite_fraction$fraction_TA*100,
#      ylim = c(90,100),
#      xlab = "",
#      ylab = expression(bold("TA fraction from ΣAnions (%)")),
#      pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)],
#      col = "black", 
#      bg = c( "#034e7b", "#f1eef6", "#74a9cf")[as.factor(db_st_dunite_fraction$grain_size)], 
#      cex = 2.5,
# )
# #SO42
# plot(x = db_st_dunite_fraction$duration_day, 
#      y = db_st_dunite_fraction$fraction_SO42*100,
#      ylim = c(0,5),
#      xlab = "",
#      ylab = expression(bold("SO"[4]^paste(2,"-")*"  fraction from ΣAnions (%)")),
#      pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)],
#      col = "black", 
#      bg = c( "#034e7b", "#f1eef6", "#74a9cf")[as.factor(db_st_dunite_fraction$grain_size)], 
#      cex = 2.5,
# )
# #NO3
# plot(x = db_st_dunite_fraction$duration_day, 
#      y = (db_st_dunite_fraction$fraction_NO3)*100,
#      ylim = c(0,5),
#      xlab = "",
#      ylab = expression(bold("NO"[3]^paste("-")*"  fraction from ΣAnions (%)")),
#      pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)],
#      col = "black", 
#      bg = c( "#034e7b", "#f1eef6", "#74a9cf")[as.factor(db_st_dunite_fraction$grain_size)], 
#      cex = 2.5,
# )
# #Cl
# plot(x = db_st_dunite_fraction$duration_day, 
#      y = (db_st_dunite_fraction$fraction_Cl)*100,
#      ylim = c(0,10),
#      xlab = "",
#      ylab = expression(bold("Cl"^paste("-")*"  fraction from ΣAnions (%)")),
#      pch = c(22,21,24)[as.factor(db_st_dunite_fraction$grain_size)],
#      col = "black", 
#      bg = c( "#034e7b", "#f1eef6", "#74a9cf")[as.factor(db_st_dunite_fraction$grain_size)], 
#      cex = 2.5,
# )
# 
# 
# #### Basanite ####
# ###Anion
# #TA
# plot(x = db_st_basalt_fraction$duration_day, 
#      y = db_st_basalt_fraction$fraction_TA*100,
#      ylim = c(50,100),
#      xlab = "",
#      ylab = expression(bold("TA fraction from ΣAnions (%)")),
#      pch = c(22,21)[as.factor(db_st_basalt_fraction$grain_size)],
#      col = "black", 
#      bg = c("#034e7b", "#f1eef6")[as.factor(db_st_basalt_fraction$grain_size)],
#      cex = 2.5,
# )
# #SO42
# plot(x = db_st_basalt_fraction$duration_day, 
#      y = db_st_basalt_fraction$fraction_SO42*100,
#      ylim = c(0,25),
#      xlab = "",
#      ylab = expression(bold("SO"[4]^paste(2,"-")*"  fraction from ΣAnions (%)")),
#      pch = c(22,21)[as.factor(db_st_basalt_fraction$grain_size)],
#      col = "black", 
#      bg = c("#034e7b", "#f1eef6")[as.factor(db_st_basalt_fraction$grain_size)],
#      cex = 2.5,
# )
# #NO3
# plot(x = db_st_basalt_fraction$duration_day, 
#      y = (db_st_basalt_fraction$fraction_NO3)*100,
#      ylim = c(0,5),
#      xlab = "",
#      ylab = expression(bold("NO"[3]^paste("-")*"  fraction from ΣAnions (%)")),
#      pch = c(22,21)[as.factor(db_st_basalt_fraction$grain_size)],
#      col = "black", 
#      bg = c("#034e7b", "#f1eef6")[as.factor(db_st_basalt_fraction$grain_size)],
#      cex = 2.5,
# )
# #Cl
# plot(x = db_st_basalt_fraction$duration_day, 
#      y = (db_st_basalt_fraction$fraction_Cl)*100,
#      ylim = c(0,10),
#      xlab = "",
#      ylab = expression(bold("Cl"^paste("-")*"  fraction from ΣAnions (%)")),
#      pch = c(22,21)[as.factor(db_st_basalt_fraction$grain_size)],
#      col = "black", 
#      bg = c("#034e7b", "#f1eef6")[as.factor(db_st_basalt_fraction$grain_size)],
#      cex = 2.5,
# )
# 
#  
# #### Legend ####
# 
# plot.new()
# # plot(x = c(0,10),
# #      y = c(0,10),
# #      xlab = "",
# #      ylab = "",
# #      axes = FALSE,
# #      bty = "n",
# #      col = "white"
# # )
# 
# #### Grain Size by the shapes
# legend("topleft",
#        title = as.expression(bquote(bold("Grain Size"))),
#        legend = c(levels(as.factor(db_st_dunite_fraction$grain_size))),
#        pt.bg = c( "#034e7b", "#f1eef6", "#74a9cf"),
#        col = "black",
#        pch = c(22,21,24),
#        ncol = 1,
#        bty = "n",
#        cex = 1.5,
#        horiz = TRUE
# )
# 
# 
# 
# # 
# # plot.new()
# # #### Rock-Water Ratio
# # legend("topleft",
# #        title = as.expression(bquote(bold("Rock-Water Ratio"))),
# #        legend = c(levels(as.factor(db_st_dunite_fraction$rock_water_ratio))),
# #        pt.bg = c("#f1eef6", "#74a9cf", "#034e7b"),
# #        col = "black",
# #        pch = 21,
# #        ncol = 1,
# #        bty = "n",
# #        cex = 1.5,
# #        #horiz = TRUE
# # )


```

```{r "Basanite and Dunite - Cations and TA - backup 1", include=TRUE}
# 
# ################################################################################
# ##### Plot all scneario into 1 plot#####
# par(mfrow=c(2,3))
# par(mfrow=c(2,3), #rows, columns several plots into one
#     cex.main = 1.5,  # Font size for main title
#     cex.lab = 1.75,  # Font size for xlab and ylab
#     cex.axis = 1.5) # Font size for axis tick labels
# ############################################X
# 
# 
# 
# #### Subset data for Dunite only ####
# db_st_dunite <- subset(db_st, db_st$rock_type == "dunite")
# db_st_dunite <- db_st_dunite[!(db_st_dunite$duration_day == 7 & db_st_dunite$Mg_umol_l == 0), ]
# db_st_dunite <- db_st_dunite[complete.cases(db_st_dunite$Mg_umol_l), ]
# 
# db_st_dunite <- db_st_dunite[!(db_st_dunite$Ca_umol_l == 0), ]
# 
# db_st_dunite_fine <- subset(db_st_dunite , db_st_dunite$grain_size == "fine")
# db_st_dunite_medium <- subset(db_st_dunite , db_st_dunite$grain_size == "medium")
# db_st_dunite_coarse <- subset(db_st_dunite , db_st_dunite$grain_size == "coarse")
# 
# 
# #### Sequence for data (line) ####
# seq_x <-seq(from = -10000, to = 100000, by = 1)
# 
# 
# ###########################################X
# ##### Legend ###############################
# ###########################################X
# 
# # plot.new()
# # #### Legend Day
# # legend("topleft",
# #        title = as.expression(bquote(bold("Day of Observation"))),
# #        legend = c(levels(as.factor(db_st_dunite$legend_day))),
# #        pt.bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b"),
# #        col = "black",
# #        pch = 21,
# #        ncol = 2,
# #        bty = "n",
# #        cex = 1.1,
# #        horiz = TRUE
# # )
# # #### Grain Size
# # legend("topright",
# #        title = as.expression(bquote(bold("Grain Size"))),
# #        legend = c(levels(as.factor(db_st_dunite$grain_size))),
# #        pt.bg = c("black"),
# #        col = "black",
# #        pch = c(22,21,24),
# #        ncol = 1,
# #        bty = "n",
# #        cex = 1.1,
# #        horiz = TRUE
# # )
# # #### Legend line
# # legend("bottomleft",
# #        legend = c("Quadratic - 2nd Degree"),
# #        lty = 2,
# #        col = c("darkblue"),
# #        bty = "n"
# # )
# 
# 
# 
# ##################################################################X
# #### Dunite Mg vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = db_st_dunite$Mg_umol_l * 2 * 10^-3, 
#      y = db_st_dunite$TA_umol_kg * 10^-3,
#      xlim = c(0, 50),
#      ylim = c(0, 50),
#      xlab = expression(bold("Mg"^"2+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity in mEq/L")),
#      pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
#      col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
#      cex = 4
# )
# ##### 1:1 Line #####
# lines(seq_x, (seq_x*1),
#       lty = 1)
# text(x = 35, y = 35,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 4,
#      cex = 1.5)
# # #1:5 lines
# # lines(seq_x, (seq_x*1.5),
# #       lty = 6)
# # text(x = 30, y = 45,
# #      labels = as.expression(bquote(bold("y = 1.5 x"))),
# #      pos = 2,
# #      cex = 1.5)
# # # 1:1.1 lines
# # lines(seq_x, (seq_x*1.1),
# #       lty = 6)
# # text(x = 40.5, y = 45,
# #      labels = as.expression(bquote(bold("y = 1.1 x"))),
# #      pos = 2,
# #      cex = 1.5)
# 
# ##### linear regression ####
# # Fit linear regression model
# x = db_st_dunite$Mg_umol_l * 2 * 10^-3
# y = db_st_dunite$TA_umol_kg * 10^-3
# lm_model <- lm(y ~ x)
# 
# # Summary of the regression model
# summary(lm_model)
# 
# # Plot the data and regression line
# abline(lm_model, 
#        col = "black",
#        lty = 2)
# 
# # Get the coefficients
# coefficients <- coef(lm_model)
# 
# # Print the coefficients
# print(coefficients)
# 
# # Add lable for formula
# text(x = 40, y = 1.1*40,
#      labels = as.expression(bquote(bold("y = 1.1 x"))),
#      pos = 2,
#      cex = 1.5)
# 
# # Calculate R-squared value
# rsquared <- summary(lm_model)$r.squared
# print(paste("R-squared:", rsquared))
# 
# # Add lable for R-squared
# text(x = 38, y = 1.1*38,
#      labels = expression(bold("R"^"2"*" = 0.99")),
#      pos = 2,
#      cex = 1.5)
# 
# 
# ##################################################################X
# #### Dunite Na+K vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = (db_st_dunite$Na_umol_l + db_st_dunite$K_umol_l) * 10^-3, 
#      y = (db_st_dunite$TA_umol_kg) * 10^-3,
#      xlim = c(0, 2),
#      ylim = c(0, 30),
#      xlab = expression(bold("Na"^"+"*" + K"^"+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity in mEq/L")),
#      pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
#      col = "black",  bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
#      cex = 4
# )
# 
# 
# ##### #### #### ### log relationship for all grain size #### #### #### ####
# x = (db_st_dunite$Na_umol_l + db_st_dunite$K_umol_l) * 10^-3
# y = (db_st_dunite$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# # Fit an exponential regression model
# model <- lm(log(y) ~ x)
# 
# # Extract coefficients
# intercept <- exp(coef(model)[1])
# slope <- coef(model)[2]
# 
# # Print coefficients
# print(paste("Intercept:", intercept))
# print(paste("Slope:", slope))
# 
# # Calculate R-squared value
# rsquared <- summary(model)$r.squared
# print(paste("R-squared:", rsquared))
# 
# # Plot the original data and the fitted exponential curve
# x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
# y_pred <- intercept * exp(slope * x_pred)
# 
# #plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
# lines(x_pred, y_pred, col = "black", type = "l", lty = 2)
# 
# # Calculate upper and lower bounds of confidence interval
# se_intercept <- coef(summary(model))[1, "Std. Error"]
# se_slope <- coef(summary(model))[2, "Std. Error"]
# upper <- y_pred * exp(2 * sqrt(se_intercept^2 + (x * se_slope)^2))
# lower <- y_pred * exp(-2 * sqrt(se_intercept^2 + (x * se_slope)^2))
# polygon(c(x_pred, rev(x_pred)), c(upper, rev(lower)), col = "#CCCCCC80", border = NA)
# 
# #add text
# text(x = 1.25, y = intercept * exp(slope * 1.25),
#      labels = expression(bold("R"^"2"*" = 0.68")),
#      pos = 4,
#      cex = 1.5)
# 
# 
# 
# 
# ##################################################################X
# #### Dunite Ca vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = db_st_dunite$Ca_umol_l * 2 * 10^-3, 
#      y = (db_st_dunite$TA_umol_kg) * 10^-3,
#      xlim = c(0, 0.15),
#      ylim = c(0, 30),
#      xlab = expression(bold("Ca"^"2+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity in mEq/L")),
#      pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
#      col = "black",  bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
#      cex = 4
# )
# 
# ##### #### #### ### border #### #### #### ####
# lines((seq_x*0)+0.115, (seq_x),
#       lty = 1)
# text(x =0.115, y = 2,
#      labels = as.expression(bquote(bold("limit x"))),
#      pos = 4,
#      cex = 1.5)
# 
# ##### #### #### ### fine grain size #### #### #### ####
# # x = db_st_dunite_fine$Ca_umol_l * 2 * 10^-3
# # y = (db_st_dunite_fine$TA_umol_kg) * 10^-3
# 
# #subset the day 5,and 7
# db_sub <- subset(db_st_dunite_fine, db_st_dunite_fine$duration_day < 4)
# 
# x = db_sub$Ca_umol_l * 2 * 10^-3
# y = (db_sub$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# # Fit an exponential regression model
# model <- lm(log(y) ~ x)
# 
# # Extract coefficients
# intercept <- exp(coef(model)[1])
# slope <- coef(model)[2]
# 
# # Print coefficients
# print(paste("Intercept:", intercept))
# print(paste("Slope:", slope))
# 
# # Plot the original data and the fitted exponential curve
# x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
# y_pred <- intercept * exp(slope * x_pred)
# 
# #plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
# lines(x_pred, y_pred, col = "black", type = "l", lty = 2)
# 
# # Calculate R-squared value
# rsquared <- summary(model)$r.squared
# print(paste("R-squared:", rsquared))
# 
# #add text for grain size
# text(x =0.1125, y = intercept * exp(slope * 0.1125),
#      labels = expression(bold("Fine (R"^"2"*" = 0.77)")),
#      pos = 4,
#      cex = 1.5)
# 
# 
# 
# ##### #### #### ### medium grain size #### #### #### ####
# # x = db_st_dunite_medium$Ca_umol_l * 2 * 10^-3
# # y = (db_st_dunite_medium$TA_umol_kg) * 10^-3
# 
# #subset the day 5,and 7
# db_sub <- subset(db_st_dunite_medium, db_st_dunite_medium$duration_day < 4)
# 
# x = db_sub$Ca_umol_l * 2 * 10^-3
# y = (db_sub$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# # Fit an exponential regression model
# model <- lm(log(y) ~ x)
# 
# # Extract coefficients
# intercept <- exp(coef(model)[1])
# slope <- coef(model)[2]
# 
# # Print coefficients
# print(paste("Intercept:", intercept))
# print(paste("Slope:", slope))
# 
# # Plot the original data and the fitted exponential curve
# x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
# y_pred <- intercept * exp(slope * x_pred)
# 
# #plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
# lines(x_pred, y_pred, col = "black", type = "l", lty = 2)
# 
# # Calculate R-squared value
# rsquared <- summary(model)$r.squared
# print(paste("R-squared:", rsquared))
# 
# #add text for grain size
# text(x =0.0385, y = intercept * exp(slope * 0.0385),
#      labels = expression(bold("Medium (R"^"2"*" = 0.56)")),
#      pos = 4,
#      cex = 1.5)
# 
# # #add text
# # text(x =0.041, y = intercept * exp(slope * 0.041),
# #      labels = as.expression(bquote(bold("Medium"))),
# #      pos = 4,
# #      cex = 1.5)
# 
# 
# 
# ##### #### #### ### coarse grain size #### #### #### ####
# x = db_st_dunite_coarse$Ca_umol_l * 2 * 10^-3
# y = (db_st_dunite_coarse$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# # Fit an exponential regression model
# model <- lm(log(y) ~ x)
# 
# # Extract coefficients
# intercept <- exp(coef(model)[1])
# slope <- coef(model)[2]
# 
# # Print coefficients
# print(paste("Intercept:", intercept))
# print(paste("Slope:", slope))
# 
# # Plot the original data and the fitted exponential curve
# x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
# y_pred <- intercept * exp(slope * x_pred)
# 
# #plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
# lines(x_pred, y_pred, col = "black", type = "l", lty = 2)
# 
# 
# # Calculate R-squared value
# rsquared <- summary(model)$r.squared
# print(paste("R-squared:", rsquared))
# 
# #add text for grain size
# text(x =0.104, y = intercept * exp(slope * 0.104),
#      labels = expression(bold("Coarse (R"^"2"*" = 0.76)")),
#      pos = 2,
#      cex = 1.5)
# 
# # #add text
# # text(x =0.103, y = intercept * exp(slope * 0.103),
# #      labels = as.expression(bquote(bold("Coarse"))),
# #      pos = 4,
# #      cex = 1.5)
# 
# 
# ################################################################################
# #### Subset data for Basalt only ####
# db_st_basalt <- subset(db_st, db_st$rock_type == "basalt")
# db_st_basalt<- db_st_basalt[complete.cases(db_st_basalt$Ca_umol_l), ]
# db_st_basalt <- db_st_basalt[!(db_st_basalt$Ca_umol_l == 0), ]
# 
# db_st_basalt_fine <- subset(db_st_basalt , db_st_basalt$grain_size == "fine")
# db_st_basalt_coarse <- subset(db_st_basalt , db_st_basalt$grain_size == "coarse")
# 
# #### Sequence for data (line) ####
# seq_x <-seq(from = -10000, to = 100000, by = 1)
# 
# ###########################################X
# #### Basanite Mg vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = db_st_basalt$Mg_umol_l * 2 * 10^-3, 
#      y = db_st_basalt$TA_umol_kg * 10^-3,
#      xlim = c(0, 5),
#      ylim = c(0, 10),
#      xlab = expression(bold("Mg"^"2+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity in mEq/L")),
#      pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
#      col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
#      cex = 4
# )
# 
# #### Linear regression (1:2)####
# #### Basalt Coarse
# #1:2 lines
# lines(seq_x, (seq_x*2),
#       lty = 6)
# text(x = 8/2, y = 8,
#      labels = as.expression(bquote(bold("1:2 line"))),
#      pos = 4,
#      cex = 1.5)
# 
# # # Fit linear regression model
# # x = db_st_basalt_coarse$Mg_umol_l * 2 * 10^-3
# # y = db_st_basalt_coarse$TA_umol_kg * 10^-3
# # lm_model <- lm(y ~ x)
# # # Summary of the regression model
# # summary(lm_model)
# # # Plot the data and regression line
# # abline(lm_model,
# #        col = "black",
# #        lty = 2)
# # # Get the coefficients
# # coefficients <- coef(lm_model)
# # # Print the coefficients
# # print(coefficients)
# # # Add coefficent into the plot
# # text(x = 8/2, y = 8,
# #      labels = as.expression(bquote(bold("y = 1.96x + 0.22"))),
# #      pos = 4,
# #      cex = 1.5)
# 
# text(x = 8/2, y = 7.7,
#      labels = expression(bold("R"^"2"*" = 0.95")),
#      pos = 4,
#      cex = 1.5)
# 
# #### Linear regression ####
# #### Basalt Fine
# # Fit linear regression model
# x = db_st_basalt_fine$Mg_umol_l * 2 * 10^-3
# y = db_st_basalt_fine$TA_umol_kg * 10^-3
# lm_model <- lm(y ~ x)
# 
# # Summary of the regression model
# summary(lm_model)
# 
# # Plot the data and regression line
# abline(lm_model, 
#        col = "black",
#        lty = 2)
# 
# # Get the coefficients
# coefficients <- coef(lm_model)
# 
# # # Add lable for fine
# # text(x = 2.5, y = ((1.435597*2.5)+ 2.606444),
# #      labels = as.expression(bquote(bold("Fine"))),
# #      pos = 2,
# #      cex = 1.5)
# # print(coefficients)
# 
# # # Add coefficent into the plot
# # text(x = 2.5, y = ((1.735597*2.5)+ 2.606444),
# #      labels = as.expression(bquote(bold("y = 1.44x + 2.61"))),
# #      pos = 2,
# #      cex = 1.5)
# 
# #add label for R-squared
# text(x = 2.5, y = ((1.435597*2.5)+ 2.606444),
#      labels = expression(bold("R"^"2"*" = 0.45")),
#      pos = 2,
#      cex = 1.5)
# 
# ##################################################################X
# #### Basanite Na+K vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = (db_st_basalt$Na_umol_l + db_st_basalt$K_umol_l) * 10^-3, 
#      y = (db_st_basalt$TA_umol_kg) * 10^-3,
#      xlim = c(0, 5),
#      ylim = c(0, 10),
#      xlab = expression(bold("Na"^"+"*" + K"^"+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity in mEq/L")),
#      pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
#      col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
#      cex = 4
# )
# 
# ##### linear regression ####
# lines(seq_x, ((seq_x*1)),
#       lty = 6)
# text(x = 1.5, y = 1.5-0.2,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 4,
#      cex = 1.5)
# 
# # db_st_basalt_fine <- subset(db_st_basalt_fine, db_st_basalt_fine$duration_day < 5)
# # # Fit linear regression model
# # x = (db_st_basalt_fine$Na_umol_l + db_st_basalt_fine$K_umol_l) * 10^-3
# # y = db_st_basalt_fine$TA_umol_kg * 10^-3
# # lm_model <- lm(y ~ x)
# # # Summary of the regression model
# # summary(lm_model)
# # # Plot the data and regression line
# # abline(lm_model,
# #        col = "black",
# #        lty = 2)
# # # Get the coefficients
# # coefficients <- coef(lm_model)
# 
# #add label for R-squared
# text(x = 1, y = 1 - 0.2,
#      labels = expression(bold("R"^"2"*" = 0.48")),
#      pos = 4,
#      cex = 1.5)
# 
# 
# #### log model ####
# ##### #### #### ### coarse grain size #### #### #### ####x
# x=(db_st_basalt_coarse$Na_umol_l + db_st_basalt_coarse$K_umol_l) * 10^-3
# y=(db_st_basalt_coarse$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# #fit the model
# model <- lm(y ~ log(x))
# #view the output of the model
# summary(model)
# # Get the coefficients
# coefficients <- coef(model)
# # Print the coefficients
# print(coefficients)
# 
# #plot x vs. y
# #plot(x, y)
# #define x-values to use for regression line
# x=seq(from=0.0001,to=1000,length.out=1000000)
# #use the model to predict the y-values based on the x-values
# y=predict(model,newdata=list(x=seq(from=0.0001,to=1000,length.out=1000000)))
# #add the fitted regression line to the plot (lwd specifies the width of the line)
# matlines(x,y, lwd=1, col = "black", lty = 2)
# 
# # Add text
# text(x = 3, y = (3.703433+(1.954100*log(3))),
#      labels = as.expression(bquote(bold("Coarse"))),
#      pos = 4,
#      cex = 1.5)
# 
# # # Add text for coefficient
# # text(x = 3, y = (3.003433+(1.954100*log(3))),
# #      labels = as.expression(bquote(bold("y=3.90+1.95*log(x)"))),
# #      pos = 4,
# #      cex = 1.5)
# 
# #add label for R-squared
# text(x = 3, y = (3.403433+(1.954100*log(3))),
#      labels = expression(bold("R"^"2"*" = 0.79")),
#      pos = 4,
#      cex = 1.5)
# 
# ##################################################################X
# #### Basanite Ca vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = (db_st_basalt$Ca_umol_l * 2) * 10^-3, 
#      y = (db_st_basalt$TA_umol_kg) * 10^-3,
#      xlim = c(0, 2),
#      ylim = c(0, 10),
#      xlab = expression(bold("Ca"^"2+"*" in mEq/L")),
#      ylab = expression(bold("Total Alkalinity in mEq/L")),
#      pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
#      col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
#      cex = 4
# )
# ####1:1 line####
# # lines(seq_x, (seq_x*1),
# #       lty = 6)
# # text(x = 1, y = 1-0.2,
# #      labels = as.expression(bquote(bold("1:1 line"))),
# #      pos = 1,
# #      cex = 1.5)
# #border
# lines((seq_x*0)+1.4, (seq_x),
#       lty = 6)
# text(x =1.4, y = 10,
#      labels = as.expression(bquote(bold("limit x"))),
#      pos = 2,
#      cex = 1.5)
# 
# ##### #### #### ### log fine grain size #### #### #### ####
# x=(db_st_basalt_fine$Ca_umol_l * 2) * 10^-3
# y=(db_st_basalt_fine$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# #fit the model
# model <- lm(y ~ log(x))
# #view the output of the model
# summary(model)
# # Get the coefficients
# coefficients <- coef(model)
# # Print the coefficients
# print(coefficients)
# 
# #plot x vs. y
# #plot(x, y)
# #define x-values to use for regression line
# x=seq(from=0.0001,to=1000,length.out=1000000)
# #use the model to predict the y-values based on the x-values
# y=predict(model,newdata=list(x=seq(from=0.0001,to=1000,length.out=1000000)))
# #add the fitted regression line to the plot (lwd specifies the width of the line)
# matlines(x,y, lwd=1, col = "black", lty = 2)
# 
# # Add coefficent into the plot
# text(x = 1.5, y = ((4.192892)+ (0.6849959*log(1.5))),
#      labels = as.expression(bquote(bold("Fine"))),
#      pos = 4,
#      cex = 1.5)
# 
# # # Add coefficent into the plot
# # text(x = 1.5, y = ((3.692892)+ (0.6849959*log(1.5))),
# #      labels = as.expression(bquote(bold("y = 3.91x + 0.68*log(x)"))),
# #      pos = 4,
# #      cex = 1.5)
# 
# #add label for R-squared
# text(x = 1.5, y = ((3.592892)+ (0.6849959*log(1.5))),
#      labels = expression(bold("R"^"2"*" = 0.64")),
#      pos = 4,
#      cex = 1.5)
# 
# 
# ##### #### #### ### exp coarse grain size #### #### #### ####
# x=(db_st_basalt_coarse$Ca_umol_l * 2) * 10^-3
# y=(db_st_basalt_coarse$TA_umol_kg) * 10^-3
# #plot(x, y)
# 
# # Fit an exponential regression model
# model <- lm(log(y) ~ x)
# 
# # Extract coefficients
# intercept <- exp(coef(model)[1])
# slope <- coef(model)[2]
# 
# # Print coefficients
# print(paste("Intercept:", intercept))
# print(paste("Slope:", slope))
# 
# # Plot the original data and the fitted exponential curve
# x_pred <- seq(min(x) - 2, max(x) + 2, length.out = 1000)
# y_pred <- intercept * exp(slope * x_pred)
# 
# #plot(x, y, xlab = "X", ylab = "Y", main = "Exponential Relationship")
# lines(x_pred, y_pred, col = "black", type = "l", lty = 2)
# 
# 
# # Add coefficent into the plot
# text(x = 1.5, y = (intercept * exp(slope * 1.5)),
#      labels = as.expression(bquote(bold("Coarse"))),
#      pos = 4,
#      cex = 1.5)
# 
# # # Add coefficent into the plot
# # text(x = 1.5, y = (intercept * exp(slope * 1.5) - 0.5),
# #      labels = as.expression(bquote(bold("y = 0.58 * exp(1.78x)"))),
# #      pos = 4,
# #      cex = 1.5)
# 
# #add label for R-squared
# text(x = 1.5, y = (intercept+0.52 * exp(slope * 1.5)),
#      labels = expression(bold("R"^"2"*" = 0.78")),
#      pos = 4,
#      cex = 1.5)
# 
# 
# # legend("topleft",
# #        legend = c("Regression - Basanite Fine", "Regression - Basanite Coarse"),
# #        lty = c(2,2),
# #        col = c("darkblue", "red"),
# #        bty = "n",
# #        cex = 1.5
# # )



```

```{r "Basanite and Dunite - Cations and TA-Cations - backup 1", include=TRUE}
# 
# ################################################################################
# ##### Plot all scneario into 1 plot#####
# par(mfrow=c(2,3))
# par(mfrow=c(2,3), #rows, columns several plots into one
#     cex.main = 1.5,  # Font size for main title
#     cex.lab = 1.75,  # Font size for xlab and ylab
#     cex.axis = 1.5) # Font size for axis tick labels
# ############################################X
# 
# 
# 
# #### Subset data for Dunite only ####
# db_st_dunite <- subset(db_st, db_st$rock_type == "dunite")
# db_st_dunite <- db_st_dunite[!(db_st_dunite$duration_day == 7 & db_st_dunite$Mg_umol_l == 0), ]
# db_st_dunite <- db_st_dunite[complete.cases(db_st_dunite$Mg_umol_l), ]
# 
# db_st_dunite <- db_st_dunite[!(db_st_dunite$Ca_umol_l == 0), ]
# 
# db_st_dunite_fine <- subset(db_st_dunite , db_st_dunite$grain_size == "fine")
# db_st_dunite_medium <- subset(db_st_dunite , db_st_dunite$grain_size == "medium")
# db_st_dunite_coarse <- subset(db_st_dunite , db_st_dunite$grain_size == "coarse")
# 
# 
# #### Sequence for data (line) ####
# seq_x <-seq(from = -10000, to = 100000, by = 1)
# 
# 
# ###########################################X
# ##### Legend ###############################
# ###########################################X
# 
# plot.new()
# #### Legend Day
# legend("topleft",
#        title = as.expression(bquote(bold("Day of Observation"))),
#        legend = c(levels(as.factor(db_st_basalt$legend_day))),
#        pt.bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b"),
#        col = "black",
#        pch = 21,
#        ncol = 2,
#        bty = "n",
#        cex = 1.1,
#        horiz = TRUE
# )
# #### Grain Size
# legend("topright",
#        title = as.expression(bquote(bold("Grain Size"))),
#        legend = c(levels(as.factor(db_st_dunite$grain_size))),
#        pt.bg = c("black"),
#        col = "black",
#        pch = c(22,21,24),
#        ncol = 1,
#        bty = "n",
#        cex = 1.1,
#        horiz = TRUE
# )
# #### Legend line
# legend("bottomleft",
#        legend = c("Quadratic - 2nd Degree"),
#        lty = 2,
#        col = c("darkblue"),
#        bty = "n"
# )
# 
# 
# 
# ##################################################################X
# #### Dunite Mg vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = db_st_dunite$Mg_umol_l * 2 * 10^-3, 
#      y = (db_st_dunite$TA_umol_kg * 10^-3) - (((db_st_dunite$Ca_umol_l * 2) + (db_st_dunite$Na_umol_l * 1) + (db_st_dunite$K_umol_l * 1)) * 10^-3),
#      xlim = c(0, 30),
#      ylim = c(0, 30),
#      xlab = expression(bold("Mg"^"2+"*" in mEq/L")),
#      ylab = expression(bold("TA - (Ca"^"2+"*" + Na"^"+"*" + K"^"+"*") in mEq/L")),
#      pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
#      col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
#      cex = 4
# )
# ####1:1 Lines####
# lines(seq_x, (seq_x*1),
#       lty = 6)
# text(x = 23, y = 23,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 2,
#      cex = 1.5)
# 
# 
# ##################################################################X
# #### Dunite Na+K vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = (db_st_dunite$Na_umol_l + db_st_dunite$K_umol_l) * 10^-3, 
#      y = (db_st_dunite$TA_umol_kg * 10^-3) - (((db_st_dunite$Ca_umol_l * 2) + (db_st_dunite$Mg_umol_l * 2)) * 10^-3),
#      xlim = c(0, 1.5),
#      ylim = c(0, 3),
#      xlab = expression(bold("Na"^"+"*" + K"^"+"*" in mEq/L")),
#      ylab = expression(bold("TA - (Mg"^"2+"*" + Ca"^"2+"*") in mEq/L")),
#      pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
#      col = "black",  bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
#      cex = 4
# )
# 
# ####1:1 Lines####
# lines(seq_x, (seq_x*1),
#       lty = 6)
# text(x = 1, y = 1,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 4,
#      cex = 1.5)
# 
# 
# 
# ##################################################################X
# #### Dunite Ca vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = db_st_dunite$Ca_umol_l * 2 * 10^-3, 
#       y = (db_st_dunite$TA_umol_kg * 10^-3) - (((db_st_dunite$Mg_umol_l * 2) + (db_st_dunite$Na_umol_l * 1) + (db_st_dunite$K_umol_l * 1)) * 10^-3),
#      xlim = c(0, 0.15),
#      ylim = c(-0.5, 3),
#      xlab = expression(bold("Ca"^"2+"*" in mEq/L")),
#      ylab = expression(bold("TA - (Mg"^"2+"*" + Na"^"+"*" + K"^"+"*") in mEq/L")),
#      pch = c(22,21,24)[as.factor(db_st_dunite$grain_size)],
#      col = "black",  bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0", "#034e7b")[as.factor(db_st_dunite$legend_day)],
#      cex = 4
# )
# ####1:1 Lines####
# lines(seq_x, (seq_x*1),
#       lty = 6)
# text(x = 0.13, y =0.13,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 1,
#      cex = 1.5)
# 
# ################################################################################
# #### Subset data for Basalt only ####
# db_st_basalt <- subset(db_st, db_st$rock_type == "basalt")
# db_st_basalt<- db_st_basalt[complete.cases(db_st_basalt$Ca_umol_l), ]
# db_st_basalt <- db_st_basalt[!(db_st_basalt$Ca_umol_l == 0), ]
# 
# db_st_basalt_fine <- subset(db_st_basalt , db_st_basalt$grain_size == "fine")
# db_st_basalt_coarse <- subset(db_st_basalt , db_st_basalt$grain_size == "coarse")
# 
# #### Sequence for data (line) ####
# seq_x <-seq(from = -10000, to = 100000, by = 1)
# 
# ###########################################X
# #### Basanite Mg vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = db_st_basalt$Mg_umol_l * 2 * 10^-3, 
#           y = (db_st_basalt$TA_umol_kg * 10^-3) - (((db_st_basalt$Ca_umol_l * 2) + (db_st_basalt$Na_umol_l * 1) + (db_st_basalt$K_umol_l * 1)) * 10^-3),
#      xlim = c(0, 5),
#      ylim = c(-1.5, 4),
#      xlab = expression(bold("Mg"^"2+"*" in mEq/L")),
#      ylab = expression(bold("TA - (Ca"^"2+"*" + Na"^"+"*" + K"^"+"*") in mEq/L")),
#      pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
#      col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
#      cex = 4
# )
# ####1:1 Lines####
# lines(seq_x, (seq_x*1),
#       lty = 6)
# text(x = 3.25, y = 3.25,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 2,
#      cex = 1.5)
# 
# # # Fit linear regression model
# # x = db_st_basalt_coarse$Mg_umol_l * 2 * 10^-3
# # y = db_st_basalt_coarse$TA_umol_kg * 10^-3
# # lm_model <- lm(y ~ x)
# # # Summary of the regression model
# # summary(lm_model)
# # # Plot the data and regression line
# # abline(lm_model, 
# #        col = "black",
# #        lty = 2)
# # # Get the coefficients
# # coefficients <- coef(lm_model)
# # # Print the coefficients
# # print(coefficients)
# # # Add coefficent into the plot
# # text(x = 8/2, y = 8,
# #      labels = as.expression(bquote(bold("y = 1.96x + 0.22"))),
# #      pos = 4,
# #      cex = 1.5)
# 
# #### Basanite Na+K vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = (db_st_basalt$Na_umol_l + db_st_basalt$K_umol_l) * 10^-3, 
#      y = (db_st_basalt$TA_umol_kg * 10^-3) - (((db_st_basalt$Ca_umol_l * 2) + (db_st_basalt$Mg_umol_l * 2)) * 10^-3),
#      xlim = c(0, 5),
#      ylim = c(-1.5, 4),
#      xlab = expression(bold("Na"^"+"*" + K"^"+"*" in mEq/L")),
#      ylab = expression(bold("TA - (Mg"^"2+"*" + Ca"^"2+"*") in mEq/L")),
#      pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
#      col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
#      cex = 4
# )
# 
# ####1:1 Lines####
# lines(seq_x, (seq_x*1),
#       lty = 6)
# text(x = 3.5, y = 3.5,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 2,
#      cex = 1.5)
# 
# 
# #### Basanite Ca vs Total Alkalinity (represent HCO3 and CO32-) ####
# ##################################################################X
# par(mar = c(4, 5, 5, 2)) #margin bottom, left, up, right
# plot(x = (db_st_basalt$Ca_umol_l * 2) * 10^-3, 
#      y = (db_st_basalt$TA_umol_kg * 10^-3) - (((db_st_basalt$Mg_umol_l * 2) + (db_st_basalt$Na_umol_l * 1) + (db_st_basalt$K_umol_l * 1)) * 10^-3),
#      xlim = c(0, 1.5),
#      ylim = c(-1.5, 4),
#      xlab = expression(bold("Ca"^"2+"*" in mEq/L")),
#      ylab = expression(bold("TA - (Mg"^"2+"*" + Na"^"+"*" + K"^"+"*") in mEq/L")),
#      pch = c(22,21)[as.factor(db_st_basalt$grain_size)],
#      col = "black", bg = c("#f1eef6",  "#d0d1e6", "#a6bddb",  "#74a9cf", "#3690c0",  "#0570b0", "#034e7b")[as.factor(db_st_basalt$legend_day)],
#      cex = 4
# )
# ####1:1 Lines####
# lines(seq_x, (seq_x*1),
#       lty = 6)
# text(x = 1, y = 1,
#      labels = as.expression(bquote(bold("1:1 line"))),
#      pos = 2,
#      cex = 1.5)

```

```{r "Alkalinity Produced per Surface Area - backup", include=TRUE}

#######
#### Export as a PNG with width = 1200 and height = 600
par(cex.main = 1.5,  # Font size for main title
    cex.lab = 1.25,  # Font size for xlab and ylab
    cex.axis = 1.25) # Font size for axis tick labels

bf_13_50_flux <- subset(bf_13_50, duration_day >= 1)
bc_13_50_flux <- subset(bc_13_50, duration_day >= 1)

df_13_50_flux <- subset(df_13_50, duration_day >= 1)
dm_13_50_flux <- subset(dm_13_50, duration_day >= 1)
dc_13_50_flux <- subset(dc_13_50, duration_day >= 1)


par(mfrow=c(2,2)) #merging multiple plots into one figure

#### Basalt
par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
plot(bf_13_50_flux$duration_day, ((bf_13_50_flux$TA_AWR_umol_kg*3)/(ssa_basalt_fine*1000)), 
     main = "Basanite - Alkalinity Flux",
     type = "b", cex=2.75, pch = 21, col = "black", bg = "grey50",
     ylim = c(0,2.5),
     xlab = substitute(paste(bold("Day"))), 
     #ylab = expression(bold("µmol of Alkalinity Produced / m"^"2")),
     ylab = expression(bold("Alkalinity Flux in µEq / m"^"2"*".day"))
)

points(bc_13_50_flux$duration_day, ((bc_13_50_flux$TA_AWR_umol_kg*3)/(ssa_basalt_coarse*1000)), 
       type = "b", cex=2.75, pch = 22, col = "black", bg = "grey50")

#### Corrected flux - assuming no grinding effects
#bf_13_50_flux <- bf_13_50_flux %>% mutate (TA_normalized_umol_kg = case_when(
#  duration_day < 1 ~ TA_AWR_umol_kg,
#  duration_day < 2 & duration_day >= 1 ~ TA_AWR_umol_kg*1.4,
#  duration_day < 3 & duration_day >= 2 ~ TA_AWR_umol_kg*2.2,
#  duration_day < 4 & duration_day >= 3 ~ TA_AWR_umol_kg*2.25,
#  duration_day >= 4 ~ TA_AWR_umol_kg*3,
#))

#points(bf_13_50_flux$duration_day, ((bf_13_50_flux$TA_normalized_umol_kg*3)/(ssa_basalt_fine*1000)), 
#       type = "b", cex=2.75, lty = 2, pch = 21, col = "black", bg = "darkblue")

legend("topleft", 
       #title = "Mechanical Speed",
       legend=c("Fine Grain Size", "Coarse Grain Size"),
       col = "black",
       pch = c(21,22),
       cex = 1.15,
       pt.bg = c("grey50", "grey50"),
       lty = c(1,1),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n",
)


#### Dunite
par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
plot(df_13_50_flux$duration_day, ((df_13_50_flux$TA_AWR_umol_kg*3)/(ssa_dunite_fine*1000)),
     main = "Dunite - Alkalinity Flux",
     type = "b", cex=2.75, pch = 21, col = "black", bg = "#9ab973",
     ylim = c(0,50),
     xlab = substitute(paste(bold("Day"))), 
     #ylab = expression(bold("µmol of Alkalinity Produced / m"^"2")),
     ylab = expression(bold("Alkalinity Flux in µEq / m"^"2"*".day"))
     
)

points(dm_13_50_flux$duration_day, ((dm_13_50_flux$TA_AWR_umol_kg*3)/(ssa_dunite_medium*1000)), 
       type = "b", cex=2.75, pch = 24, col = "black", bg = "#9ab973")
points(dc_13_50_flux$duration_day, ((dc_13_50_flux$TA_AWR_umol_kg*3)/(ssa_dunite_coarse*1000)), 
       type = "b", cex=2.75, pch = 22, col = "black", bg = "#9ab973")
#### Corrected flux - assuming no grinding effects
#points(df_13_50_flux$duration_day, ((df_13_50_flux$TA_AWR_umol_kg*3)/(ssa_dunite_fine*1000)*9.25), 
#       type = "b", lty = 2, cex=2.75, pch = 22, col = "black", bg = "darkblue")

legend("topleft", 
       #title = "Mechanical Speed",
       legend=c("Fine Grain Size", "Medium Grain Size","Coarse Grain Size"),
       col = "black",
       pch = c(21,24,22),
       cex = 1.15,
       pt.bg = c("#9ab973", "#9ab973", "#9ab973"),
       lty = c(1,1,1),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n",
)

##############################################################################x
#### Alkalinity per mass of rocks #############################################
##############################################################################x

#### Basalt
par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
plot(bf_13_50_flux$duration_day, ((bf_13_50_flux$TA_AWR_umol_kg*3)/(1000)), 
     main = "Basanite - TA Produced/Mass of Rock",
     type = "b", cex=2.75, pch = 21, col = "black", bg = "grey50",
     ylim = c(0,25),
     xlab = substitute(paste(bold("Day"))), 
     #ylab = expression(bold("µmol of Alkalinity Produced / m"^"2")),
     ylab = expression(bold("Alkalinity Produced in µEq / gram of rock. day"))
)

points(bc_13_50_flux$duration_day, ((bc_13_50_flux$TA_AWR_umol_kg*3)/(1000)), 
       type = "b", cex=2.75, pch = 22, col = "black", bg = "grey50")

#### Corrected flux - assuming no grinding effects
#bf_13_50_flux <- bf_13_50_flux %>% mutate (TA_normalized_umol_kg = case_when(
#  duration_day < 1 ~ TA_AWR_umol_kg,
#  duration_day < 2 & duration_day >= 1 ~ TA_AWR_umol_kg*1.4,
#  duration_day < 3 & duration_day >= 2 ~ TA_AWR_umol_kg*2.2,
#  duration_day < 4 & duration_day >= 3 ~ TA_AWR_umol_kg*2.25,
#  duration_day >= 4 ~ TA_AWR_umol_kg*3,
#))

#points(bf_13_50_flux$duration_day, ((bf_13_50_flux$TA_normalized_umol_kg*3)/(1000)), 
#       type = "b", cex=2.75, lty = 2, pch = 21, col = "black", bg = "darkblue")

legend("topleft", 
       #title = "Mechanical Speed",
       legend=c("Fine Grain Size", "Coarse Grain Size"),
       col = "black",
       pch = c(21,22),
       cex = 1.15,
       pt.bg = c("grey50", "grey50"),
       lty = c(1,1),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n",
)


#### Dunite
par(mar = c(5, 5, 2, 2)) #margin bottom, left, up, right
plot(df_13_50_flux$duration_day, ((df_13_50_flux$TA_AWR_umol_kg*3)/(1000)),
     main = "Dunite - TA Produced/Mass of Rock",
     type = "b", cex=2.75, pch = 21, col = "black", bg = "#9ab973",
     ylim = c(0,50),
     xlab = substitute(paste(bold("Day"))), 
     #ylab = expression(bold("µmol of Alkalinity Produced / m"^"2")),
     ylab = expression(bold("Alkalinity Produced in µEq / gram of rock. day"))
     
)

points(dm_13_50_flux$duration_day, ((dm_13_50_flux$TA_AWR_umol_kg*3)/(1000)), 
       type = "b", cex=2.75, pch = 24, col = "black", bg = "#9ab973")
points(dc_13_50_flux$duration_day, ((dc_13_50_flux$TA_AWR_umol_kg*3)/(1000)), 
       type = "b", cex=2.75, pch = 22, col = "black", bg = "#9ab973")
#### Corrected flux - assuming no grinding effects
#points(df_13_50_flux$duration_day, ((df_13_50_flux$TA_AWR_umol_kg*3)/(1000)*9.25), 
#      type = "b", lty = 2, cex=2.75, pch = 21, col = "black", bg = "darkblue")

legend("topleft", 
       #title = "Mechanical Speed",
       legend=c("Fine Grain Size", "Medium Grain Size","Coarse Grain Size"),
       col = "black",
       pch = c(21,24,22),
       cex = 1.15,
       pt.bg = c("#9ab973", "#9ab973", "#9ab973"),
       lty = c(1,1,1),
       #horiz = TRUE,
       ncol = 1,
       inset = 0.02,
       title.adj=0.1,
       bty = "n",
)


```


```{r "Bar plot - Alkalinity Production vs Treatment -backup", include=TRUE}


par(mfrow=c(2,2)) #merging multiple plots into one figure
par(cex.main = 1.5,  # Font size for main title
    cex.lab = 1.25,  # Font size for xlab and ylab
    cex.axis = 1,
    las = 1) # Font size for axis tick labels

##### Mechanical Effects ###################################################
#Data Frame
#rpm_0_dunite <- subset(db_st, id_code == "base_dunite" & duration_day <=4)
#rpm_30_dunite <- subset(db_st, id_code == "rpm_slow")
#rpm_50_dunite <- subset(db_st, id_code == "rpm_medium" & duration_day <=4)
#rpm_90_dunite <- subset(db_st, id_code == "rpm_high")

#rpm_0_basalt <- subset(db_st, id_code == "base_basalt")
#rpm_50_basalt <- subset(db_st, id_code == "BF-13-50")

#x = c(db_st$TA_umol_kg[db_st$id_code == "base_dunite" & db_st$duration_day == 0],
#      db_st$TA_umol_kg[db_st$id_code == "base_dunite" & db_st$duration_day == 1],
#      db_st$TA_umol_kg[db_st$id_code == "base_dunite" & db_st$duration_day == 2],
#      db_st$TA_umol_kg[db_st$id_code == "base_dunite" & db_st$duration_day == 3],
#      db_st$TA_umol_kg[db_st$id_code == "base_dunite" & db_st$duration_day == 4]
#)

x <- 0
y <- 0
#base_basalt
for (i in c(1,3,4)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "base_basalt" & db_st$duration_day == i])))
  base_basalt = (sum(x[c(1,3)]) + (x[4]*3))*3
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "base_basalt" & db_st$duration_day == i]))) * x[i] / 100
  base_basalt_sd = mean(y[c(1,3,4)])
}
#50_basalt_fine
for (i in c(1,3,4)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BF-13-50" & db_st$duration_day == i])))
  basalt_50 = sum(x[c(1,3)]) + (x[4]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BF-13-50" & db_st$duration_day == i]))) * x[i] / 100
  basalt_50_sd = mean(y[c(1,3,4)])
}
#
#base_dunite_coarse
for (i in c(1,3,4)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "base_dunite" & db_st$duration_day == i])))
  base_dunite = (sum(x[c(1,3)]) + (x[4]*3))*2
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "base_dunite" & db_st$duration_day == i]))) * x[i] / 100
  base_dunite_sd = mean(y[c(1,3,4)])
}
#30_dunite_coarse
for (i in 1:4){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "rpm_slow" & db_st$duration_day == i])))
  dunite_30 = sum(x[1:3]) + (x[4]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "rpm_slow" & db_st$duration_day == i]))) * x[i] / 100
  dunite_30_sd = mean(y[c(1:4)])
}
#50_dunite_coarse
for (i in 1:4){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "rpm_medium" & db_st$duration_day == i])))
  dunite_50 = sum(x[1:3]) + (x[4]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "rpm_medium" & db_st$duration_day == i]))) * x[i] / 100
  dunite_50_sd = mean(y[c(1:4)])
}
#90_dunite_coarse
for (i in 1:4){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "rpm_high" & db_st$duration_day == i])))
  dunite_90 = sum(x[1:3]) + (x[4]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "rpm_high" & db_st$duration_day == i]))) * x[i] / 100
  dunite_90_sd = mean(y[c(1:4)])
}

mech_effect <- data.frame(treatment =c("base_basalt", "basalt_50","base_dunite", "dunite_30", "dunite_50", "dunite_90"),
                          TAlk_mmol_l = c(base_basalt/1000, basalt_50/1000, base_dunite/1000, dunite_30/1000, dunite_50/1000, dunite_90/1000),
                          sd = c(base_basalt_sd/1000, basalt_50_sd/1000, base_dunite_sd/1000, dunite_30_sd/1000, dunite_50_sd/1000, dunite_90_sd/1000)
)

#barplot
ME = barplot(height=mech_effect$TAlk_mmol_l, 
             main = "Mechanical Effect",
             ylim = c(0,250),
             ylab = substitute(paste(bold("Alkalinity in mEq"))),
             col=c(rep("grey40",2),rep("#9ab973",4)),
             names.arg = c("No Mixing", "RPM 50",
                           "No Mixing", "RPM 30",
                           "RPM 50", "RPM 90"),
             font.axis = 2,
)
text(
  x = ME,
  y = mech_effect$TAlk_mmol_l,
  labels = round(mech_effect$TAlk_mmol_l, 1),
  pos = 3,
  srt = 0,
  offset = 1
)
#standard deviation legend
arrows(x0 = ME, y0 = mech_effect$TAlk_mmol_l + mech_effect$sd,
       x1 = ME, y1 = mech_effect$TAlk_mmol_l - mech_effect$sd,
       code = 3, angle = 90, length = 0.2)



##### Grain Size Effects ###################################################

#basalt
#bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")
#bc_13_50 <- subset(db_st, db_st$id_code == "BC-13-50")
#dunite
#df_13_50 <- subset(db_st, db_st$id_code == "DF-13-50")
#dm_13_50 <- subset(db_st, db_st$id_code == "DM-13-50")
#dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")


x <- 0
y <- 0
#basalt_fine
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BF-13-50" & db_st$duration_day == i])))
  basalt_fine = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BF-13-50" & db_st$duration_day == i]))) * x[i] / 100
  basalt_fine_sd = mean(y[c(1:4,7)])
}
#basalt_coarse
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BC-13-50" & db_st$duration_day == i])))
  basalt_coarse = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BC-13-50" & db_st$duration_day == i]))) * x[i] / 100
  basalt_coarse_sd = mean(y[c(1:4,7)])
}
#dunite_fine
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DF-13-50" & db_st$duration_day == i])))
  dunite_fine = sum(x[c(1:4)]) + (x[7]*2)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DF-13-50" & db_st$duration_day == i]))) * x[i] / 100
  dunite_fine_sd = mean(y[c(1:4,7)])
}
#dunite_medium
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DM-13-50" & db_st$duration_day == i])))
  dunite_medium = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DM-13-50" & db_st$duration_day == i]))) * x[i] / 100
  dunite_medium_sd = mean(y[c(1:4,7)])
}
#dunite_coarse
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DC-13-50" & db_st$duration_day == i])))
  dunite_coarse= sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DC-13-50" & db_st$duration_day == i]))) * x[i] / 100
  dunite_coarse_sd = mean(y[c(1:4,7)])
}

#concate
grain_effect <- data.frame(treatment =c("Basalt Fine", "Basalt Coarse", 
                                        "Dunite Fine", "Dunite Medium", "Dunite Coarse"),
                           TAlk_mmol_l = c(basalt_fine/1000, basalt_coarse/1000, dunite_fine/1000, dunite_medium/1000, dunite_coarse/1000),
                           sd = c(basalt_fine_sd/1000, basalt_coarse_sd/1000, dunite_fine_sd/1000, dunite_medium_sd/1000, dunite_coarse_sd/1000)
                           
)

#barplot
GE = barplot(height=grain_effect$TAlk_mmol_l, 
             main = "Grain Sizes Effect",
             ylim = c(0,200),
             ylab = substitute(paste(bold("Alkalinity in mEq"))),
             col=c(rep("grey40",2),rep("#9ab973",3)),
             names.arg = c("Basalt Fine", "Basalt Coarse", 
                           "Dunite Fine", "Dunite Medium", "Dunite Coarse"),
             font.axis = 2,
)
text(
  x = GE,
  y = grain_effect$TAlk_mmol_l,
  labels = round(grain_effect$TAlk_mmol_l, 1),
  pos = 3,
  srt = 0,
  offset = 1
)
#standard deviation legend
arrows(x0 = GE, y0 = grain_effect$TAlk_mmol_l + grain_effect$sd,
       x1 = GE, y1 = grain_effect$TAlk_mmol_l - grain_effect$sd,
       code = 3, angle = 90, length = 0.2)



##### Rock-Water Ratio #####################################################

#bc_12 <- subset(db_st, db_st$id_code == "BC-12-50")
#bc_13 <- subset(db_st, db_st$id_code == "BC-13-50")
#bc_15 <- subset(db_st, db_st$id_code == "BC-15-50")
#dc_12 <- subset(db_st, db_st$id_code == "DC-12-50")
#dc_13 <- subset(db_st, db_st$id_code == "DC-13-50")
#dc_15 <- subset(db_st, db_st$id_code == "DC-15-50")


x <- 0
y <- 0
#Basalt 1 to 2
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BC-12-50" & db_st$duration_day == i])))
  bc_12 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BC-12-50" & db_st$duration_day == i]))) * x[i] / 100
  bc_12_sd = mean(y[c(1:4,7)])
}

#Basalt 1 to 3
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BC-13-50" & db_st$duration_day == i])))
  bc_13 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BC-13-50" & db_st$duration_day == i]))) * x[i] / 100
  bc_13_sd = mean(y[c(1:4,7)])
}

#Basalt 1 to 5
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BC-15-50" & db_st$duration_day == i])))
  bc_15 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BC-15-50" & db_st$duration_day == i]))) * x[i] / 100
  bc_15_sd = mean(y[c(1:4,7)])
}

#Dunite 1 to 2
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DC-12-50" & db_st$duration_day == i])))
  dc_12 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DC-12-50" & db_st$duration_day == i]))) * x[i] / 100
  dc_12_sd = mean(y[c(1:4,7)])
}

#Dunite 1 to 3
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DC-13-50" & db_st$duration_day == i])))
  dc_13 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DC-13-50" & db_st$duration_day == i]))) * x[i] / 100
  dc_13_sd = mean(y[c(1:4,7)])
}

#Dunite 1 to 5
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DC-15-50" & db_st$duration_day == i])))
  dc_15 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DC-15-50" & db_st$duration_day == i]))) * x[i] / 100
  dc_15_sd = mean(y[c(1:4,7)])
}

#concate
water_ratio <- data.frame(treatment =c("Basalt 1:2", "Basalt 1:3", "Basalt 1:5",
                                       "Dunite 1:2", "Dunite 1:3", "Dunite 1:5"),
                          TAlk_mmol_l = c(bc_12/1000, bc_13/1000, bc_15/1000, dc_12/1000, dc_13/1000, dc_15/1000),
                          sd = c(bc_12_sd/1000, bc_13_sd/1000, bc_15_sd/1000, dc_12_sd/1000, dc_13_sd/1000, dc_15_sd/1000)
                          
)

#barplot
RW = barplot(height=water_ratio$TAlk_mmol_l, 
             main = "Rock-Water Ratio",
             ylim = c(0,200),
             ylab = substitute(paste(bold("Alkalinity in mEq"))),
             col=c(rep("grey40",3),rep("#9ab973",3)),
             names.arg = c("Basalt 1:2", "Basalt 1:3", "Basalt 1:5",
                           "Dunite 1:2", "Dunite 1:3", "Dunite 1:5"),
             font.axis = 2,
)
text(
  x = RW,
  y = water_ratio$TAlk_mmol_l,
  labels = round(water_ratio$TAlk_mmol_l, 1),
  pos = 3,
  srt = 0,
  offset = 1
)
#standard deviation legend
arrows(x0 = RW, y0 = water_ratio$TAlk_mmol_l + water_ratio$sd,
       x1 = RW, y1 = water_ratio$TAlk_mmol_l - water_ratio$sd,
       code = 3, angle = 90, length = 0.2)

##### Water Replacement ####################################################
#Data Frame
bf_nwr <- subset(db_st, db_st$id_code == "BF-13-NWR-50")
#bf_13_50 <- subset(db_st, db_st$id_code == "BF-13-50")
dc_nwr <- subset(db_st, db_st$id_code == "DC-13-NWR-50")
#dc_13_50 <- subset(db_st, db_st$id_code == "DC-13-50")

x <- 0
y <- 0
#basalt no water replacement
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BF-13-NWR-50" & db_st$duration_day == i])))
  bf_nwr_st = (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BF-13-NWR-50" & db_st$duration_day == i]))) * x[i] / 100
  bf_nwr_sd = mean(y[c(1:4,7)])
}
#basalt 1:3
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "BF-13-50" & db_st$duration_day == i])))
  bf_13 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "BF-13-50" & db_st$duration_day == i]))) * x[i] / 100
  bf_13_sd = mean(y[c(1:4,7)])
}
#dunite no water replacement
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DC-13-NWR-50" & db_st$duration_day == i])))
  dc_nwr_st = (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DC-13-NWR-50" & db_st$duration_day == i]))) * x[i] / 100
  dc_nwr_sd = mean(y[c(1:4,7)])
}
#dunite 1:3
for (i in c(1:4,7)){
  x[i] = (as.numeric(c(db_st$TA_umol_kg[db_st$id_code == "DC-13-50" & db_st$duration_day == i])))
  dc_13 = sum(x[c(1:4)]) + (x[7]*3)
  y[i] = (as.numeric(c(db_st$sd_TA_percentage[db_st$id_code == "DC-13-50" & db_st$duration_day == i]))) * x[i] / 100
  dc_13_sd = mean(y[c(1:4,7)])
}

#
replace_effect <- data.frame(treatment =c("bf_nwr_st", "bf_13", "dc_nwr_st", "dc_13"),
                             TAlk_mmol_l = c(bf_nwr_st/1000, bf_13/1000, dc_nwr_st/1000, dc_13/1000),
                             sd = c(bf_nwr_sd/1000, bf_13_sd/1000, dc_nwr_sd/1000, dc_13_sd/1000)
)
#barplot
RE = barplot(height=replace_effect$TAlk_mmol_l, 
             main = "Water Replacement Effect",
             ylim = c(0,200),
             ylab = substitute(paste(bold("Alkalinity in mEq"))),
             col=c(rep("grey40",2),rep("#9ab973",2)),
             names.arg = c("No Replacement", "Replaced 33%",
                           "No Replacement", "Replaced 33%"),
             font.axis = 2,
)
text(
  x = RE,
  y = replace_effect$TAlk_mmol_l,
  labels = round(replace_effect$TAlk_mmol_l, 1),
  pos = 3,
  srt = 0,
  offset = 1
)
#standard deviation legend
arrows(x0 = RE, y0 = replace_effect$TAlk_mmol_l + replace_effect$sd,
       x1 = RE, y1 = replace_effect$TAlk_mmol_l - replace_effect$sd,
       code = 3, angle = 90, length = 0.2)







```

